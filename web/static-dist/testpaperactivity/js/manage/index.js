!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/static-dist/",n(n.s=32)}([function(e,t,n){e.exports=!n(6)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(4),i=n(2),a=n(13),o=n(15),s=n(21),c=function(e,t,n){var l,u,d,p=e&c.F,m=e&c.G,f=e&c.S,h=e&c.P,v=e&c.B,g=e&c.W,$=m?i:i[t]||(i[t]={}),y=$.prototype,x=m?r:f?r[t]:(r[t]||{}).prototype;for(l in m&&(n=t),n)(u=!p&&x&&void 0!==x[l])&&s($,l)||(d=u?x[l]:n[l],$[l]=m&&"function"!=typeof x[l]?n[l]:v&&u?a(d,r):g&&x[l]==d?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):h&&"function"==typeof d?a(Function.call,d):d,h&&(($.virtual||($.virtual={}))[l]=d,e&c.R&&y&&!y[l]&&o(y,l,d)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(e,t,n){e.exports=n(11)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(16),i=n(17),a=n(19),o=Object.defineProperty;t.f=n(0)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){var r=n(25);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(e,i.key,i)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}},function(e,t,n){n(12),e.exports=n(2).parseInt},function(e,t,n){var r=n(1),i=n(22);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(e,t,n){var r=n(14);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(7),i=n(20);e.exports=n(0)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(5);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(0)&&!n(6)((function(){return 7!=Object.defineProperty(n(18)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(5),i=n(4).document,a=r(i)&&r(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t,n){var r=n(5);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(4).parseInt,i=n(23).trim,a=n(8),o=/^[-+]?0[xX]/;e.exports=8!==r(a+"08")||22!==r(a+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(o.test(n)?16:10))}:r},function(e,t,n){var r=n(1),i=n(24),a=n(6),o=n(8),s="["+o+"]",c=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),u=function(e,t,n){var i={},s=a((function(){return!!o[e]()||"​"!="​"[e]()})),c=i[e]=s?t(d):o[e];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},d=u.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(l,"")),e};e.exports=u},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){e.exports=n(26)},function(e,t,n){n(27);var r=n(2).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(1);r(r.S+r.F*!n(0),"Object",{defineProperty:n(7).f})},function(e,t,n){e.exports=n(30)},,function(e,t,n){n(31),e.exports=n(2).Date.now},function(e,t,n){var r=n(1);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";n.r(t);var r=n(28),i=n.n(r),a=n(3),o=n.n(a),s=n(9),c=n.n(s),l=n(10),u=n.n(l);new(function(){function e(t){c()(this,e),this.$element=t,this.$form=this.$element.find("#step2-form"),this.$questionBankSelector=this.$element.find("#question-bank"),this.$testpaperSelector=this.$element.find("#testpaper-media"),this.$questionItemShow=this.$element.find("#questionItemShowDiv"),this.$scoreItem=this.$element.find(".js-score-form-group"),this._init()}return u()(e,[{key:"_init",value:function(){var e=this;Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%24==0?24:this.getHours()%24,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+{0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"}[this.getDay()+""])),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},this.setValidateRule(),this.initQuestionBankSelector(),this.initTestPaperSelector(),this.initSelectTestPaper(this.$testpaperSelector.select2("data")),this.initEvent(),this.initStepForm2(),this.initAddComment(),window.ltc.on("getActivity",(function(t){window.ltc.emit("returnActivity",{valid:e.validator.form(),data:window.ltc.getFormSerializeObject($("#step2-form"))})})),window.ltc.on("getValidate",(function(t){window.ltc.emit("returnValidate",{valid:e.validator.form(),context:{score:e.$testpaperSelector.select2("data").score}}),window.ltc.emit("returnValidate",{valid:e.validator.form()})}))}},{key:"setValidateRule",value:function(){$.validator.addMethod("arithmeticFloat",(function(e,t){return this.optional(t)||/^[0-9]+(\.[0-9]?)?$/.test(e)}),$.validator.format(Translator.trans("activity.testpaper_manage.arithmetic_float_error_hint"))),$.validator.addMethod("examLength",(function(e,t){return!(0==$('input[name="exam_mode"]').val()&&e<=0)}),$.validator.format(Translator.trans("course.plan_task.activity_manage.testpaper.mock_tips4")))}},{key:"initEvent",value:function(){var e=this;this.$element.find("#question-bank").on("change",(function(t){return e.changeQuestionBank(t)})),this.$element.find("#testpaper-media").on("change",(function(t){return e.changeTestPaper(t)})),this.$element.find("input[name=doTimes]").on("change",(function(t){return e.showRedoInterval(t)})),this.$element.find('input[name="testMode"]').on("change",(function(t){return e.startTimeCheck(t)})),this.$element.find(".js-testpaper-mode").on("click",(function(t){return e.switchExamMode(t)}))}},{key:"initAddComment",value:function(){var e=$("#customCommentTable"),t=e.find("tr").length;$("#addComment").on("click",(function(){var n='<tr>\n              <td class="form-inline">\n                <input type="text" class="form-control" name="start['+t+']" style="width: 47px; padding: 6px;"> -\n                <input type="text" class="form-control" name="end['+t+']" style="width: 47px; padding: 6px;">\n              </td>\n              <td class="form-inline">\n                <textarea name="comment['+t+']" rows="1" maxlength="1500" class="form-control js-comment-content" style="width: 339px;margin-right: 15px;"></textarea>\n                <div class="default-comment">\n                  <a href="javascript:;" class="js-default-comment">'+Translator.trans("activity.testpaper_manage.default_comment")+'</a>\n                   <div class="default-comment-list hidden">                   <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment1")+'</div>                    <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment2")+'</div>                    <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment3")+'</div>                    <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment4")+'</div>                    <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment5")+'</div>                  </div>                </div>\n              </td>\n              <td class="form-inline vertical-middle">\n                <a href="javascript:;" class="js-comment-remove">'+Translator.trans("activity.testpaper_manage.comment_remove")+"</a>\n              </td>\n            </tr>";e.append(n),e.removeClass("hidden"),t++})),e.on("input",".js-comment-content",(function(e){var t=e.target.scrollHeight-12;$(this).height(t)})),e.on("click",".js-comment-remove",(function(){$(this).parent().parent().remove()})),e.on("click",".js-default-comment-item",(function(){$(this).parent().parent().siblings(".js-comment-content").val($(this).text())}))}},{key:"initStepForm2",value:function(){this.validator=this.$form.validate({onkeyup:!1,rules:{title:{required:!0,trim:!0,maxlength:50,course_title:!0},testpaperId:{required:!0,digits:!0,min:1},length:{required:!0,digits:!0,examLength:!0},startTime:{required:function(){return 1==$('[name="doTimes"]:checked').val()&&"realTime"==$('[name="testMode"]:checked').val()},DateAndTime:function(){return 1==$('[name="doTimes"]:checked').val()&&"realTime"==$('[name="testMode"]:checked').val()}},redoInterval:{required:function(){return 0==$('[name="doTimes"]:checked').val()},arithmeticFloat:!0,max:1e9}},messages:{testpaperId:{required:Translator.trans("activity.testpaper_manage.media_error_hint"),min:Translator.trans("activity.testpaper_manage.media_error_hint")},redoInterval:{max:Translator.trans("activity.testpaper_manage.max_error_hint")}}})}},{key:"initSelectTestPaper",value:function(e){var t=o()(e.id);t?(this.getItemsTable(this.$testpaperSelector.data("getTestpaperItems"),t),$('input[name="title"]').val()||$('input[name="title"]').val(e.text),this.initScoreSlider()):($("#questionItemShowDiv").hide(),$("#js-test-and-comment").hide())}},{key:"initEmptyTestPaperSelector",value:function(){this.$testpaperSelector.select2({data:[{id:"0",text:Translator.trans("activity.testpaper_manage.media_required"),selected:!0}]})}},{key:"initAjaxTestPaperSelector",value:function(){this.$testpaperSelector.select2({ajax:{url:this.$testpaperSelector.data("url"),dataType:"json",quietMillis:250,data:function(e,t){return{keyword:e,page:t}},results:function(e,t){var n=[];return $.each(e.testPapers,(function(e,t){n.push({id:t.id,text:t.name,score:t.score})})),{results:n,more:10*t<e.openCount}}},initSelection:function(e,t){var n=$("#testPaperName").val(),r=e.val(),i=$("#score-condition").data("score");o()(r)||(n=""),t({id:r,text:n||Translator.trans("activity.testpaper_manage.media_required"),score:i})},formatSelection:function(e){return e.text},dropdownAutoWidth:!0}),this.$testpaperSelector.removeClass("hidden")}},{key:"initQuestionBankSelector",value:function(){this.$questionBankSelector.select2({treeview:!0,dropdownAutoWidth:!0,treeviewInitState:"collapsed",placeholderOption:"first",formatResult:function(e){var t=(e.text+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />");return e.id?'<div class="select2-result-text"><span class="select2-match"></span><span><i class="es-icon es-icon-tiku"></i>'.concat(t,"</span></div>"):t},dropdownCss:{width:""}})}},{key:"initTestPaperSelector",value:function(){$("#testPaperName").val()?this.initAjaxTestPaperSelector():this.initEmptyTestPaperSelector()}},{key:"changeQuestionBank",value:function(e){var t=$(".js-help-block");t.addClass("hidden"),this.$testpaperSelector.addClass("hidden"),this.$questionItemShow.hide(),this.$scoreItem.hide(),this.$testpaperSelector.val("0");var n=this.$questionBankSelector.select2("data").id;if(o()(n)){var r=this.$questionBankSelector.data("url");r=r.replace(/[0-9]/,n);var i=this;$.post(r,(function(e){return 0===e.totalCount?(t.addClass("color-danger").removeClass("hidden").text(Translator.trans("queston_bank.testpaper.empty_tips")).show(),void i.initEmptyTestPaperSelector()):0===e.openCount?(t.removeClass("color-danger").removeClass("hidden").text(Translator.trans("queston_bank.testpaper.no_open_tips")).show(),void i.initEmptyTestPaperSelector()):(i.$testpaperSelector.data("url",r),void i.initAjaxTestPaperSelector())})).error((function(e){cd.message({type:"danger",message:e.responseJson.error.message})}))}else this.initEmptyTestPaperSelector()}},{key:"changeTestPaper",value:function(e){var t=this.$testpaperSelector.select2("data");this.initSelectTestPaper(t)}},{key:"showRedoInterval",value:function(e){var t=$(e.currentTarget);$('input[name="showAnswerMode"]:checked').length&&$('input[name="showAnswerMode"]:checked').prop("checked",!1),1==t.val()?($("#lesson-redo-interval-field").closest(".form-group").hide(),$(".starttime-check-div").show(),$(".js-show-answer-mode").length>0&&$(".js-show-answer-mode").hide()):($("#lesson-redo-interval-field").closest(".form-group").show(),$(".starttime-check-div").hide(),$(".js-show-answer-mode").length>0&&$(".js-show-answer-mode").show())}},{key:"startTimeCheck",value:function(e){"realTime"==$(e.currentTarget).val()?($(".starttime-input").removeClass("hidden"),this.dateTimePicker()):$(".starttime-input").addClass("hidden")}},{key:"changeCondition",value:function(e){"score"!=$(e.currentTarget).find("option:selected").val()?$(".js-score-form-group").addClass("hidden"):$(".js-score-form-group").removeClass("hidden")}},{key:"getItemsTable",value:function(e,t){$.post(e,{testpaperId:t},(function(e){$("#questionItemShowTable").html(e),$("#questionItemShowDiv").show()}))}},{key:"dateTimePicker",value:function(){var e=this,t=new Date,n=$("#startTime");!n.is(":visible")||""!=n.val()&&"0"!=n.val()||n.val(t.Format("yyyy-MM-dd hh:mm")),n.datetimepicker({autoclose:!0,format:"yyyy-mm-dd hh:ii",language:document.documentElement.lang,minView:"hour",endDate:new Date(i()()+31536e7)}).on("show",(function(t){e.$form.height(e.$form.height()+270)})).on("hide",(function(t){e.validator.form(),e.$form.height(e.$form.height()-270)})).on("changeDate",(function(e){})),n.datetimepicker("setStartDate",t)}},{key:"initScoreSlider",value:function(){var e=0;e=this.$testpaperSelector.select2("data").score?this.$testpaperSelector.select2("data").score:$("#score-condition").data("score"),$(".js-score-total").text(e);var t=Math.round(e*$("#score-condition").data("pass"));e=o()(e);var n=document.getElementById("score-slider"),r={start:t,connect:[!0,!1],tooltips:[!0],step:1,range:{min:0,max:e}};this.scoreSlider&&this.scoreSlider.destroy(),this.scoreSlider=noUiSlider.create(n,r),n.noUiSlider.on("update",(function(t,n){var r=(100*(t[n]/e)).toFixed(0);$(".noUi-tooltip").text("".concat(r,"%")),$(".js-score-tooltip").css("left","".concat(r,"%")),$(".js-passScore").text(Math.round(r/100*e)),$("#finishData").val(r/100)}));var i=Translator.trans("activity.testpaper_manage.qualified_score_hint",{passScore:'<span class="js-passScore">'+t+"</span>"}),a='<div class="score-tooltip js-score-tooltip"><div class="tooltip top" role="tooltip" style="">\n      <div class="tooltip-arrow"></div>\n      <div class="tooltip-inner ">\n        '.concat(i,"\n      </div>\n      </div></div>");$(".noUi-handle").append(a),$(".noUi-tooltip").text("".concat((t/e*100).toFixed(0),"%")),$(".js-score-tooltip").css("left","".concat((t/e*100).toFixed(0),"%")),$("#js-test-and-comment").show()}},{key:"switchExamMode",value:function(e){var t=$(e.currentTarget),n=t.data("value");this.$element.find("#examMode").val(n),this.$element.find(".js-testpaper-mode").removeClass("active"),t.addClass("active"),$(".js-mode-helpblock").removeClass("hidden"),"0"==n?($(".js-enable_facein").removeClass("hidden"),$('label[for="length"]').addClass("control-label-required"),$(".js-mode-helpblock.js-mode-helpblock-1").addClass("hidden")):"1"==n&&($(".js-enable_facein").addClass("hidden"),$('label[for="length"]').removeClass("control-label-required"),$(".js-mode-helpblock.js-mode-helpblock-0").addClass("hidden"))}}]),e}())($("#iframe-content"))}]);