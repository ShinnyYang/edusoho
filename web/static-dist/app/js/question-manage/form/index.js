/*! For license information please see index.js.LICENSE.txt */
!function(t){function e(e){for(var a,i,c=e[0],l=e[1],u=e[2],f=0,d=[];f<c.length;f++)i=c[f],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);for(s&&s(e);d.length;)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,c=1;c<n.length;c++){var l=n[c];0!==r[l]&&(a=!1)}a&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},r={360:0},o=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/static-dist/";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var s=l;o.push([1521,0]),n()}({1521:function(t,e,n){"use strict";n.r(e);var a=n(29),r=n.n(a),o=n(12),i=n.n(o),c=n(38),l=n.n(c),u=n(17),s=n.n(u),f=n(22),d=n.n(f),h=n(20),p=n.n(h),m=n(68),v=n.n(m),y=n(15),g=n.n(y),b=n(118),w=n.n(b),k=n(23),_=n.n(k),A=n(37),x=n.n(A),D=n(24),S=n.n(D),E=n(186),j=n.n(E);function L(){L=function(){return e};var t,e={},n=Object.prototype,a=n.hasOwnProperty,o=d.a||function(t,e,n){t[e]=n.value},c="function"==typeof g.a?g.a:{},u=c.iterator||"@@iterator",f=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function p(t,e,n){return d()(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(t){p=function(t,e,n){return t[e]=n}}function m(t,e,n,a){var r=e&&e.prototype instanceof _?e:_,i=s()(r.prototype),c=new q(a||[]);return o(i,"_invoke",{value:O(t,n,c)}),i}function v(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=m;var y="suspendedStart",b="executing",w="completed",k={};function _(){}function A(){}function x(){}var D={};p(D,u,(function(){return this}));var $=l.a,E=$&&$($(U([])));E&&E!==n&&a.call(E,u)&&(D=E);var j=x.prototype=_.prototype=s()(D);function C(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function I(t,e){function n(r,o,c,l){var u=v(t[r],t,o);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==i()(f)&&a.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,c,l)}),(function(t){n("throw",t,c,l)})):e.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return n("throw",t,c,l)}))}l(u.arg)}var r;o(this,"_invoke",{value:function(t,a){function o(){return new e((function(e,r){n(t,a,e,r)}))}return r=r?r.then(o,o):o()}})}function O(e,n,a){var r=y;return function(o,i){if(r===b)throw Error("Generator is already running");if(r===w){if("throw"===o)throw i;return{value:t,done:!0}}for(a.method=o,a.arg=i;;){var c=a.delegate;if(c){var l=T(c,a);if(l){if(l===k)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===y)throw r=w,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=b;var u=v(e,n,a);if("normal"===u.type){if(r=a.done?w:"suspendedYield",u.arg===k)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(r=w,a.method="throw",a.arg=u.arg)}}}function T(e,n){var a=n.method,r=e.iterator[a];if(r===t)return n.delegate=null,"throw"===a&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),k;var o=v(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,k;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,k):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,k)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function q(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function U(e){if(e||""===e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function n(){for(;++r<e.length;)if(a.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(i()(e)+" is not iterable")}return A.prototype=x,o(j,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:A,configurable:!0}),A.displayName=p(x,h,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===A||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return r.a?r()(t,x):(t.__proto__=x,p(t,h,"GeneratorFunction")),t.prototype=s()(j),t},e.awrap=function(t){return{__await:t}},C(I.prototype),p(I.prototype,f,(function(){return this})),e.AsyncIterator=I,e.async=function(t,n,a,r,o){void 0===o&&(o=S.a);var i=new I(m(t,n,a,r),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},C(j),p(j,h,"Generator"),p(j,u,(function(){return this})),p(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=U,q.prototype={constructor:q,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(a,r){return c.type="throw",c.arg=e,n.next=a,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var l=a.call(i,"catchLoc"),u=a.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,k):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),k},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),k}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;N(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:U(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),k}},e}function C(t,e){var n=void 0!==g.a&&t[v.a]||t["@@iterator"];if(!n){if(p()(t)||(n=function(t,e){if(t){if("string"==typeof t)return I(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?w()(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){c=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}var O={data:function(){var t=$("[name=mode]").val(),e={};return"edit"===t&&((e=JSON.parse($("[name=item]").val())).questions=j()(e.questions)),{bank_id:$("[name=bank_id]").val(),mode:t,category:JSON.parse($("[name=category]").val()),subject:e,type:$("[name=type]").val(),showCKEditorData:{publicPath:$("[name=ckeditor_path]").val(),filebrowserImageUploadUrl:$("[name=ckeditor_image_upload_url]").val(),filebrowserImageDownloadUrl:$("[name=ckeditor_image_download_url]").val(),language:"zh_CN"===document.documentElement.lang?"zh-cn":document.documentElement.lang,jqueryPath:$("[name=jquery_path]").val()},showAttachment:$("[name=show_attachment]").val(),cdnHost:$("[name=cdn_host]").val(),uploadSDKInitData:{ui:"batch",multiple:!0,multitaskNum:3,fileNumLimit:3,sdkBaseUri:app.cloudSdkBaseUri,disableDataUpload:app.cloudDisableLogReport,disableSentry:app.cloudDisableLogReport,initUrl:$("[name=upload_init_url]").val(),finishUrl:$("[name=upload_finish_url]").val(),accept:JSON.parse($("[name=upload_accept]").val()),fileSingleSizeLimit:$("[name=upload_size_limit]").val(),locale:document.documentElement.lang},fileId:0,isDownload:!1,isDisable:null,aiAnalysisEnable:1==$("[name=ai_analysis_enable]").val()}},provide:function(){return{modeOrigin:"create",self:this}},methods:{getRepeatStem:function(t){var e=""!==t.data.material?t.data.material:t.data.questions[0].stem;return new S.a((function(n){$.ajax({url:$("[name=check_duplicative_url]").val(),contentType:"application/json;charset=utf-8",type:"post",data:x()({material:e,itemId:t.data.id}),beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){n(t)}))}))},getData:function(t){var e=this,n=this;n.isDisable=!0,this.getRepeatStem(t).then((function(a){a?e.$confirm({title:Translator.trans("created.question.confirm.title"),okText:Translator.trans("created.question.confirm.ok.btn"),cancelText:Translator.trans("created.question.confirm.close.btn"),icon:"exclamation-circle",class:"js-repeat-stem-text",onOk:function(){n.isDisable=!1,n.forceRemoveModalDom()},onCancel:function(){n.createdItemQuestion(t),n.forceRemoveModalDom()}}):n.createdItemQuestion(t)})).catch((function(t){console.log(t)}))},createdItemQuestion:function(t){var e=t.isAgain?"continue":"";(t=t.data).submission=e,t.type=$("[name=type]").val();var n=$("[name=mode]").val();$.ajax({url:"create"===n?$("[name=create_url]").val():$("[name=update_url]").val(),contentType:"application/json;charset=utf-8",type:"post",data:x()(t),beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){t.goto&&(window.location.href=t.goto)}))},forceRemoveModalDom:function(){var t=$(".js-repeat-stem-text").closest(".ant-modal-root");t&&t.remove(),document.body.style=""},goBack:function(){window.location.href=$("[name=back_url]").val()},deleteAttachment:function(t){this.fileId=t},previewAttachment:function(t){this.fileId=t},downloadAttachment:function(t){this.fileId=t},previewAttachmentCallback:function(){var t=this,e=this;return new S.a((function(n){$.ajax({url:$("[name=preview-attachment-url]").val(),type:"post",data:{id:t.fileId},beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){t.data.sdkBaseUri=app.cloudSdkBaseUri,t.data.disableDataUpload=app.cloudDisableLogReport,t.data.disableSentry=app.cloudDisableLogReport,n(t),e.fileId=0}))}))},downloadAttachmentCallback:function(){var t=this,e=this;return new S.a((function(n){$.ajax({url:$("[name=download-attachment-url]").val(),type:"post",data:{id:t.fileId},beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){n(t),e.fileId=0}))}))},deleteAttachmentCallback:function(){var t=this,e=this;return new S.a((function(n){$.ajax({url:$("[name=delete-attachment-url]").val(),type:"post",data:{id:t.fileId},beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){n(t),e.fileId=0}))}))},getAiAnalysis:function(t,e,n,a,r){return _()(L().mark((function o(){var i,c,l,u,s,f,d,h,p,m,v,y,g;return L().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!/<img .*>/.test(x()(t))){o.next=3;break}return e(),o.abrupt("return");case 3:return n(),t.role="teacher",o.next=8,fetch("/api/ai/question_analysis/generate",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Accept:"application/vnd.edusoho.v2+json"},body:x()(t)});case 8:i=o.sent,c=i.body.getReader(),l=new TextDecoder,u="";case 12:return o.next=15,c.read();case 15:s=o.sent,f=s.done,d=s.value,h=(u+l.decode(d)).split("\n\n"),p=1,m=C(h);try{for(m.s();!(v=m.n()).done;)y=v.value,p==h.length?u=y:("message"===(g=JSON.parse(y.slice(5))).event&&a(g.answer),p++)}catch(t){m.e(t)}finally{m.f()}if(!f){o.next=25;break}return r(),o.abrupt("break",27);case 25:o.next=12;break;case 27:case"end":return o.stop()}}),o)})))()}}},T=n(39),R=Object(T.a)(O,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ibs-vue",attrs:{id:"app"}},["create"===t.mode?n("item-manage",{attrs:{bank_id:t.bank_id,mode:t.mode,category:t.category,type:t.type,showCKEditorData:t.showCKEditorData,showAttachment:t.showAttachment,cdnHost:t.cdnHost,isDownload:t.isDownload,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,uploadSDKInitData:t.uploadSDKInitData,deleteAttachmentCallback:t.deleteAttachmentCallback,previewAttachmentCallback:t.previewAttachmentCallback,downloadAttachmentCallback:t.downloadAttachmentCallback},on:{getData:t.getData,goBack:t.goBack,deleteAttachment:t.deleteAttachment,previewAttachment:t.previewAttachment,downloadAttachment:t.downloadAttachment,getAiAnalysis:t.getAiAnalysis}}):t._e(),t._v(" "),"edit"===t.mode?n("item-manage",{attrs:{bank_id:t.bank_id,mode:t.mode,category:t.category,subject:t.subject,type:t.type,showCKEditorData:t.showCKEditorData,showAttachment:t.showAttachment,cdnHost:t.cdnHost,isDownload:t.isDownload,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,uploadSDKInitData:t.uploadSDKInitData,deleteAttachmentCallback:t.deleteAttachmentCallback,previewAttachmentCallback:t.previewAttachmentCallback,downloadAttachmentCallback:t.downloadAttachmentCallback},on:{getData:t.getData,goBack:t.goBack,deleteAttachment:t.deleteAttachment,previewAttachment:t.previewAttachment,downloadAttachment:t.downloadAttachment,getAiAnalysis:t.getAiAnalysis}}):t._e()],1)}),[],!1,null,null,null).exports;if(Vue.config.productionTip=!1,"en"==app.lang){var N=local.default;itemBank.default.install(Vue,{locale:N})}new Vue({render:function(t){return t(R)}}).$mount("#app")},186:function(t,e,n){t.exports=n(255)},252:function(t,e,n){var a=n(127),r=n(210),o=n(161),i=n(221).f;t.exports=function(t){return function(e){for(var n,c=o(e),l=r(c),u=l.length,s=0,f=[];u>s;)n=l[s++],a&&!i.call(c,n)||f.push(t?[n,c[n]]:c[n]);return f}}},255:function(t,e,n){n(256),t.exports=n(56).Object.values},256:function(t,e,n){var a=n(77),r=n(252)(!1);a(a.S,"Object",{values:function(t){return r(t)}})}});