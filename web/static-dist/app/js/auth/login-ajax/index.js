!function(e){function n(n){for(var r,i,s=n[0],c=n[1],d=n[2],u=0,h=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&h.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(n);h.length;)h.shift()();return a.push.apply(a,d||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],r=!0,s=1;s<t.length;s++){var c=t[s];0!==o[c]&&(r=!1)}r&&(a.splice(n--,1),e=i(i.s=t[0]))}return e}var r={},o={130:0},a=[];function i(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=r,i.d=function(e,n,t){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)i.d(t,r,function(n){return e[n]}.bind(null,r));return t},i.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="/static-dist/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=n,s=s.slice();for(var d=0;d<s.length;d++)n(s[d]);var l=c;a.push([937,0]),t()}({353:function(e,n){!function(e){"use strict";var n,t;void 0===e.btoa&&(e.btoa=(n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),function(e){var t,r,o,a,i,s,c;for(r=o=0,a=e.length,s=(a-=i=a%3)/3<<2,i>0&&(s+=4),t=new Array(s);r<a;)c=e.charCodeAt(r++)<<16|e.charCodeAt(r++)<<8|e.charCodeAt(r++),t[o++]=n[c>>18]+n[c>>12&63]+n[c>>6&63]+n[63&c];return 1==i?(c=e.charCodeAt(r++),t[o++]=n[c>>2]+n[(3&c)<<4]+"=="):2==i&&(c=e.charCodeAt(r++)<<8|e.charCodeAt(r++),t[o++]=n[c>>10]+n[c>>4&63]+n[(15&c)<<2]+"="),t.join("")})),void 0===e.atob&&(e.atob=(t=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],function(e){var n,r,o,a,i,s,c,d,l,u;if((c=e.length)%4!=0)return"";if(/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\+\/\=]/.test(e))return"";for(l=c,(d="="==e.charAt(c-2)?1:"="==e.charAt(c-1)?2:0)>0&&(l-=4),l=3*(l>>2)+d,u=new Array(l),i=s=0;i<c&&-1!=(n=t[e.charCodeAt(i++)])&&-1!=(r=t[e.charCodeAt(i++)])&&(u[s++]=String.fromCharCode(n<<2|(48&r)>>4),-1!=(o=t[e.charCodeAt(i++)]))&&(u[s++]=String.fromCharCode((15&r)<<4|(60&o)>>2),-1!=(a=t[e.charCodeAt(i++)]));)u[s++]=String.fromCharCode((3&o)<<6|a);return u.join("")}));var r=2654435769;function o(e,n){var t=e.length,r=t<<2;if(n){var o=e[t-1];if(o<(r-=4)-3||o>r)return null;r=o}for(var a=0;a<t;a++)e[a]=String.fromCharCode(255&e[a],e[a]>>>8&255,e[a]>>>16&255,e[a]>>>24&255);var i=e.join("");return n?i.substring(0,r):i}function a(e,n){var t,r=e.length,o=r>>2;0!=(3&r)&&++o,n?(t=new Array(o+1))[o]=r:t=new Array(o);for(var a=0;a<r;++a)t[a>>2]|=e.charCodeAt(a)<<((3&a)<<3);return t}function i(e){return 4294967295&e}function s(e,n,t,r,o,a){return(t>>>5^n<<2)+(n>>>3^t<<4)^(e^n)+(a[3&r^o]^t)}function c(e){return e.length<4&&(e.length=4),e}function d(e){if(/^[\x00-\x7f]*$/.test(e))return e;for(var n=[],t=e.length,r=0,o=0;r<t;++r,++o){var a=e.charCodeAt(r);if(a<128)n[o]=e.charAt(r);else if(a<2048)n[o]=String.fromCharCode(192|a>>6,128|63&a);else{if(!(a<55296||a>57343)){if(r+1<t){var i=e.charCodeAt(r+1);if(a<56320&&56320<=i&&i<=57343){var s=65536+((1023&a)<<10|1023&i);n[o]=String.fromCharCode(240|s>>18&63,128|s>>12&63,128|s>>6&63,128|63&s),++r;continue}}throw new Error("Malformed string")}n[o]=String.fromCharCode(224|a>>12,128|a>>6&63,128|63&a)}}return n.join("")}function l(e,n){return(null==n||n<0)&&(n=e.length),0===n?"":/^[\x00-\x7f]*$/.test(e)||!/^[\x00-\xff]*$/.test(e)?n===e.length?e:e.substr(0,n):n<65535?function(e,n){for(var t=new Array(n),r=0,o=0,a=e.length;r<n&&o<a;r++){var i=e.charCodeAt(o++);switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t[r]=i;break;case 12:case 13:if(!(o<a))throw new Error("Unfinished UTF-8 octet sequence");t[r]=(31&i)<<6|63&e.charCodeAt(o++);break;case 14:if(!(o+1<a))throw new Error("Unfinished UTF-8 octet sequence");t[r]=(15&i)<<12|(63&e.charCodeAt(o++))<<6|63&e.charCodeAt(o++);break;case 15:if(!(o+2<a))throw new Error("Unfinished UTF-8 octet sequence");var s=((7&i)<<18|(63&e.charCodeAt(o++))<<12|(63&e.charCodeAt(o++))<<6|63&e.charCodeAt(o++))-65536;if(!(0<=s&&s<=1048575))throw new Error("Character outside valid Unicode range: 0x"+s.toString(16));t[r++]=s>>10&1023|55296,t[r]=1023&s|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+i.toString(16))}}return r<n&&(t.length=r),String.fromCharCode.apply(String,t)}(e,n):function(e,n){for(var t=[],r=new Array(32768),o=0,a=0,i=e.length;o<n&&a<i;o++){var s=e.charCodeAt(a++);switch(s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r[o]=s;break;case 12:case 13:if(!(a<i))throw new Error("Unfinished UTF-8 octet sequence");r[o]=(31&s)<<6|63&e.charCodeAt(a++);break;case 14:if(!(a+1<i))throw new Error("Unfinished UTF-8 octet sequence");r[o]=(15&s)<<12|(63&e.charCodeAt(a++))<<6|63&e.charCodeAt(a++);break;case 15:if(!(a+2<i))throw new Error("Unfinished UTF-8 octet sequence");var c=((7&s)<<18|(63&e.charCodeAt(a++))<<12|(63&e.charCodeAt(a++))<<6|63&e.charCodeAt(a++))-65536;if(!(0<=c&&c<=1048575))throw new Error("Character outside valid Unicode range: 0x"+c.toString(16));r[o++]=c>>10&1023|55296,r[o]=1023&c|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+s.toString(16))}if(o>=32766){var d=o+1;r.length=d,t[t.length]=String.fromCharCode.apply(String,r),n-=d,o=-1}}return o>0&&(r.length=o,t[t.length]=String.fromCharCode.apply(String,r)),t.join("")}(e,n)}function u(e,n){return null==e||0===e.length?e:(e=d(e),n=d(n),o(function(e,n){var t,o,a,c,d,l,u=e.length,h=u-1;for(o=e[h],a=0,l=0|Math.floor(6+52/u);l>0;--l){for(c=(a=i(a+r))>>>2&3,d=0;d<h;++d)t=e[d+1],o=e[d]=i(e[d]+s(a,t,o,d,c,n));t=e[0],o=e[h]=i(e[h]+s(a,t,o,h,c,n))}return e}(a(e,!0),c(a(n,!1))),!1))}function h(e,n){return null==e||0===e.length?e:(n=d(n),l(o(function(e,n){var t,o,a,c,d,l=e.length,u=l-1;for(t=e[0],a=i(Math.floor(6+52/l)*r);0!==a;a=i(a-r)){for(c=a>>>2&3,d=u;d>0;--d)o=e[d-1],t=e[d]=i(e[d]-s(a,t,o,d,c,n));o=e[u],t=e[0]=i(e[0]-s(a,t,o,0,c,n))}return e}(a(e,!1),c(a(n,!1))),!0)))}e.XXTEA={utf8Encode:d,utf8Decode:l,encrypt:u,encryptToBase64:function(n,t){return e.btoa(u(n,t))},decrypt:h,decryptFromBase64:function(n,t){return null==n||0===n.length?n:h(e.atob(n),t)}}}(window)},425:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(2),o=t.n(r),a=t(3),i=t.n(a),s=function(){function e(n){o()(this,e),this.options=n,this.$element=this.options.element,this.$loginDom=$(".js-sts-login"),this.init()}return i()(e,[{key:"init",value:function(){this.bindEvent(),this.closeModal()}},{key:"bindEvent",value:function(){var e=this;this.$loginDom.on("click",".js-login-back",(function(){return e.back()})),this.$loginDom.on("click",".js-invalid-btn",(function(){return e.refresh()})),this.$loginDom.on("click",".js-approve-again-btn",(function(){return e.approveAgain()})),this.$element.on("click",".js-sts-login-link",(function(){return e.showQrcode()}))}},{key:"back",value:function(){$(".js-approve-ing, .js-feedback, .js-sts-login").addClass("hidden"),this.options.target?this.$element.find(this.options.target).removeClass("hidden"):this.$element.removeClass("hidden")}},{key:"showQrcode",value:function(){var e=this;$.ajax({type:"post",url:this.$loginDom.data("url"),dataType:"json",success:function(n){console.log(n),e.$loginDom.find(".js-sts-login-qrcode img").attr("src",n.qrcode),e.onlyShow(),e.token=n.token,e.pollStatus()}})}},{key:"approveAgain",value:function(){$(".js-feedback").addClass("hidden"),$(".js-login-section, .js-sts-tip").removeClass("hidden"),this.refresh()}},{key:"refresh",value:function(){$(".js-approve-ing").addClass("hidden"),this.showQrcode()}},{key:"pollStatus",value:function(){var e=this,n=this.token,t=this.$loginDom.data("goto"),r=$(".js-fail-feedback"),o=$(".js-success-feedback"),a=$(".js-fail-tip"),i=$(".js-approve-again-btn");this.$loginDom.hasClass("hidden")||this.flag||$.get("/login/face_token/".concat(n),{goto:t},(function(n){switch(n.status){case"created":setTimeout((function(){e.pollStatus()}),2e3);break;case"processing":$(".js-invalid-btn").addClass("hidden"),$(".js-approve-ing, .js-approve-ing-tip").removeClass("hidden"),setTimeout((function(){e.pollStatus()}),2e3);break;case"expired":$(".js-approve-ing-tip").addClass("hidden"),$(".js-approve-ing, .js-invalid-btn").removeClass("hidden");break;case"successed":e.statusShow(),o.removeClass("hidden").siblings().addClass("hidden"),window.location.href=n.url;break;case"failed":e.feedbackShow(r,i,a);break;case"failures":e.feedbackShow(r,a,i)}}))}},{key:"closeModal",value:function(){var e=this;$("#login-modal").on("hide.bs.modal",(function(){e.flag=!0}))}},{key:"onlyShow",value:function(){$(".js-sts-login, .js-login-section, .js-sts-tip").removeClass("hidden"),this.options.target?this.$element.find(this.options.target).addClass("hidden"):this.$element.addClass("hidden")}},{key:"statusShow",value:function(){$(".js-login-section, .js-sts-tip").addClass("hidden"),$(".js-feedback").removeClass("hidden")}},{key:"feedbackShow",value:function(e,n,t){this.statusShow(),e.removeClass("hidden").siblings().addClass("hidden"),n.removeClass("hidden"),t.addClass("hidden")}}]),e}()},937:function(e,n,t){"use strict";t.r(n);var r=t(425),o=t(83);t(353);var a=$("#login-ajax-form"),i=$("#drag-btn").length?new o.a($("#drag-btn"),$(".js-jigsaw"),{limitType:"user_login"}):null,s=$(".js-submit-login-ajax"),c=a.validate({rules:{_username:{required:!0},_password:{required:!0},dragCaptchaToken:{required:!0}},messages:{_username:{required:Translator.trans("auth.login.username_required_error_hint")},_password:{required:Translator.trans("auth.login.password_required_error_hint")},dragCaptchaToken:{required:Translator.trans("auth.register.drag_captcha_tips")}}});s.click((function(e){var n=a.find("#ajax-username").val(),t=a.find("#ajax-password").val(),r=window.XXTEA.encryptToBase64(n,"EduSoho"),o=window.XXTEA.encryptToBase64(t,"EduSoho"),d=$("<input>",{type:"hidden",name:"_username",value:r}),l=$("<input>",{type:"hidden",name:"_password",value:o});a.append(d,l),c.form()&&$.post(a.attr("action"),a.serialize(),(function(e){s.button("loading"),window.location.reload()}),"json").error((function(e,n,t){var r=jQuery.parseJSON(e.responseText);a.find(".alert-danger").html(Translator.trans(r.message)).show(),i.initDragCaptcha()}))})),$(".js-sts-login-link").length&&new r.a({element:$(".js-login-modal"),target:".js-login-form, .modal-footer"});var d=$("#login-modal");$("#sms-login").click((function(e){$.get($(e.currentTarget).data("url"),(function(e){d.html(e)}))}))}});