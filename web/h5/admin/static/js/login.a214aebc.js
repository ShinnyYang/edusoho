(window.webpackJsonp=window.webpackJsonp||[]).push([["login"],{7067:function(e,t,r){"use strict";r("e17f");var n=r("2241"),i=(r("e7e5"),r("d399")),s=r("a026"),a=r("3ce7"),o=/micromessenger/.test(navigator.userAgent.toLowerCase());t.a=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||r&&!t)i.a.fail("缺少分享参数");else{var c={domainUri:location.origin,itemUri:"",source:"h5"};a.a.marketingActivities({query:{activityId:e},data:c}).then((function(e){var a=-1!==e.url.indexOf("?")?"&":"?",c=r?"".concat(t).concat(a,"ticket=").concat(e.ticket):e.url;o?window.location.href=c:n.a.confirm({message:"去微信完成活动",confirmButtonText:"复制链接",title:""}).then((function(){try{s.default.prototype.$copyText(c).then((function(){i.a.success("复制成功")}),(function(){i.a.fail("请更换浏览器复制")}))}catch(e){i.a.fail("请更换浏览器复制")}})).catch((function(){}))})).catch((function(e){i.a.fail(e.message)}))}}},"89eb":function(e,t,r){"use strict";r.r(t),r("8e6e"),r("ac6a"),r("456d"),r("e7e5");var n=r("d399"),i=r("bd86"),s=r("2f62"),a=r("3ce7");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){Object(i.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u={data:function(){return{username:"",password:"",faceRegistered:0,errorMessage:{password:""}}},computed:{btnSubmitDisable:function(){return!this.username},btnDisable:function(){return!(this.username&&this.password)}},methods:c(c({},Object(s.c)(["userLogin"])),{},{onSubmitInfo:function(){var e,t=this;e=/^1\d{10}$/.test(this.username)?"mobile":/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(this.username)?"email":"nickname",a.a.getUserIsExisted({query:{type:this.username},params:{identifyType:e}}).then((function(e){e.id?"0"===e.faceRegistered?(t.faceRegistered=e.faceRegistered,Object(n.a)({duration:2e3,message:"初次使用请验证密码"})):t.$router.push({name:"verification",query:{redirect:t.$route.query.redirect||"",loginToken:t.$route.query.loginToken||"",type:"compare",faceRegistered:0,loginField:t.username}}):n.a.fail({duration:2e3,message:"用户不存在"})})).catch((function(e){n.a.fail(e.message)}))},checkName:function(){this.faceRegistered=0},onCheckExisted:function(){var e=this;this.userLogin({username:this.username,password:this.password}).then((function(t){e.$router.push({name:"verification",query:{redirect:e.$route.query.redirect||"",loginToken:e.$route.query.loginToken||"",type:"register",faceRegistered:1}})})).catch((function(e){n.a.fail(e.message)}))}})},l=r("0c7c"),g=Object(l.a)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login"},[r("span",{staticClass:"login-title"},[e._v("确认账号")]),r("van-field",{staticClass:"login-input e-input",attrs:{placeholder:"请输入邮箱/手机/用户名"},on:{input:e.checkName},model:{value:e.username,callback:function(t){e.username="string"==typeof t?t.trim():t},expression:"username"}}),e.faceRegistered?r("van-field",{staticClass:"login-input e-input",attrs:{"error-message":e.errorMessage.password,type:"password",placeholder:"请输入密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}):e._e(),e.faceRegistered?r("van-button",{staticClass:"primary-btn mb20",attrs:{disabled:e.btnDisable,type:"default"},on:{click:e.onCheckExisted}},[e._v("下一步")]):r("van-button",{staticClass:"primary-btn mb20",attrs:{disabled:e.btnSubmitDisable,type:"default"},on:{click:e.onSubmitInfo}},[e._v("下一步")])],1)}),[],!1,null,null,null);t.default=g.exports},affc:function(e,t,r){"use strict";r.r(t),r("8e6e"),r("ac6a"),r("456d"),r("a481"),r("c5f6");var n=r("bd86"),i=(r("e7e5"),r("d399")),s=(r("96cf"),r("3b8d")),a=r("d863"),o=r("2f62"),c=r("3ce7");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g={mixins:[a.a],data:function(){return{username:"",password:"",errorMessage:{password:""},faceSetting:0,bodyHeight:520,loginConfig:{},cloudSetting:!1,userTerms:!1,privacyPolicy:!1,agreement:!1,popUpBottom:!1}},computed:{btnDisable:function(){return!(this.username&&this.password)},isWeixinBrowser:function(){return/micromessenger/.test(navigator.userAgent.toLowerCase())},canloginConfig:function(){return!this.$route.query||!this.$route.query.forbidWxLogin}},created:function(){var e=this;return Object(s.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$store.state.token){t.next=4;break}return i.a.loading({message:e.$t("toast.pleaseWait")}),e.afterLogin(),t.abrupt("return");case 4:return t.next=6,c.a.getSettings({query:{type:"register"}}).catch((function(e){i.a.fail(e.message)}));case 6:e.registerSettings=t.sent,e.getsettingsCloud(),e.getPrivacySetting();case 9:case"end":return t.stop()}}),t)})))()},mounted:function(){this.bodyHeight=document.documentElement.clientHeight-46,this.username=this.$route.params.username||this.$route.query.account||"",i.a.loading({message:this.$t("toast.pleaseWait")}),this.faceLogin(),this.thirdPartyLogin()},methods:l(l({},Object(o.c)(["userLogin"])),{},{getPrivacySetting:function(){var e=this;return Object(s.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.getSettings({query:{type:"user"}}).then((function(t){t.auth.user_terms_enabled&&(e.userTerms=!0),t.auth.privacy_policy_enabled&&(e.privacyPolicy=!0)})).catch((function(e){i.a.fail(e.message)}));case 2:case"end":return t.stop()}}),t)})))()},lookPrivacyPolicy:function(){window.location.href=window.location.origin+"/mapi_v2/School/getPrivacyPolicy"},lookUserTerms:function(){window.location.href=window.location.origin+"/mapi_v2/School/getUserterms"},getsettingsCloud:function(){var e=this;return Object(s.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.settingsCloud().then((function(t){e.cloudSetting=!!t.sms_enabled})).catch((function(e){i.a.fail(e.message)}));case 2:case"end":return t.stop()}}),t)})))()},onSubmit:function(e){var t=this;this.agreement?this.userLogin({username:this.username,password:this.password}).then((function(e){i.a.success({duration:1e3,message:t.$t("toast.signInSuccessfully")}),t.afterLogin()})).catch((function(e){i.a.fail(e.message)})):this.popUpBottom=!0},agreeSign:function(){var e=this;this.userLogin({username:this.username,password:this.password}).then((function(t){e.agreement=!0,e.popUpBottom=!1,i.a.success({duration:1e3,message:e.$t("toast.signInSuccessfully")}),e.afterLogin()})).catch((function(t){i.a.fail(t.message),e.popUpBottom=!1}))},jumpRegister:function(){this.registerSettings&&"closed"!==this.registerSettings.mode&&"email"!==this.registerSettings.mode?this.$router.push({name:"register",query:{redirect:this.$route.query.redirect||"/"}}):Object(i.a)(this.$t("toast.contactTheAdministrator"))},faceLogin:function(){var e=this;c.a.settingsFace({}).then((function(t){Number(t.login.enabled)?e.faceSetting=Number(t.login.h5_enabled):e.faceSetting=0})).catch((function(e){i.a.fail(e.message)}))},thirdPartyLogin:function(){var e=this;this.canloginConfig&&c.a.loginConfig({}).then((function(t){i.a.clear(),e.loginConfig=t,Number(t.weixinmob_enabled)&&e.isWeixinBrowser&&e.wxLogin()})).catch((function(e){i.a.fail(e.message),i.a.clear()}))},wxLogin:function(){this.$router.replace({path:"/auth/social",query:{type:"wx",weixinmob_key:this.loginConfig.weixinmob_key,redirect:this.$route.query.redirect||"/",callbackType:this.$route.query.callbackType,activityId:this.$route.query.activityId}})},changeLogin:function(){this.$route.query.redirect?this.$router.push({name:"fastlogin",query:{redirect:this.$route.query.redirect}}):this.$router.push({name:"fastlogin"})}})},p=r("0c7c"),d=Object(p.a)(g,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login",style:{height:e.bodyHeight+"px"}},[r("span",{staticClass:"login-title"},[e._v(e._s(e.$t("title.loginAccount")))]),r("img",{staticClass:"login-avatarimg",attrs:{src:""}}),r("van-field",{staticClass:"login-input e-input",attrs:{autosize:{maxHeight:24},border:!1,type:"textarea",placeholder:e.$t("placeholder.emailMobileNumberUserName")},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),r("van-field",{staticClass:"login-input e-input",attrs:{border:!1,"error-message":e.errorMessage.password,type:"password",placeholder:e.$t("placeholder.password")},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),r("div",{staticClass:"login-register"},[r("router-link",{staticClass:"login-account",attrs:{to:"/setting/password/reset"}},[e._v("\n      "+e._s(e.$t("btn.forgetPassword"))+" ？  |\n    ")]),r("span",{staticClass:"login-account",on:{click:e.jumpRegister}},[e._v("\n        "+e._s(e.$t("btn.registerNow"))+"  \n    ")])],1),r("van-button",{staticClass:"primary-btn mb20",attrs:{disabled:e.btnDisable,type:"info"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("btn.login")))]),r("div",{staticClass:"login-bottom text-center"},[e.userTerms||e.privacyPolicy?r("div",{staticClass:"login-agree"},[r("van-checkbox",{attrs:{"icon-size":16,"checked-color":"#408ffb"},model:{value:e.agreement,callback:function(t){e.agreement=t},expression:"agreement"}}),e._v("\n      "+e._s(e.$t("tips.iHaveReadAndAgreeToThe"))+"\n      "),e.userTerms?r("i",{on:{click:e.lookUserTerms}},[e._v("《"+e._s(e.$t("btn.userServiceAgreement"))+"》")]):e._e(),e.userTerms&&e.privacyPolicy?r("span",[e._v(e._s(e.$t("tips.and")))]):e._e(),e.privacyPolicy?r("span",[r("i",{on:{click:e.lookPrivacyPolicy}},[e._v("《"+e._s(e.$t("btn.privacyAgreemen"))+"》")])]):e._e()],1):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:e.cloudSetting,expression:"cloudSetting"}],staticClass:"login-change",on:{click:e.changeLogin}},[r("img",{staticClass:"login_change-icon",attrs:{src:"static/images/login_change.png"}}),e._v(e._s(e.$t("btn.loginWithMobileNumber"))+"\n    ")])]),r("van-popup",{staticClass:"login-pop",style:{height:"30%"},attrs:{position:"bottom",round:""},model:{value:e.popUpBottom,callback:function(t){e.popUpBottom=t},expression:"popUpBottom"}},[r("div",{staticClass:"login-pop-title"},[e._v(e._s(e.$t("btn.PleaseReadAgreeAndTerms")))]),e.userTerms||e.privacyPolicy?r("div",{staticClass:"login-agree"},[e.userTerms?r("i",{on:{click:e.lookUserTerms}},[e._v("《"+e._s(e.$t("btn.userServiceAgreement"))+"》")]):e._e(),e.privacyPolicy?r("span",[r("i",{on:{click:e.lookPrivacyPolicy}},[e._v("《"+e._s(e.$t("btn.privacyAgreemen"))+"》")])]):e._e()]):e._e(),r("van-button",{staticClass:"primary-btn mb20 login-pop-btn",attrs:{disabled:e.btnDisable,type:"info"},on:{click:e.agreeSign}},[e._v(e._s(e.$t("btn.agreeAndSignin")))])],1)],1)}),[],!1,null,null,null);t.default=d.exports},d863:function(e,t,r){"use strict";r("8e6e"),r("ac6a"),r("456d"),r("a481");var n=r("bd86"),i=r("7067"),s=r("3ce7"),a=r("faa5"),o=r("2f62");function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.a={data:function(){return{redirect:""}},computed:u({},Object(o.e)({user:function(e){return e.user}})),created:function(){this.redirect=decodeURIComponent(this.$route.fullPath)},methods:u(u({},Object(o.d)([a.w])),{},{afterLogin:function(){var e=this;this.checkMobileBind().then((function(t){var r=t.is_bind_mobile,n=t.mobile_bind_mode;e[a.w]({is_bind_mobile:r,mobile_bind_mode:n}),r||"closed"===n?setTimeout(e.jumpAction,1e3):e.$router.replace({name:"binding",query:{redirect:e.$route.query.redirect}})})).catch((function(){setTimeout(e.jumpAction,1e3)}))},jumpAction:function(){var e=this.$route.query.redirect?decodeURIComponent(this.$route.query.redirect):"/",t=this.$route.query.skipUrl?decodeURIComponent(this.$route.query.skipUrl):"",r=this.$route.query.callbackType,n=this.$route.query.activityId,s=decodeURIComponent(this.$route.query.callback);if(r)switch(r){case"marketing":Object(i.a)(n,s)}else t?this.$router.replace({path:e,query:{backUrl:t}}):this.$router.replace({path:e})},checkMobileBind:function(){return s.a.mobileBindCheck({query:{userId:this.user.id}})}})}}}]);