(window.webpackJsonp=window.webpackJsonp||[]).push([["exerciseAnalysis~exerciseDo~homeworkAnalysis~homeworkDo~testpaperAnalysis~testpaperDo"],{"05b5":function(t,e,n){"use strict";var a=n("941d");n.n(a).a},"118d":function(t,e,n){},"171d":function(t,e,n){},"20ed":function(t,e,n){"use strict";var a=n("aeb8");n.n(a).a},"32e6":function(t,e){function n(t,e){t.onload=function(){this.onerror=this.onload=null,e(null,t)},t.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),t)}}function a(t,e){t.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,t))}}t.exports=function(t,e,s){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("script");"function"==typeof e&&(s=e,e={}),e=e||{},s=s||function(){},r.type=e.type||"text/javascript",r.charset=e.charset||"utf8",r.async=!("async"in e)||!!e.async,r.src=t,e.attrs&&function(t,e){for(var n in e)t.setAttribute(n,e[n])}(r,e.attrs),e.text&&(r.text=""+e.text),("onload"in r?n:a)(r,s),r.onload||n(r,s),i.appendChild(r)}},"4f7f":function(t,e,n){"use strict";var a=n("c26b"),s=n("b39a");t.exports=n("e0b8")("Set",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return a.def(s(this,"Set"),t=0===t?0:t,t)}},a)},"7c97":function(t,e,n){"use strict";var a={props:{type:{type:String,default:""},isShow:{type:Boolean,default:!1},reportType:{type:String,default:""}},methods:{onKeepLearning:function(t){this.$emit("outFocusMask",t)}}},s=n("a6c2"),i=Object(s.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isShow?n("div",{staticClass:"out-focus-mask"},[n("div",{staticClass:"report-go-back",on:{click:function(e){return t.$router.go(-1)}}},[n("van-icon",{attrs:{name:"arrow-left",size:"25",color:"#43bc60"}})],1),"kick_previous"===t.type?[n("div",{staticClass:"content"},[t._m(0),n("van-button",{attrs:{color:"#43bc60",size:"small"},on:{click:function(e){return t.onKeepLearning("kick_previous")}}},[t._v("\n        继续学习\n      ")])],1)]:t._e(),"reject_current"===t.type?[t._m(1)]:t._e()],2):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tips"},[e("p",{staticClass:"kick-each-other"},[this._v("请勿同时多开任务学习")]),e("p",{staticClass:"kick-each-other"},[this._v("不要一心多用哦！")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("div",{staticClass:"tips"},[e("p",{staticClass:"kick-each-other"},[this._v("请勿同时多开任务学习")]),e("p",{staticClass:"kick-each-other"},[this._v("不要一心多用哦！")])])])}],!1,null,null,null);e.a=i.exports},"8ae7":function(t,e,n){"use strict";n("a481");var a=n("75fc");n("4f7f"),n("5df3"),n("1c4c"),n("ac6a"),n("6c7b"),n("c5f6"),e.a={methods:{sixType:function(t,e,n){if("essay"!==t&&"fill"!==t){var a=n?n[e.id]:[];return{item:e,answer:a=e.testResult&&e.testResult.answer?e.testResult.answer.map((function(t){return Number(t)})):a}}if("essay"===t){var s=n?n[e.id]:[""];return{item:e,answer:s=e.testResult&&e.testResult.answer?e.testResult.answer:s}}if("fill"===t){var i=this.fillReplce(e.stem,0),r=i.stem,o=i.index;e.stem=r,e.fillnum=o;var c=n?n[e.id]:new Array(o).fill("");return{item:e,answer:c=e.testResult&&e.testResult.answer?e.testResult.answer:c}}return""},analysisSixType:function(t,e){var n=[];if("fill"!==t&&"essay"!==t&&(e.answer.forEach((function(t,n){e.answer[n]=Number(t)})),n=e.answer,e.testResult&&(e.testResult.answer.forEach((function(t,n){e.testResult.answer[n]=Number(t)})),n=Array.from(new Set([].concat(Object(a.a)(e.answer),Object(a.a)(e.testResult.answer)))))),"essay"===t&&(n=e.testResult?e.testResult.answer:[]),"fill"===t){var s=this.fillReplce(e.stem,0),i=s.stem,r=s.index;e.stem=i,e.fillnum=r,n=e.testResult?e.testResult.answer:new Array(r).fill("")}return{item:e,answer:n}},fillReplce:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=/\[\[.+?\]\]/;null!==n.exec(t);)t=t.replace(n,(function(){return'<span class=""> ('.concat(e+=1,") ____</span>")}));return{stem:t,index:e}}}}},"941d":function(t,e,n){},"9b05":function(t,e,n){"use strict";var a=n("118d");n.n(a).a},a049:function(t,e,n){"use strict";var a=n("b8e34");n.n(a).a},a556:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n("e7e5");var a=n("d399"),s=n("6647"),i=function(t){switch(t){case"course":Object(a.a)(s.a.t("goods.courseClosedToast"));break;case"classroom":Object(a.a)(s.a.t("goods.classroomClosedToast"));break;case"exercise":Object(a.a)(s.a.t("goods.exerciseClosedToast"))}}},aeb8:function(t,e,n){},b39a:function(t,e,n){var a=n("d3f4");t.exports=function(t,e){if(!a(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},b8e34:function(t,e,n){},c26b:function(t,e,n){"use strict";var a=n("86cc").f,s=n("2aeb"),i=n("dcbc"),r=n("9b43"),o=n("f605"),c=n("4a59"),l=n("01f9"),u=n("d53b"),d=n("7a56"),h=n("9e1e"),p=n("67ab").fastKey,m=n("b39a"),f=h?"_s":"size",g=function(t,e){var n,a=p(e);if("F"!==a)return t._i[a];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,l){var u=t((function(t,a){o(t,u,e,"_i"),t._t=e,t._i=s(null),t._f=void 0,t._l=void 0,t[f]=0,void 0!=a&&c(a,n,t[l],t)}));return i(u.prototype,{clear:function(){for(var t=m(this,e),n=t._i,a=t._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete n[a.i];t._f=t._l=void 0,t[f]=0},delete:function(t){var n=m(this,e),a=g(n,t);if(a){var s=a.n,i=a.p;delete n._i[a.i],a.r=!0,i&&(i.n=s),s&&(s.p=i),n._f==a&&(n._f=s),n._l==a&&(n._l=i),n[f]--}return!!a},forEach:function(t){m(this,e);for(var n,a=r(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(a(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(m(this,e),t)}}),h&&a(u.prototype,"size",{get:function(){return m(this,e)[f]}}),u},def:function(t,e,n){var a,s,i=g(t,e);return i?i.v=n:(t._l=i={i:s=p(e,!0),k:e,v:n,p:a=t._l,n:void 0,r:!1},t._f||(t._f=i),a&&(a.n=i),t[f]++,"F"!==s&&(t._i[s]=i)),t},getEntry:g,setStrong:function(t,e,n){l(t,e,(function(t,n){this._t=m(t,e),this._k=n,this._l=void 0}),(function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?u(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,u(1))}),n?"entries":"values",!n,!0),d(e)}}},c8a5:function(t,e,n){"use strict";n("6762"),n("2fdb");var a=n("3ce7"),s=n("faa5");n("a556"),e.a={data:function(){return{reportIntervalTime:null,reportLearnTime:null,reportFinishCondition:null,reportData:{courseId:null,taskId:null},reportResult:null,isFinish:!1,reportType:null,learnTime:0,isShowOutFocusMask:!1,outFocusMaskType:"",sign:"",record:{},absorbed:0,learnedTime:0,playKey:""}},beforeRouteLeave:function(t,e,n){this.sign.length>0&&localStorage.setItem("flowSign",this.sign),n()},beforeDestroy:function(){this.clearReportIntervalTime(),window.removeEventListener("beforeunload",this.onbeforeunloadFlowSign),this.toggleReportMaskHidden("remove")},methods:{initReportData:function(t,e,n,a){var s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.clearReportIntervalTime(),this.reportData={courseId:t,taskId:e},this.reportType=n,this.playKey=a,this.isFinish=!1,this.reportIntervalTime=null,this.reportLearnTime=null,this.reportResult=null,this.learnTime=0,this.reportFinishCondition=null,s&&this.initReportEvent(),this.onbeforeunload()},initReportEvent:function(){this.reprtData(),this.intervalReportData(),this.intervalReportLearnTime()},getCourseData:function(t,e){var n=this,s={courseId:t,taskId:e};return new Promise((function(t,e){a.a.getCourseData({query:s}).then((function(e){n.reportFinishCondition=e.activity.finishCondition,t(e)})).catch((function(t){e(t)}))}))},reprtData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{eventName:"doing",ContinuousReport:!1,watchTime:null};if(null!==this.reportData.courseId&&null!==this.reportData.taskId&&(!this.isFinish||t.ContinuousReport))if(""===this.sign){var e={client:"h5"},n=localStorage.getItem("flowSign");n&&(e.lastSign=n,localStorage.removeItem("flowSign")),this.start(t,e)}else this.reportTaskEvent(t)},start:function(t,e){var n=this;a.a.reportTaskEvent({query:{courseId:this.reportData.courseId,taskId:this.reportData.taskId,eventName:"start"},data:e}).then((function(e){if(n.handleReportResult(e),e.learnControl.allowLearn)n.sign=e.record.flowSign,n.record=e.record,n.reportTaskEvent(t);else{var a=e.learnControl.denyReason;n.reportJudge(a)}}))},reportTaskEvent:function(t){var e=this;if(0!==this.sign.length){var n={client:"h5",sign:this.sign,duration:this.learnTime,status:this.absorbed,lastLearnTime:parseInt(localStorage.getItem(this.playKey))};if(t.reActive&&(n.reActive=t.reActive),this.sourceType&&"video"===this.sourceType){var s=parseInt(this.nowWatchTime-this.lastWatchTime);this.lastWatchTime=this.nowWatchTime;var i={watchData:{duration:s}};n=Object.assign(n,i)}this.learnTime=0,a.a.reportTaskEvent({query:{courseId:this.reportData.courseId,taskId:this.reportData.taskId,eventName:t.eventName},data:n}).then((function(t){if(e.handleReportResult(t),e.record=t.record,e.absorbed=0,e.sign=t.record.flowSign,!t.learnControl.allowLearn){var n=t.learnControl.denyReason;e.reportJudge(n)}})).catch((function(t){e.clearReportIntervalTime()}))}},handleReportResult:function(t){this.reportResult=t,this.learnedTime=t.learnedTime,t.taskResult&&"finish"===t.taskResult.status?(this.isFinish=!0,this.$store.commit(s.B,"finish"),this.$store.commit("course/".concat(s.F),t.completionRate)):this.$store.commit(s.B,"start")},intervalReportLearnTime:function(){var t=this;this.reportLearnTime=setInterval((function(){t.checkoutTime(),t.learnTime++}),1e3)},intervalReportData:function(){var t=this,e=60*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)*1e3;this.reportIntervalTime=setInterval((function(){t.reprtData({eventName:"doing",ContinuousReport:!0})}),e)},checkoutTime:function(){this.reportFinishCondition&&["time","watchTime"].includes(this.reportFinishCondition.type)&&parseInt(this.learnTime/60,10)>=parseInt(this.reportFinishCondition.data,10)&&this.reprtData({eventName:"finish",ContinuousReport:!0})},clearReportIntervalTime:function(){clearInterval(this.reportIntervalTime),clearInterval(this.reportLearnTime),this.reportIntervalTime=null,this.reportLearnTime=null},reportJudge:function(t){"kick_previous"===t?this.kickEachOther("kick_previous"):"reject_current"===t&&(this.clearReportIntervalTime(),this.kickEachOther("reject_current"))},outFocusMask:function(t){this.absorbed=1,this.isShowOutFocusMask=!1,!this.player||"video"!==this.reportType&&"audio"!==this.reportType||this.player.play(),this.toggleReportMaskHidden("remove"),this.reprtData({eventName:"doing",ContinuousReport:!0,reActive:1})},kickEachOther:function(t){if(this.absorbed=1,"testpaper"!==this.reportType&&"live"!==this.reportType&&"homework"!==this.reportType||"kick_previous"!==t){if(this.isShowOutFocusMask=!0,this.outFocusMaskType=t,"video"===this.reportType||"audio"===this.reportType){if(this.player&&this.player.destory&&"reject_current"===t)return void this.player.destory();this.player&&this.player.pause&&this.player.pause()}this.toggleReportMaskHidden("add")}},ineffectiveLearning:function(t){this.isShowOutFocusMask||(this.absorbed=0,this.isShowOutFocusMask=!0,this.outFocusMaskType=t,this.player&&"video"===this.reportType&&this.player.pause(),this.reprtData({eventName:"doing",ContinuousReport:!0}))},toggleReportMaskHidden:function(t){"video"!==this.reportType&&"audio"!==this.reportType&&("add"===t?document.getElementsByTagName("body")[0].classList.add("report-mask-hidden"):"remove"===t&&document.getElementsByTagName("body")[0].classList.remove("report-mask-hidden"))},initVisibilitychange:function(){document.addEventListener("visibilitychange",this.visibilityState)},visibilityState:function(){"video"===this.reportType&&("hidden"===document.visibilityState?this.ineffectiveLearning("ineffective_learning"):"visible"===document.visibilityState&&this.player.pause())},onbeforeunload:function(){window.addEventListener("beforeunload",this.onbeforeunloadFlowSign)},onbeforeunloadFlowSign:function(){this.sign.length>0&&localStorage.setItem("flowSign",this.sign)}}}},e0b8:function(t,e,n){"use strict";var a=n("7726"),s=n("5ca1"),i=n("2aba"),r=n("dcbc"),o=n("67ab"),c=n("4a59"),l=n("f605"),u=n("d3f4"),d=n("79e5"),h=n("5cc5"),p=n("7f20"),m=n("5dbc");t.exports=function(t,e,n,f,g,w){var v=a[t],y=v,_=g?"set":"add",b=y&&y.prototype,C={},x=function(t){var e=b[t];i(b,t,"delete"==t||"has"==t?function(t){return!(w&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return w&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof y&&(w||b.forEach&&!d((function(){(new y).entries().next()})))){var A=new y,T=A[_](w?{}:-0,1)!=A,k=d((function(){A.has(1)})),S=h((function(t){new y(t)})),I=!w&&d((function(){for(var t=new y,e=5;e--;)t[_](e,e);return!t.has(-0)}));S||((y=e((function(e,n){l(e,y,t);var a=m(new v,e,y);return void 0!=n&&c(n,g,a[_],a),a}))).prototype=b,b.constructor=y),(k||I)&&(x("delete"),x("has"),g&&x("get")),(I||T)&&x(_),w&&b.clear&&delete b.clear}else y=f.getConstructor(e,t,g,_),r(y.prototype,n),o.NEED=!0;return p(y,t),C[t]=y,s(s.G+s.W+s.F*(y!=v),C),w||f.setStrong(y,t,g),y}},f5cc:function(t,e,n){"use strict";n("8e6e"),n("456d"),n("28a5"),n("e7e5");var a=n("d399"),s=(n("55dd"),n("96cf"),n("3b8d")),i=(n("ac6a"),n("bd86")),r=(n("c5f6"),n("3ce7")),o=n("2f62"),c=n("32e6"),l=n.n(c),u=n("faa5"),d=(n("ac4d"),n("8a81"),n("5df3"),n("1c4c"),n("7f7f"),n("6b54"),n("e17f"),n("2241")),h=n("2a5b"),p={methods:{isShowFooterShardow:function(){var t=this.showShadow!==this.itemdata.id;if(""===this.mode&&t&&this.canDo)return!0;if(""===this.mode&&t&&!this.canDo&&"material"!==this.parentType)return!0;if(this.isExercise){if("exercise"===this.mode&&t&&"material"!==this.parentType)return!0;if("exercise"===this.mode&&t&&"material"===this.parentType)return!1}if("exercise"===this.mode&&this.canDo){if("1"===this.exerciseMode&&t&&this.disabledData)return!0;if("1"===this.exerciseMode&&t&&"material"!==this.parentType)return!0;if("0"===this.exerciseMode&&t&&this.canDo)return!0}}}},m={methods:{refreshChoice:function(t){var e=this;if(t)this.$nextTick((function(){e.question[0]=t,e.refreshKey=!e.refreshKey}));else{var n=this.exerciseInfo.submittedQuestions;this.$nextTick((function(){e.question=n.filter((function(t){return t.questionId+""===e.itemdata.id})),e.refreshKey=!e.refreshKey}))}}}},f=n("240b"),g=n("def6");function w(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,s=function(){};return{s:s,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){o=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw i}}}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var y=document.documentElement.clientWidth,_={name:"FillType",components:{attachementPreview:h.a},mixins:[p,m,g.a],props:{filldata:{type:Object,default:function(){}},itemdata:{type:Object,default:function(){}},answer:{type:Array,default:function(){return[]}},isCurrent:Boolean,canDo:{type:Boolean,default:!0},subject:{type:String,default:""},number:{type:Number,default:null},showShadow:{type:String,default:""},exerciseInfo:{type:Object,default:function(){}},analysis:{type:String,default:""},exerciseMode:{type:String,default:""},mode:{type:String,default:""},disabledData:{type:Boolean,default:!1},parentTitleAnalysis:{type:String,default:""},parentType:{type:String,default:""},totalCount:{type:Number,default:0},reviewedCount:{type:Number,default:0}},data:function(){return{index:0,currentItem:null,isShowDownIcon:null,isShowUpIcon:!1,width:y,question:[],refreshKey:!0,rigth:"static/images/exercise/rigth.png",wrong:"static/images/exercise/wrong.png",answerData:{},stopAnswer:{},isShowAiExplain:!0,stopAiExplain:!1,anewAiExplain:!1}},computed:{stem:{get:function(){return this.itemdata.parentTitle?this.itemdata.parentTitle.stem:this.itemdata.stem}},placeholder:{get:function(){return this.canDo?this.$t("courseLearning.placeEntAnswer"):this.$t("wrongQuestion.unanswered")}}},mounted:function(){var t;this.isShowDownIcon=(null===(t=document.getElementsByClassName("material-icon")[this.number])||void 0===t?void 0:t.childNodes[0].offsetWidth)>234,this.canDo&&"exercise"===this.mode&&this.refreshChoice()},methods:{getAttachementByType:function(t){return this.itemdata.attachments.filter((function(e){return e.module===t}))||[]},getAttachementMaterialType:function(t){return this.itemdata.parentTitle.attachments.filter((function(e){return e.module===t}))||[]},isunanswered:function(){return this.answer?this.answer.every((function(t){})):void 0!==this.itemdata.testResult.answer?this.itemdata.testResult.answer.every((function(t){})):void 0},changeUpIcon:function(){this.isShowUpIcon=!0,this.isShowDownIcon=!1},changeDownIcon:function(){this.isShowUpIcon=!1,this.isShowDownIcon=!0},submitTopic:function(){var t=this;this.answer.some((function(t){return""===t}))&&"1"===this.exerciseMode?d.a.confirm({message:this.$t("courseLearning.questionNotAnswer"),confirmButtonText:this.$t("courseLearning.continueAnswer"),cancelButtonText:this.$t("btn.confirm")}).then((function(){})).catch((function(){t.$emit("changeTouch"),t.$emit("submitSingleAnswer",t.answer,t.itemdata)})):(this.$emit("changeTouch"),this.radioDisabled=!0,this.$emit("submitSingleAnswer",this.answer,this.itemdata))},goResults:function(){this.$emit("goResults")},getAiAnalysis:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){var n,a,s,i,r,o,c,l,u,d,h,p,m,g,v,y,_,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.itemdata),n=t.itemdata.id,a={role:"student",questionId:n,answerRecordId:t.exerciseInfo.id},s=!1,i=[],t.answerData[n]="",t.stopAnswer[n]=!1,r=setInterval((function(){0!==i.length&&(t.stopAnswer[n]&&clearInterval(r),t.answerData[n]+=i.shift(),0===i.length&&s&&(clearInterval(r),t.stopAiExplain=!1,t.anewAiExplain=!0),t.$refs.aiAnalysis.innerHTML=t.answerData[n])}),50),e.next=10,fetch("/api/ai/question_analysis/generate",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Accept:"application/vnd.edusoho.v2+json","X-Auth-Token":f.a.state.token},body:JSON.stringify(a)});case 10:o=e.sent,c=o.body.getReader(),l=new TextDecoder,u="";case 14:return e.next=17,c.read();case 17:d=e.sent,h=d.done,p=d.value,m=(u+l.decode(p)).split("\n\n"),g=1,v=w(m);try{for(v.s();!(y=v.n()).done;)_=y.value,g==m.length?u=_:("message"===(b=JSON.parse(_.slice(5))).event&&i.push(b.answer),g++)}catch(t){v.e(t)}finally{v.f()}if(!h){e.next=27;break}return s=!0,e.abrupt("break",29);case 27:e.next=14;break;case 29:case"end":return e.stop()}}),e)})))()},stopAiAnalysis:function(){var t=this.itemdata.id;this.stopAnswer[t]=!0},aiGeneration:function(){this.isShowAiExplain=!1,this.stopAiExplain=!0,this.anewAiExplain=!1,this.getAiAnalysis()},stopAiGeneration:function(){this.stopAiExplain=!1,this.isShowAiExplain=!1,this.anewAiExplain=!0,this.stopAiAnalysis()}}},b=(n("05b5"),n("a6c2")),C=Object(b.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.itemdata.parentTitle?n("div",{staticClass:"subject-material"},[n("div",{class:["material-stem-nowrap",t.isShowDownIcon?"material-stem":""]},[t.itemdata.parentTitle?n("span",{class:["material-tags"]},[t._v("\n        "+t._s(t.subject)+"\n      ")]):t._e(),n("span",{staticClass:"material-text material-icon",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),n("i",{class:["iconfont","icon-arrow-up",{"show-up-icon":t.isShowDownIcon}],on:{click:t.changeUpIcon}}),n("i",{class:["iconfont","icon-arrow-down",{"show-down-icon":t.isShowUpIcon}],on:{click:t.changeDownIcon}}),t._l(t.getAttachementByType("material"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),n("div",{staticClass:"fill"},[t.itemdata.parentTitle?t._e():n("span",{staticClass:"tags"},[t._v("\n      "+t._s(t.subject)+"\n    ")]),t.itemdata.parentTitle?t._e():n("div",{staticClass:"subject-stem"},[n("div",{staticClass:"serial-number"},[t._v(t._s(t.itemdata.seq)+"、")]),n("div",{staticClass:"rich-text",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),t.itemdata.parentTitle?n("div",{class:["material-title",{"material-title-weight":t.itemdata.parentTitle}]},[n("span",{staticClass:"serial-number"},[n("span",{staticClass:"material-type"},[t._v("["+t._s(t.$t("courseLearning.fill"))+"] ")]),t._v(" "+t._s(t.itemdata.materialIndex)+"、")]),n("div",{staticClass:"rich-text",domProps:{innerHTML:t._s(t.itemdata.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]):t._e(),t._l(t.getAttachementByType("stem"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})})),t.disabledData?n("div",{staticClass:"answer-paper"},t._l(t.itemdata.fillnum,(function(e,a){return n("div",{key:a},[n("van-field",{staticClass:"fill-input",class:{"field-bottom":a!=t.itemdata.fillnum-1},attrs:{placeholder:t.canDo?"("+(a+1)+")"+t.$t("courseLearning.pleaseEnterYourAnswer"):t.$t("courseLearning.unanswered"),disabled:!t.disabledData,"label-width":"0px",type:"textarea",rows:"1",autosize:""},model:{value:t.answer[a],callback:function(e){t.$set(t.answer,a,e)},expression:"answer[index]"}})],1)})),0):t._e(),t.disabledData?t._e():n("div",{staticClass:"answer-paper"},[n("div",{staticClass:"your-answer"},[t._v(t._s(t.$t("courseLearning.yourAreAnswer"))+"：")]),n("div",[t.question.length>0&&"right"===t.question[0].status||"right"===t.itemdata.testResult.status?n("img",{staticClass:"fill-status",attrs:{src:t.rigth,alt:""}}):t._e(),t.question.length>0&&"wrong"===t.question[0].status||"wrong"===t.itemdata.testResult.status||"none"===t.itemdata.testResult.status||"noAnswer"===t.itemdata.testResult.status?n("img",{staticClass:"fill-status",attrs:{src:t.wrong,alt:""}}):t._e(),t.isunanswered()?n("span",{staticClass:"your-answer is-wrong-answer"},[t._v(" "+t._s(t.$t("courseLearning.unanswered")))]):t._e(),t._l(t.answer,(function(e,a){return n("span",{key:a,class:[t.question.length>0&&"right"===t.question[0].status?"is-right-answer":"is-wrong-answer"]},[t._v(" "+t._s(t.answer.length-1===a?""===e?t.$t("courseLearning.unanswered"):e:(""===e?t.$t("courseLearning.unanswered"):e)+";"))])}))],2),n("div",{staticClass:"your-answer mt-16"},[t._v("\n        "+t._s(t.$t("courseLearning.correctAnswer"))+"：\n      ")]),n("div",{staticClass:"mb-16"},t._l(t.itemdata.answer,(function(e,a){return n("span",{key:a,staticClass:"is-right-answer"},[t._v(" "+t._s(t.itemdata.answer.length-1===a?e:e+";"))])})),0),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n        "+t._s(t.$t("courseLearning.score"))+"："),n("div",[t._v(t._s(t.itemdata.testResult?t.itemdata.testResult.score:0))])]):t._e(),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n        "+t._s(t.$t("courseLearning.comment"))+"："),n("div",[t._v(t._s(t.itemdata.testResult?null===t.itemdata.testResult.teacherSay?"--":t.itemdata.testResult.teacherSay:""))])]):t._e(),n("div",{staticClass:"analysis-color"},[t._v("\n        "+t._s(t.$t("courseLearning.analyze"))+"：\n        "),t.analysis?n("span",{domProps:{innerHTML:t._s(t.analysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("div",{ref:"aiAnalysis"},[t._v(t._s(t.$t("courseLearning.noParsing")))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.itemdata.aiAnalysisEnable,expression:"itemdata.aiAnalysisEnable"}],staticClass:"ai-analysis"},[n("p",{staticClass:"ai-tittle"},[t._v(t._s(t.$t("courseLearning.aiAssistant")))]),n("div",{staticClass:"ai-content"},[n("div",{staticClass:"ai-content-left"},[n("button",{directives:[{name:"show",rawName:"v-show",value:t.isShowAiExplain,expression:"isShowAiExplain"}],staticClass:"ai-btn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-ai.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.analysis")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.stopAiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-stop.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.stopGeneration")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.anewAiExplain,expression:"anewAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-anew.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.reGenerate")))])]),n("p",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-left-tittle"},[t._v(t._s(t.$t("courseLearning.beGenerating")))])]),t._m(0)])]),t._l(t.getAttachementByType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2)],2),t.isShowFooterShardow()?n("div",{staticClass:"footer-shadow"}):t._e(),t.parentType&&"material"===t.parentType&&!t.disabledData?n("div",{staticClass:"subject-footer"},[t._v("\n    "+t._s(t.$t("courseLearning.analyze"))+"：\n    "),""!==t.parentTitleAnalysis?n("span",{domProps:{innerHTML:t._s(t.parentTitleAnalysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("div",[t._v(t._s(t.$t("courseLearning.noParsing")))]),t._l(t.getAttachementMaterialType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),t.canDo&&"1"===t.exerciseMode&&t.disabledData?n("div",{staticClass:"submit-footer",style:{width:t.width+"px"}},[n("van-button",{staticClass:"submit-footer-btn",style:{width:t.width-20+"px"},attrs:{type:"primary"},on:{click:t.submitTopic}},[t._v(t._s(t.$t("courseLearning.submitATopic")))])],1):t._e(),t.totalCount===t.reviewedCount?n("div",{staticClass:"submit-footer"},[n("van-button",{staticClass:"submit-footer-btn",style:{width:t.width-20+"px"},attrs:{type:"primary"},on:{click:function(e){return t.goResults()}}},[t._v(t._s(t.$t("courseLearning.viewResult2")))])],1):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("img",{staticClass:"ai-right-img",attrs:{src:"static/images/explain-ai-img.png"}})])}],!1,null,"a86f41de",null).exports;function x(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,s=function(){};return{s:s,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){o=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw i}}}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var T=document.documentElement.clientWidth,k={name:"EssayType",mixins:[p,m,g.a],components:{attachementPreview:h.a},watch:{answerText:{handler:function(t){this.answer[0]=t+this.fileStr}},imgs:{handler:function(t){var e=this;this.fileStr="",t.forEach((function(t){e.fileStr+='<img src="'.concat(t,'"></img>')})),this.answer[0]=this.answerText+this.fileStr},deep:!0}},props:{itemdata:{type:Object,default:function(){}},answer:{type:Array,default:function(){return[]}},isCurrent:Boolean,canDo:{type:Boolean,default:!0},subject:{type:String,default:""},number:{type:Number,default:null},showShadow:{type:String,default:""},exerciseMode:{type:String,default:""},exerciseInfo:{type:Object,default:function(){}},mode:{type:String,default:""},disabledData:{type:Boolean,default:!1},analysis:{type:String,default:""},parentTitleAnalysis:{type:String,default:""},parentType:{type:String,default:""},totalCount:{type:Number,default:0},reviewedCount:{type:Number,default:0}},data:function(){return{fileList:[],fileStr:"",imgs:[],currentItem:null,isShowDownIcon:null,isShowUpIcon:!1,question:[],refreshKey:!0,currentAnswer:[],width:T,rigth:"static/images/exercise/rigth.png",wrong:"static/images/exercise/wrong.png",answerText:"",answerData:{},stopAnswer:{},isShowAiExplain:!0,stopAiExplain:!1,anewAiExplain:!1}},computed:{stem:{get:function(){return this.itemdata.parentTitle?this.itemdata.parentTitle.stem:this.itemdata.stem}},placeholder:{get:function(){return this.canDo?this.$t("courseLearning.yourAreAnswer")+"...":this.$t("wrongQuestion.unanswered")}}},mounted:function(){var t;this.isShowDownIcon=(null===(t=document.getElementsByClassName("material-icon")[this.number])||void 0===t?void 0:t.childNodes[0].offsetWidth)>234},methods:{change:function(){},getAttachementByType:function(t){return this.itemdata.attachments.filter((function(e){return e.module===t}))||[]},getAttachementMaterialType:function(t){return this.itemdata.parentTitle.attachments.filter((function(e){return e.module===t}))||[]},afterRead:function(t){var e=this,n=new FormData;n.append("file",t.content),n.append("group","course"),r.a.updateFile({data:n}).then((function(t){e.imgs.push(t.uri)})).catch((function(t){a.a.fail(t.message)}))},deleteImgItem:function(t,e){this.imgs.splice(e.index,1)},changeUpIcon:function(){this.isShowUpIcon=!0,this.isShowDownIcon=!1},changeDownIcon:function(){this.isShowUpIcon=!1,this.isShowDownIcon=!0},submitTopic:function(){var t=this;""===this.answer[0]&&"1"===this.exerciseMode?d.a.confirm({message:this.$t("courseLearning.questionNotAnswer"),confirmButtonText:this.$t("courseLearning.continueAnswer"),cancelButtonText:this.$t("btn.confirm")}).then((function(){})).catch((function(){t.$emit("changeTouch"),t.$emit("submitSingleAnswer",t.answer,t.itemdata)})):(this.$emit("changeTouch"),this.$emit("submitSingleAnswer",this.answer,this.itemdata))},goResults:function(){this.$emit("goResults")},getAiAnalysis:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){var n,a,s,i,r,o,c,l,u,d,h,p,m,g,w,v,y,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.itemdata.id,a={role:"student",questionId:n,answerRecordId:t.exerciseInfo.id},s=!1,i=[],t.answerData[n]="",t.stopAnswer[n]=!1,r=setInterval((function(){0!==i.length&&(t.stopAnswer[n]&&clearInterval(r),t.answerData[n]+=i.shift(),0===i.length&&s&&(clearInterval(r),t.stopAiExplain=!1,t.anewAiExplain=!0),t.$refs.aiAnalysis.innerHTML=t.answerData[n])}),50),e.next=9,fetch("/api/ai/question_analysis/generate",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Accept:"application/vnd.edusoho.v2+json","X-Auth-Token":f.a.state.token},body:JSON.stringify(a)});case 9:o=e.sent,c=o.body.getReader(),l=new TextDecoder,u="";case 13:return e.next=16,c.read();case 16:d=e.sent,h=d.done,p=d.value,m=(u+l.decode(p)).split("\n\n"),g=1,w=x(m);try{for(w.s();!(v=w.n()).done;)y=v.value,g===m.length?u=y:("message"===(_=JSON.parse(y.slice(5))).event&&i.push(_.answer),g++)}catch(t){w.e(t)}finally{w.f()}if(!h){e.next=26;break}return s=!0,e.abrupt("break",28);case 26:e.next=13;break;case 28:case"end":return e.stop()}}),e)})))()},stopAiAnalysis:function(){var t=this.itemdata.id;this.stopAnswer[t]=!0},aiGeneration:function(){this.isShowAiExplain=!1,this.stopAiExplain=!0,this.anewAiExplain=!1,this.getAiAnalysis()},stopAiGeneration:function(){this.stopAiExplain=!1,this.isShowAiExplain=!1,this.anewAiExplain=!0,this.stopAiAnalysis()},getTeacherSay:function(){var t=this.itemdata.testResult;return t?null===t.teacherSay?"--":t.teacherSay:""}}},S=(n("fbf1"),Object(b.a)(k,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.itemdata.parentTitle?n("div",{staticClass:"subject-material"},[n("div",{class:["material-stem-nowrap",t.isShowDownIcon?"material-stem":""]},[t.itemdata.parentTitle?n("span",{class:["material-tags"]},[t._v("\n        "+t._s(t.subject)+"\n      ")]):t._e(),n("span",{staticClass:"material-text material-icon",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),n("i",{class:["iconfont","icon-arrow-up",{"show-up-icon":t.isShowDownIcon}],on:{click:t.changeUpIcon}}),n("i",{class:["iconfont","icon-arrow-down",{"show-down-icon":t.isShowUpIcon}],on:{click:t.changeDownIcon}}),t._l(t.getAttachementMaterialType("material"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),n("div",{staticClass:"essay"},[t.itemdata.parentTitle?t._e():n("span",{staticClass:"tags"},[t._v("\n      "+t._s(t.subject)+"\n    ")]),t.itemdata.parentTitle?t._e():n("div",{staticClass:"subject-stem"},[n("div",{staticClass:"serial-number"},[t._v(t._s(t.itemdata.seq)+"、")]),n("div",{staticClass:"rich-text",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),t.itemdata.parentTitle?n("div",{class:["material-title",{"material-title-weight":t.itemdata.parentTitle}]},[n("span",{staticClass:"serial-number"},[n("span",{staticClass:"material-type"},[t._v("["+t._s(t.$t("courseLearning.essay"))+"] ")]),t._v(" "+t._s(t.itemdata.materialIndex)+"、")]),n("div",{staticClass:"rich-text",domProps:{innerHTML:t._s(t.itemdata.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]):t._e(),t._l(t.getAttachementByType("stem"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})})),t.disabledData?n("div",{staticClass:"answer-paper"},[n("van-field",{staticClass:"essay-input",attrs:{placeholder:t.placeholder,autosize:{maxHeight:132,minHeight:132},disabled:!t.disabledData,"label-width":"0px",type:"textarea"},on:{input:function(e){return t.change()}},model:{value:t.answerText,callback:function(e){t.answerText=e},expression:"answerText"}}),t.canDo?n("div",{staticClass:"discussion-create__upload"},[n("van-uploader",{attrs:{"after-read":t.afterRead,"max-count":5},on:{delete:t.deleteImgItem},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1):t._e()],1):t._e(),t.disabledData?t._e():n("div",{staticClass:"answer-paper"},[t.disabledData?t._e():n("div",{staticClass:"answer-paper"},[n("div",{staticClass:"your-answer"},[t._v(t._s(t.$t("courseLearning.yourAreAnswer"))+"：")]),n("div",["exam"!==t.mode||t.canDo?n("div",[""===t.answer[0]||t.itemdata.testResult.answer&&0===t.itemdata.testResult.answer.length?n("span",{staticClass:"your-answer"},[t._v(" "+t._s(t.$t("courseLearning.unanswered")))]):t._e(),n("span",{staticClass:"essay-answer",staticStyle:{color:"#37393D"},domProps:{innerHTML:t._s(t.answer[0])},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]):n("div",[""==t.exerciseMode&&t.question.length>0&&"right"===t.question[0].status||"right"===t.itemdata.testResult.status&&"none"!==t.itemdata.testResult.status?n("img",{staticClass:"fill-status",attrs:{src:t.rigth,alt:""}}):t._e(),t.question.length>0&&"wrong"===t.question[0].status||"wrong"===t.itemdata.testResult.status||"noAnswer"===t.itemdata.testResult.status||"partRight"===t.itemdata.testResult.status?n("img",{staticClass:"fill-status",attrs:{src:t.wrong,alt:""}}):t._e(),""==t.exerciseMode&&t.question.length>0&&"right"===t.question[0].status||"right"===t.itemdata.testResult.status&&"none"!==t.itemdata.testResult.status?n("span",{staticClass:"is-right-answer",domProps:{innerHTML:t._s(t.answer[0])},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):t.question.length>0&&"wrong"===t.question[0].status||"wrong"===t.itemdata.testResult.status||"noAnswer"===t.itemdata.testResult.status||"partRight"===t.itemdata.testResult.status?n("span",{staticClass:"is-wrong-answer",domProps:{innerHTML:t._s(t.answer[0])},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):t._e(),"none"===t.itemdata.testResult.status?n("span",{staticClass:"your-answer",staticStyle:{color:"#37393D"},domProps:{innerHTML:t._s(t.answer[0])},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):t._e(),""===t.answer[0]||t.itemdata.testResult.answer&&0===t.itemdata.testResult.answer.length?n("span",{staticClass:"your-answer is-wrong-answer"},[t._v(" "+t._s(t.$t("courseLearning.unanswered")))]):t._e()])]),n("div",{staticClass:"your-answer mt-16"},[t._v("\n          "+t._s(t.$t("courseLearning.correctAnswer"))+"：\n        ")]),n("div",{staticClass:"mb-16"},[n("span",{staticClass:"is-right-answer",domProps:{innerHTML:t._s(t.itemdata.answer[0])},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n          "+t._s(t.$t("courseLearning.score"))+"："),n("div",[t._v(t._s(t.itemdata.testResult?t.itemdata.testResult.score:0))])]):t._e(),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n          "+t._s(t.$t("courseLearning.comment"))+"："),n("div",{domProps:{innerHTML:t._s(t.getTeacherSay())}})]):t._e(),n("div",{staticClass:"analysis-color"},[t._v("\n          "+t._s(t.$t("courseLearning.analyze"))+"：\n          "),t.analysis?n("span",{domProps:{innerHTML:t._s(t.analysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("div",{ref:"aiAnalysis"},[t._v(t._s(t.$t("courseLearning.noParsing")))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.itemdata.aiAnalysisEnable,expression:"itemdata.aiAnalysisEnable"}],staticClass:"ai-analysis"},[n("p",{staticClass:"ai-tittle"},[t._v(t._s(t.$t("courseLearning.aiAssistant")))]),n("div",{staticClass:"ai-content"},[n("div",{staticClass:"ai-content-left"},[n("button",{directives:[{name:"show",rawName:"v-show",value:t.isShowAiExplain,expression:"isShowAiExplain"}],staticClass:"ai-btn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-ai.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.analysis")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.stopAiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-stop.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.stopGeneration")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.anewAiExplain,expression:"anewAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-anew.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.reGenerate")))])]),n("p",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-left-tittle"},[t._v(t._s(t.$t("courseLearning.beGenerating")))])]),t._m(0)])]),t._l(t.getAttachementByType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2)])],2),t.isShowFooterShardow()?n("div",{staticClass:"footer-shadow"}):t._e(),t.parentType&&"material"===t.parentType&&!t.disabledData?n("div",{staticClass:"subject-footer"},[t._v("\n    "+t._s(t.$t("courseLearning.analyze"))+"：\n    "),""!==t.parentTitleAnalysis?n("span",{domProps:{innerHTML:t._s(t.parentTitleAnalysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("div",[t._v(t._s(t.$t("courseLearning.noParsing")))]),t._l(t.getAttachementMaterialType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),t.canDo&&"1"===t.exerciseMode&&t.disabledData?n("div",{staticClass:"submit-footer",style:{width:t.width+"px"}},[n("van-button",{staticClass:"submit-footer-btn",style:{width:t.width-20+"px"},attrs:{type:"primary"},on:{click:t.submitTopic}},[t._v(t._s(t.$t("courseLearning.submitATopic")))])],1):t._e(),t.totalCount===t.reviewedCount?n("div",{staticClass:"submit-footer"},[n("van-button",{staticClass:"submit-footer-btn",style:{width:t.width-20+"px"},attrs:{type:"primary"},on:{click:function(e){return t.goResults()}}},[t._v(t._s(t.$t("courseLearning.viewResult2")))])],1):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("img",{staticClass:"ai-right-img",attrs:{src:"static/images/explain-ai-img.png"}})])}],!1,null,"4f0c7178",null).exports),I={name:"HeadTop",props:{all:{type:Number,default:0},current:{type:Number,default:0},subject:{type:String,default:""},score:{type:String,default:"0"},showScore:{type:Boolean,default:!0},exerciseMode:{type:String,default:""},totalCount:{type:Number,default:0},reviewedCount:{type:Number,default:0},canDo:{type:Boolean,default:!0}},methods:{showCard:function(){this.$parent.$parent.$parent.$parent.cardShow=!0}}},R=Object(b.a)(I,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["0"===t.exerciseMode?"head-top":"one-questions-head"]},["1"===t.exerciseMode&&t.canDo?n("div",{staticClass:"w-full"},[n("div",{staticClass:"flex justify-between items-end mb-8"},[n("span",{staticClass:"text-14 answer-progress"},[t._v(t._s(t.$t("courseLearning.answerProgress"))+" "),n("span",{staticClass:"current-num"},[t._v(t._s(t.reviewedCount)+" "),n("span",{staticClass:"total-number"},[t._v(" /"+t._s(t.totalCount))])])]),n("span",{staticClass:"text-12 answer-card",on:{click:t.showCard}},[t._v(t._s(t.$t("courseLearning.answerSheet")))])]),n("van-progress",{attrs:{percentage:t.reviewedCount/t.totalCount*100,"stroke-width":"8","track-color":"#E9E9EB","show-pivot":!1}})],1):n("div",{staticClass:"flex justify-between w-full"},[n("div",{staticClass:"head-left"},[t._v("\n      "+t._s(t.subject)+"\n      "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.showScore,expression:"showScore"}],staticClass:"left-color"},[t._v("["+t._s(t.score)+"分]")])]),n("div",{staticClass:"head-right"},[n("span",{staticClass:"right-color"},[t._v(t._s(t.current))]),t._v("/"+t._s(t.all)+"\n    ")])])])}),[],!1,null,null,null).exports,D=(n("a481"),n("6762"),n("2fdb"),{methods:{checkAnswer:function(t,e){var n=e.answer;if(e.testResult&&e.testResult.answer){var a=e.testResult.answer||[];if(n.includes(t))return"subject-option__order_right";if(n.includes(t)&&!a.includes(t)||!n.includes(t)&&a.includes(t))return"van-checked__wrong"}return""}}});function L(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return $(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,s=function(){};return{s:s,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){o=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw i}}}}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var E=document.documentElement.clientWidth,j={name:"ChoiceType",filters:{filterOrder:function(t){return["A.","B.","C.","D.","E.","F.","G.","H.","I.","J.","K.","L.","M.","N.","O.","P.","Q.","R.","S.","T.","U.","V.","W.","X.","Y.","Z."][t]}},mixins:[D,p,m,g.a],components:{attachementPreview:h.a},props:{itemdata:{type:Object,default:function(){}},isCurrent:Boolean,answer:{type:Array,default:function(){return[]}},canDo:{type:Boolean,default:!0},subject:{type:String,default:""},number:{type:Number,default:null},showShadow:{type:String,default:""},exerciseMode:{type:String,default:""},exerciseInfo:{type:Object,default:function(){}},analysis:{type:String,default:""},mode:{type:String,default:""},disabledData:{type:Boolean,default:!1},parentTitleAnalysis:{type:String,default:""},parentType:{type:String,default:""},totalCount:{type:Number,default:0},reviewedCount:{type:Number,default:0}},data:function(){return{result:this.answer,currentItem:null,isShowDownIcon:null,isShowUpIcon:!1,width:E,radioDisabled:!1,refreshKey:!0,question:[],answerData:{},stopAnswer:{},isShowAiExplain:!0,stopAiExplain:!1,anewAiExplain:!1}},computed:{stem:{get:function(){return this.itemdata.parentTitle?this.itemdata.parentTitle.stem:this.itemdata.stem}}},mounted:function(){var t;this.isShowDownIcon=(null===(t=document.getElementsByClassName("material-icon")[this.number])||void 0===t?void 0:t.childNodes[0].offsetWidth)>234,this.canDo&&"exercise"===this.mode&&this.refreshChoice()},methods:{filterOrders:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"do",n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a=t.map((function(t){return n[t]}));if("standard"==e)return a.length>0?a.join(""):""},filterOrder:function(t){return this.$options.filters.filterOrder(t)},isWrong:function(t){var e,n,a,s,i=!1;return(null===(e=this.question[0])||void 0===e||null===(n=e.response)||void 0===n?void 0:n.includes(this.filterOrder(t).replace(".","")))&&this.question.length>0&&!this.question[0].answer.includes(this.filterOrder(t).replace(".",""))&&(i=!0),i&&(null===(a=this.question[0])||void 0===a||null===(s=a.response)||void 0===s?void 0:s.includes(this.filterOrder(t).replace(".","")))},choose:function(t){this.currentItem=t,this.$emit("choiceChoose",this.result,this.itemdata)},getAttachementByType:function(t){return this.itemdata.attachments.filter((function(e){return e.module===t}))||[]},getAttachementMaterialType:function(t){return this.itemdata.parentTitle.attachments.filter((function(e){return e.module===t}))||[]},changeUpIcon:function(){this.isShowUpIcon=!0,this.isShowDownIcon=!1},changeDownIcon:function(){this.isShowUpIcon=!1,this.isShowDownIcon=!0},submitTopic:function(){var t=this;0===this.result.length&&"1"===this.exerciseMode?d.a.confirm({message:this.$t("courseLearning.questionNotAnswer"),confirmButtonText:this.$t("courseLearning.continueAnswer"),cancelButtonText:this.$t("btn.confirm")}).then((function(){})).catch((function(){t.$emit("changeTouch"),t.$emit("submitSingleAnswer",t.result,t.itemdata)})):(this.$emit("changeTouch"),this.radioDisabled=!0,this.$emit("submitSingleAnswer",this.result,this.itemdata))},goResults:function(){this.$emit("goResults")},getAiAnalysis:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){var n,a,s,i,r,o,c,l,u,d,h,p,m,g,w,v,y,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.itemdata.id,a={role:"student",questionId:n,answerRecordId:t.exerciseInfo.id},s=!1,i=[],t.answerData[n]="",t.stopAnswer[n]=!1,r=setInterval((function(){0!==i.length&&(t.stopAnswer[n]&&clearInterval(r),t.answerData[n]+=i.shift(),0===i.length&&s&&(clearInterval(r),t.stopAiExplain=!1,t.anewAiExplain=!0),t.$refs.aiAnalysis.innerHTML=t.answerData[n])}),50),e.next=9,fetch("/api/ai/question_analysis/generate",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Accept:"application/vnd.edusoho.v2+json","X-Auth-Token":f.a.state.token},body:JSON.stringify(a)});case 9:o=e.sent,c=o.body.getReader(),l=new TextDecoder,u="";case 13:return e.next=16,c.read();case 16:d=e.sent,h=d.done,p=d.value,m=(u+l.decode(p)).split("\n\n"),g=1,w=L(m);try{for(w.s();!(v=w.n()).done;)y=v.value,g==m.length?u=y:("message"===(_=JSON.parse(y.slice(5))).event&&i.push(_.answer),g++)}catch(t){w.e(t)}finally{w.f()}if(!h){e.next=26;break}return s=!0,e.abrupt("break",28);case 26:e.next=13;break;case 28:case"end":return e.stop()}}),e)})))()},stopAiAnalysis:function(){var t=this.itemdata.id;this.stopAnswer[t]=!0},aiGeneration:function(){this.isShowAiExplain=!1,this.stopAiExplain=!0,this.anewAiExplain=!1,this.getAiAnalysis()},stopAiGeneration:function(){this.stopAiExplain=!1,this.isShowAiExplain=!1,this.anewAiExplain=!0,this.stopAiAnalysis()}}},M=(n("9b05"),Object(b.a)(j,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.itemdata.parentTitle?n("div",{staticClass:"subject-material"},[n("div",{class:["material-stem-nowrap",t.isShowDownIcon?"material-stem":""]},[t.itemdata.parentTitle?n("span",{class:["material-tags"]},[t._v("\n        "+t._s(t.subject)+"\n      ")]):t._e(),n("span",{staticClass:"material-text material-icon",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),n("i",{class:["iconfont","icon-arrow-up",{"show-up-icon":t.isShowDownIcon}],on:{click:t.changeUpIcon}}),n("i",{class:["iconfont","icon-arrow-down",{"show-down-icon":t.isShowUpIcon}],on:{click:t.changeDownIcon}}),t._l(t.getAttachementMaterialType("material"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),n("div",{staticClass:"subject"},[t.itemdata.parentTitle?t._e():n("span",{staticClass:"tags"},[t._v("\n      "+t._s(t.subject)+"\n    ")]),t.itemdata.parentTitle?t._e():n("div",{staticClass:"subject-stem"},[n("span",{staticClass:"serial-number"},[t._v(t._s(t.itemdata.seq)+"、")]),n("div",{staticClass:"subject-stem__content rich-text",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),t.itemdata.parentTitle?n("div",{class:["material-title",{"material-title-weight":t.itemdata.parentTitle}]},[n("span",{staticClass:"serial-number"},[n("span",{staticClass:"material-type"},[t._v("["+t._s("uncertain_choice"===t.itemdata.type?t.$t("courseLearning.uncertainChoice"):t.$t("courseLearning.choice"))+"] ")]),t._v(" "+t._s(t.itemdata.materialIndex)+"、")]),n("div",{staticClass:"rich-text",domProps:{innerHTML:t._s(t.itemdata.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]):t._e(),t._l(t.getAttachementByType("stem"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})})),n("van-checkbox-group",{class:["answer-paper",{convention:"exercise"!==t.mode}],attrs:{refreshKey:t.refreshKey},on:{change:t.choose},model:{value:t.result,callback:function(e){t.result=e},expression:"result"}},t._l(t.itemdata.metas.choices,(function(e,a){return n("van-checkbox",{key:a,class:["subject-option",t.canDo?"":t.checkAnswer(a,t.itemdata),{active:t.currentItem?t.currentItem.includes(a):""},{"van-checked__right":t.itemdata.answer?t.itemdata.answer.includes(a):""},{isRight:t.question.length>0&&t.question[0].answer.includes(t.filterOrder(a).replace(".",""))},{isWrong:t.isWrong(a)}],attrs:{name:a,disabled:!t.disabledData}},[n("i",{staticClass:"iconfont icon-cuowu2"}),n("i",{staticClass:"iconfont icon-zhengque1"}),n("i",{staticClass:"iconfont icon-a-Frame34723"}),n("div",{class:["subject-option__content",t.canDo?"":"not-can-do"],domProps:{innerHTML:t._s(e)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}),n("span",{staticClass:"subject-option__order",attrs:{slot:"icon"},slot:"icon"},[t._v(t._s(t._f("filterOrder")(a)))])])})),1),t.disabledData?t._e():n("div",{staticClass:"one-questions-analysis"},[n("div",{staticClass:"flex mb-8"},[n("span",{staticClass:"flex-none font-14 leading-28"},[t._v(t._s(t.$t("courseLearning.referenceAnswer"))+"：")]),t.question.length>0&&t.canDo?n("span",{staticClass:"font-20 break-all",staticStyle:{color:"#00B42A"}},t._l(t.question[0].answer,(function(e,a){return n("span",{key:a},[t._v(t._s(e))])})),0):t._e(),t.canDo?t._e():n("span",{staticClass:"font-20 break-all",staticStyle:{color:"#00B42A"}},[t._v(t._s(t.filterOrders(t.itemdata.answer,"standard")))])]),t.itemdata.testResult.answer&&0!==t.itemdata.testResult.answer.length||0!==t.question.length?n("div",{staticClass:"flex mb-8"},[n("span",{staticClass:"flex-none font-14 leading-28"},[t._v(t._s(t.$t("courseLearning.selectedAnswer"))+"：")]),t.question.length>0?n("span",{staticClass:"font-20 break-all"},t._l(t.question[0].response,(function(e,a){return n("span",{key:a},[t._v(t._s(e))])})),0):t._e(),t.canDo?t._e():n("span",{staticClass:"font-20 break-all"},[n("span",[t._v(t._s(t.filterOrders(t.itemdata.testResult.answer,"standard")))])])]):t._e(),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n        "+t._s(t.$t("courseLearning.score"))+"："+t._s(t.itemdata.testResult?t.itemdata.testResult.score:0)+"\n      ")]):t._e(),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n        "+t._s(t.$t("courseLearning.comment"))+"："+t._s(t.itemdata.testResult?null===t.itemdata.testResult.teacherSay?"--":t.itemdata.testResult.teacherSay:"")+"\n      ")]):t._e(),n("div",{staticClass:"analysis-color"},[n("span",{staticClass:"float-left"},[t._v(t._s(t.$t("courseLearning.analyze"))+"：")]),t.analysis?n("span",{domProps:{innerHTML:t._s(t.analysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("span",{ref:"aiAnalysis"},[t._v(t._s(t.$t("courseLearning.noParsing")))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.itemdata.aiAnalysisEnable,expression:"itemdata.aiAnalysisEnable"}],staticClass:"ai-analysis"},[n("p",{staticClass:"ai-tittle"},[t._v(t._s(t.$t("courseLearning.aiAssistant")))]),n("div",{staticClass:"ai-content"},[n("div",{staticClass:"ai-content-left"},[n("button",{directives:[{name:"show",rawName:"v-show",value:t.isShowAiExplain,expression:"isShowAiExplain"}],staticClass:"ai-btn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-ai.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.analysis")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.stopAiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-stop.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.stopGeneration")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.anewAiExplain,expression:"anewAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-anew.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.reGenerate")))])]),n("p",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-left-tittle"},[t._v(t._s(t.$t("courseLearning.beGenerating")))])]),t._m(0)])]),t._l(t.getAttachementByType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2)],2),t.isShowFooterShardow()?n("div",{staticClass:"footer-shadow"}):t._e(),t.parentType&&"material"===t.parentType&&!t.disabledData?n("div",{staticClass:"subject-footer"},[n("span",{staticClass:"float-left"},[t._v(t._s(t.$t("courseLearning.analyze"))+"：")]),""!==t.parentTitleAnalysis?n("span",{domProps:{innerHTML:t._s(t.parentTitleAnalysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("span",[t._v(t._s(t.$t("courseLearning.noParsing")))]),t._l(t.getAttachementMaterialType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),t.canDo&&"1"===t.exerciseMode&&t.disabledData?n("div",{staticClass:"submit-footer",style:{width:t.width+"px"}},[n("van-button",{staticClass:"submit-footer-btn",style:{width:t.width-20+"px"},attrs:{type:"primary"},on:{click:t.submitTopic}},[t._v(t._s(t.$t("courseLearning.submitATopic")))])],1):t._e(),t.totalCount===t.reviewedCount?n("div",{staticClass:"submit-footer"},[n("van-button",{staticClass:"submit-footer-btn",style:{width:t.width-20+"px"},attrs:{type:"primary"},on:{click:function(e){return t.goResults()}}},[t._v(t._s(t.$t("courseLearning.viewResult2")))])],1):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("img",{staticClass:"ai-right-img",attrs:{src:"static/images/explain-ai-img.png"}})])}],!1,null,"87a9e2e0",null).exports);function O(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,s=function(){};return{s:s,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){o=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw i}}}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var N=document.documentElement.clientWidth,P={name:"SingleChoice",filters:{filterOrder:function(t){return["A.","B.","C.","D.","E.","F.","G.","H.","I.","J.","K.","L.","M.","N.","O.","P.","Q.","R.","S.","T.","U.","V.","W.","X.","Y.","Z."][t]},filterAnswer:function(t){return["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"][t]}},mixins:[D,p,m,g.a],components:{attachementPreview:h.a},props:{itemdata:{type:Object,default:function(){}},answer:{type:Array,default:function(){return[]}},canDo:{type:Boolean,default:!0},isCurrent:Boolean,subject:{type:String,default:""},number:{type:Number,default:null},showShadow:{type:String,default:""},status:{type:String,default:null},exerciseMode:{type:String,default:""},exerciseInfo:{type:Object,default:function(){}},analysis:{type:String,default:""},parentTitleAnalysis:{type:String,default:""},parentType:{type:String,default:""},testResult:{type:Object,default:function(){}},mode:{type:String,default:""},disabledData:{type:Boolean,default:!1},isExercise:{type:Boolean},totalCount:{type:Number,default:0},reviewedCount:{type:Number,default:0}},data:function(){return{radio:this.answer[0],currentItem:null,isShowDownIcon:null,isShowUpIcon:!1,question:[],refreshKey:!0,myAnswer:"C",width:N,answerData:{},stopAnswer:{},isShowAiExplain:!0,stopAiExplain:!1,anewAiExplain:!1}},mounted:function(){var t;this.canDo&&"exercise"===this.mode&&this.refreshChoice(),this.isShowDownIcon=(null===(t=document.getElementsByClassName("material-icon")[this.number])||void 0===t?void 0:t.childNodes[0].offsetWidth)>234},computed:{stem:{get:function(){return this.itemdata.parentTitle?this.itemdata.parentTitle.stem:this.itemdata.stem}}},methods:{filterOrder:function(t){return this.$options.filters.filterOrder(t)},filterAnswer:function(t){return this.$options.filters.filterAnswer(t)},choose:function(t){this.currentItem=t,this.$emit("singleChoose",this.radio,this.itemdata)},getAttachementByType:function(t){return this.itemdata.attachments.filter((function(e){return e.module===t}))||[]},getAttachementMaterialType:function(t){return this.itemdata.parentTitle.attachments.filter((function(e){return e.module===t}))||[]},changeUpIcon:function(){this.isShowUpIcon=!0,this.isShowDownIcon=!1},changeDownIcon:function(){this.isShowUpIcon=!1,this.isShowDownIcon=!0},goResults:function(){this.$emit("goResults")},getAiAnalysis:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){var n,a,s,i,r,o,c,l,u,d,h,p,m,g,w,v,y,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.itemdata.id,a={role:"student",questionId:n,answerRecordId:t.exerciseInfo.id},s=!1,i=[],t.answerData[n]="",t.stopAnswer[n]=!1,r=setInterval((function(){0!==i.length&&(t.stopAnswer[n]&&clearInterval(r),t.answerData[n]+=i.shift(),0===i.length&&s&&(clearInterval(r),t.stopAiExplain=!1,t.anewAiExplain=!0),t.$refs.aiAnalysis.innerHTML=t.answerData[n])}),50),e.next=9,fetch("/api/ai/question_analysis/generate",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Accept:"application/vnd.edusoho.v2+json","X-Auth-Token":f.a.state.token},body:JSON.stringify(a)});case 9:o=e.sent,c=o.body.getReader(),l=new TextDecoder,u="";case 13:return e.next=16,c.read();case 16:d=e.sent,h=d.done,p=d.value,m=(u+l.decode(p)).split("\n\n"),g=1,w=O(m);try{for(w.s();!(v=w.n()).done;)y=v.value,g==m.length?u=y:("message"===(_=JSON.parse(y.slice(5))).event&&i.push(_.answer),g++)}catch(t){w.e(t)}finally{w.f()}if(!h){e.next=26;break}return s=!0,e.abrupt("break",28);case 26:e.next=13;break;case 28:case"end":return e.stop()}}),e)})))()},stopAiAnalysis:function(){var t=this.itemdata.id;this.stopAnswer[t]=!0},aiGeneration:function(){this.isShowAiExplain=!1,this.stopAiExplain=!0,this.anewAiExplain=!1,this.getAiAnalysis()},stopAiGeneration:function(){this.stopAiExplain=!1,this.isShowAiExplain=!1,this.anewAiExplain=!0,this.stopAiAnalysis()}}},B=(n("a049"),Object(b.a)(P,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.itemdata.parentTitle?n("div",{staticClass:"subject-material"},[n("div",{class:["material-stem-nowrap",t.isShowDownIcon?"material-stem":""]},[t.itemdata.parentTitle?n("span",{staticClass:"material-tags"},[t._v("\n        "+t._s(t.subject)+"\n      ")]):t._e(),n("span",{staticClass:"material-text material-icon",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),n("i",{class:["iconfont","icon-arrow-up",{"show-up-icon":t.isShowDownIcon}],on:{click:t.changeUpIcon}}),n("i",{class:["iconfont","icon-arrow-down",{"show-down-icon":t.isShowUpIcon}],on:{click:t.changeDownIcon}}),t._l(t.getAttachementMaterialType("material"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),n("div",{staticClass:"subject"},[t.itemdata.parentTitle?t._e():n("span",{staticClass:"tags"},[t._v("\n      "+t._s(t.subject)+"\n    ")]),t.itemdata.parentTitle?t._e():n("div",{staticClass:"subject-stem"},[n("span",{staticClass:"serial-number"},[t._v(t._s(t.itemdata.seq)+"、")]),n("div",{staticClass:"rich-text",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),t.itemdata.parentTitle?n("div",{class:["material-title",{"material-title-weight":t.itemdata.parentTitle}]},[n("span",{staticClass:"serial-number"},[n("span",{staticClass:"material-type"},[t._v("["+t._s(t.$t("courseLearning.singleChoice"))+"] ")]),t._v(" "+t._s(t.itemdata.materialIndex)+"、")]),n("div",{staticClass:"rich-text",domProps:{innerHTML:t._s(t.itemdata.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]):t._e(),t._l(t.getAttachementByType("stem"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})})),n("van-radio-group",{key:t.refreshKey,class:["answer-paper",{convention:"exercise"!==t.mode}],on:{change:t.choose},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},t._l(t.itemdata.metas.choices,(function(e,a){return n("van-radio",{key:a,class:["subject-option",t.canDo?"":t.checkAnswer(a,t.itemdata),{active:a===t.currentItem},{"van-checked__right":t.itemdata.answer?t.itemdata.answer[0]===a:""},{isRight:t.question.length>0&&t.filterOrder(a).replace(".","")===t.question[0].answer[0]},{isWrong:t.question.length>0&&t.filterOrder(a).replace(".","")===t.question[0].response[0]&&t.question[0].response[0]!==t.question[0].answer[0]}],attrs:{name:a,disabled:!t.disabledData}},[n("i",{staticClass:"iconfont icon-cuowu2"}),n("i",{staticClass:"iconfont icon-zhengque1"}),n("i",{staticClass:"iconfont icon-a-Frame34723"}),n("div",{class:["subject-option__content",t.canDo?"":"not-can-do"],domProps:{innerHTML:t._s(e)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}),n("span",{staticClass:"subject-option__order",attrs:{slot:"icon"},slot:"icon"},[t._v("\n          "+t._s(t._f("filterOrder")(a)))])])})),1),t.disabledData?t._e():n("div",{staticClass:"one-questions-analysis"},[n("div",{staticClass:"flex justify-between analysis-answer"},[n("div",{staticClass:"flex items-center"},[n("span",{staticClass:"answer"},[t._v(t._s(t.$t("courseLearning.referenceAnswer"))+"：")]),n("span",{staticClass:"options",staticStyle:{color:"#00B42A"}},[t._v(t._s(t._f("filterAnswer")(t.itemdata.answer)))])]),t.question.length>0&&t.question[0].response[0].length>0||t.testResult.answer&&t.testResult.answer.length>0?n("div",{staticClass:"flex items-center"},[n("span",{staticClass:"answer"},[t._v(t._s(t.$t("courseLearning.selectedAnswer"))+"：")]),n("span",{staticClass:"options"},[t._v(t._s(t.question.length>0?t.question[0].response[0]:t.filterAnswer(t.testResult.answer)))])]):t._e()]),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n        "+t._s(t.$t("courseLearning.score"))+"："+t._s(t.itemdata.testResult?t.itemdata.testResult.score:0)+"\n      ")]):t._e(),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n        "+t._s(t.$t("courseLearning.comment"))+"："+t._s(t.itemdata.testResult?null===t.itemdata.testResult.teacherSay?"--":t.itemdata.testResult.teacherSay:"")+"\n      ")]):t._e(),n("div",{staticClass:"analysis-color"},[n("span",{staticClass:"float-left"},[t._v(t._s(t.$t("courseLearning.analyze"))+"：")]),t.analysis?n("span",{domProps:{innerHTML:t._s(t.analysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("span",{ref:"aiAnalysis"},[t._v(t._s(t.$t("courseLearning.noParsing")))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.itemdata.aiAnalysisEnable,expression:"itemdata.aiAnalysisEnable"}],staticClass:"ai-analysis"},[n("p",{staticClass:"ai-tittle"},[t._v(t._s(t.$t("courseLearning.aiAssistant")))]),n("div",{staticClass:"ai-content"},[n("div",{staticClass:"ai-content-left"},[n("button",{directives:[{name:"show",rawName:"v-show",value:t.isShowAiExplain,expression:"isShowAiExplain"}],staticClass:"ai-btn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-ai.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.analysis")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.stopAiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-stop.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.stopGeneration")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.anewAiExplain,expression:"anewAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-anew.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.reGenerate")))])]),n("p",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-left-tittle"},[t._v(t._s(t.$t("courseLearning.beGenerating")))])]),t._m(0)])]),t._l(t.getAttachementByType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2)],2),t.isShowFooterShardow()?n("div",{staticClass:"footer-shadow"}):t._e(),t.parentType&&"material"===t.parentType&&!t.disabledData?n("div",{staticClass:"subject-footer"},[n("span",{staticClass:"float-left"},[t._v(t._s(t.$t("courseLearning.analyze"))+"：")]),""!==t.parentTitleAnalysis?n("span",{domProps:{innerHTML:t._s(t.parentTitleAnalysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("span",[t._v(t._s(t.$t("courseLearning.noParsing")))]),t._l(t.getAttachementMaterialType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),t.totalCount===t.reviewedCount?n("div",{staticClass:"submit-footer"},[n("van-button",{staticClass:"submit-footer-btn",style:{width:t.width-20+"px"},attrs:{type:"primary"},on:{click:function(e){return t.goResults()}}},[t._v(t._s(t.$t("courseLearning.viewResult2")))])],1):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("img",{staticClass:"ai-right-img",attrs:{src:"static/images/explain-ai-img.png"}})])}],!1,null,"061535e3",null).exports);function F(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return H(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,s=function(){};return{s:s,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){o=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw i}}}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var G=document.documentElement.clientWidth,U={name:"DetermineType",mixins:[D,p,m,g.a],components:{attachementPreview:h.a},props:{itemdata:{type:Object,default:function(){}},isCurrent:Boolean,answer:{type:Array,default:function(){return[]}},canDo:{type:Boolean,default:!0},subject:{type:String,default:""},number:{type:Number,default:null},showShadow:{type:String,default:""},exerciseMode:{type:String,default:""},status:{type:String,default:null},exerciseInfo:{type:Object,default:function(){}},analysis:{type:String,default:""},mode:{type:String,default:""},disabledData:{type:Boolean,default:!1},parentTitleAnalysis:{type:String,default:""},parentType:{type:String,default:""},totalCount:{type:Number,default:0},reviewedCount:{type:Number,default:0}},data:function(){return{radio:this.answer[0],currentItem:null,isShowDownIcon:null,isShowUpIcon:!1,myAnswer:"F",question:[],width:G,myRadioAnswer:"T",answerData:{},stopAnswer:{},isShowAiExplain:!0,stopAiExplain:!1,anewAiExplain:!1}},computed:{stem:{get:function(){return this.itemdata.parentTitle?this.itemdata.parentTitle.stem:this.itemdata.stem}}},mounted:function(){var t;this.canDo&&"exercise"===this.mode&&this.refreshChoice(),this.isShowDownIcon=(null===(t=document.getElementsByClassName("material-icon")[this.number])||void 0===t?void 0:t.childNodes[0].offsetWidth)>234},methods:{choose:function(t){this.currentItem=t,this.$emit("determineChoose",this.radio,this.itemdata)},getAttachementByType:function(t){return this.itemdata.attachments.filter((function(e){return e.module===t}))||[]},getAttachementMaterialType:function(t){return this.itemdata.parentTitle.attachments.filter((function(e){return e.module===t}))||[]},changeUpIcon:function(){this.isShowUpIcon=!0,this.isShowDownIcon=!1},changeDownIcon:function(){this.isShowUpIcon=!1,this.isShowDownIcon=!0},goResults:function(){this.$emit("goResults")},getAiAnalysis:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){var n,a,s,i,r,o,c,l,u,d,h,p,m,g,w,v,y,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.itemdata.id,a={role:"student",questionId:n,answerRecordId:t.exerciseInfo.id},s=!1,i=[],t.answerData[n]="",t.stopAnswer[n]=!1,r=setInterval((function(){0!==i.length&&(t.stopAnswer[n]&&clearInterval(r),t.answerData[n]+=i.shift(),0===i.length&&s&&(clearInterval(r),t.stopAiExplain=!1,t.anewAiExplain=!0),t.$refs.aiAnalysis.innerHTML=t.answerData[n])}),50),e.next=9,fetch("/api/ai/question_analysis/generate",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Accept:"application/vnd.edusoho.v2+json","X-Auth-Token":f.a.state.token},body:JSON.stringify(a)});case 9:o=e.sent,c=o.body.getReader(),l=new TextDecoder,u="";case 13:return e.next=16,c.read();case 16:d=e.sent,h=d.done,p=d.value,m=(u+l.decode(p)).split("\n\n"),g=1,w=F(m);try{for(w.s();!(v=w.n()).done;)y=v.value,g==m.length?u=y:("message"===(_=JSON.parse(y.slice(5))).event&&i.push(_.answer),g++)}catch(t){w.e(t)}finally{w.f()}if(!h){e.next=26;break}return s=!0,e.abrupt("break",28);case 26:e.next=13;break;case 28:case"end":return e.stop()}}),e)})))()},stopAiAnalysis:function(){var t=this.itemdata.id;this.stopAnswer[t]=!0},aiGeneration:function(){this.isShowAiExplain=!1,this.stopAiExplain=!0,this.anewAiExplain=!1,this.getAiAnalysis()},stopAiGeneration:function(){this.stopAiExplain=!1,this.isShowAiExplain=!1,this.anewAiExplain=!0,this.stopAiAnalysis()}}},W=(n("20ed"),Object(b.a)(U,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.itemdata.parentTitle?n("div",{staticClass:"subject-material"},[n("div",{class:["material-stem-nowrap",t.isShowDownIcon?"material-stem":""]},[t.itemdata.parentTitle?n("span",{class:["material-tags"]},[t._v("\n        "+t._s(t.subject)+"\n      ")]):t._e(),n("span",{staticClass:"material-text material-icon",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),n("i",{class:["iconfont","icon-arrow-up",{"show-up-icon":t.isShowDownIcon}],on:{click:t.changeUpIcon}}),n("i",{class:["iconfont","icon-arrow-down",{"show-down-icon":t.isShowUpIcon}],on:{click:t.changeDownIcon}}),t._l(t.getAttachementMaterialType("material"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),n("div",{staticClass:"subject"},[t.itemdata.parentTitle?t._e():n("span",{staticClass:"tags"},[t._v("\n      "+t._s(t.subject)+"\n    ")]),t.itemdata.parentTitle?t._e():n("div",{staticClass:"subject-stem"},[n("span",{staticClass:"serial-number"},[t._v(t._s(t.itemdata.seq)+"、")]),n("div",{staticClass:"subject-stem__content rich-text",domProps:{innerHTML:t._s(t.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]),t.itemdata.parentTitle?n("div",{class:["material-title",{"material-title-weight":t.itemdata.parentTitle}]},[n("span",{staticClass:"serial-number"},[n("span",{staticClass:"material-type"},[t._v("["+t._s(t.$t("courseLearning.determine"))+"] ")]),t._v(" "+t._s(t.itemdata.materialIndex)+"、")]),n("div",{staticClass:"rich-text",domProps:{innerHTML:t._s(t.itemdata.stem)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}})]):t._e(),t._l(t.getAttachementByType("stem"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})})),n("van-radio-group",{class:["answer-paper",{convention:"exercise"!==t.mode}],on:{change:t.choose},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[n("van-radio",{staticClass:"subject-option subject-option--determine",class:[t.canDo?"":t.checkAnswer(1,t.itemdata),{active:1===t.currentItem&&t.disabledData},{"van-checked__right":!(!t.itemdata.answer||1!==t.itemdata.answer[0]||(t.itemdata.testResult.answer&&t.itemdata.testResult.answer[0],0))},{isRight:t.question.length>0&&"T"===t.question[0].answer[0]},{isWrong:t.question.length>0&&"F"!==t.question[0].response[0]&&t.myRadioAnswer!==t.question[0].answer[0]}],attrs:{name:1,disabled:!t.disabledData}},[n("i",{staticClass:"iconfont icon-a-Frame34723"}),n("i",{staticClass:"iconfont icon-cuowu2"}),n("i",{staticClass:"iconfont icon-zhengque1"}),n("div",{staticClass:"subject-option__content"},[t._v(t._s(t.$t("courseLearning.right")))])]),n("van-radio",{staticClass:"subject-option subject-option--determine",class:[t.canDo?"":t.checkAnswer(0,t.itemdata),{active:0===t.currentItem},{"van-checked__right":!(!t.itemdata.answer||0!==t.itemdata.answer[0]||(t.itemdata.testResult.answer&&t.itemdata.testResult.answer[0],0))},{isRight:t.question.length>0&&"F"===t.question[0].answer[0]},{isWrong:t.question.length>0&&"F"===t.question[0].response[0]&&t.myAnswer!==t.question[0].answer[0]}],attrs:{name:0,disabled:!t.disabledData}},[n("i",{staticClass:"iconfont icon-a-Frame34723"}),n("i",{staticClass:"iconfont icon-cuowu2"}),n("i",{staticClass:"iconfont icon-zhengque1"}),n("div",{staticClass:"subject-option__content"},[t._v(t._s(t.$t("courseLearning.wrong")))])])],1),t.disabledData?t._e():n("div",{staticClass:"one-questions-analysis"},[n("div",{staticClass:"flex justify-between analysis-answer"},[n("div",{staticClass:"flex items-center"},[n("span",{staticClass:"answer"},[t._v(t._s(t.$t("courseLearning.referenceAnswer"))+"：")]),t.question.length>0?n("span",{staticClass:"options",staticStyle:{color:"#00B42A"}},[t._v("\n            "+t._s("T"===t.question[0].answer[0]?t.$t("wrongQuestion.right"):t.$t("wrongQuestion.wrong"))+"\n          ")]):t._e(),t.canDo?t._e():n("span",{staticClass:"options",staticStyle:{color:"#00B42A"}},[t._v("\n            "+t._s(1===t.itemdata.answer[0]?t.$t("wrongQuestion.right"):t.$t("wrongQuestion.wrong"))+"\n          ")])]),t.itemdata.testResult.answer&&t.itemdata.testResult.answer.length>0||t.question.length>0?n("div",{staticClass:"flex items-center"},[n("span",{staticClass:"answer"},[t._v(t._s(t.$t("courseLearning.selectedAnswer"))+"：")]),t.question.length>0?n("span",{staticClass:"options"},[t._v("\n            "+t._s("T"===t.question[0].response[0]?t.$t("wrongQuestion.right"):t.$t("wrongQuestion.wrong"))+"\n          ")]):t._e(),t.canDo?t._e():n("span",[n("span",{staticClass:"options"},[t._v(t._s(1===t.itemdata.testResult.answer[0]?t.$t("wrongQuestion.right"):t.$t("wrongQuestion.wrong")))])])]):t._e()]),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n        "+t._s(t.$t("courseLearning.score"))+"："+t._s(t.itemdata.testResult?t.itemdata.testResult.score:0)+"\n      ")]):t._e(),"exam"===t.mode?n("div",{staticClass:"analysis-color mb-8"},[t._v("\n        "+t._s(t.$t("courseLearning.comment"))+"："+t._s(t.itemdata.testResult?null===t.itemdata.testResult.teacherSay?"--":t.itemdata.testResult.teacherSay:"")+"\n      ")]):t._e(),n("div",{staticClass:"analysis-color"},[n("span",{staticClass:"float-left"},[t._v(t._s(t.$t("courseLearning.analyze"))+"：")]),t.analysis?n("span",{domProps:{innerHTML:t._s(t.analysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("span",{ref:"aiAnalysis"},[t._v(t._s(t.$t("courseLearning.noParsing")))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.itemdata.aiAnalysisEnable,expression:"itemdata.aiAnalysisEnable"}],staticClass:"ai-analysis"},[n("p",{staticClass:"ai-tittle"},[t._v(t._s(t.$t("courseLearning.aiAssistant")))]),n("div",{staticClass:"ai-content"},[n("div",{staticClass:"ai-content-left"},[n("button",{directives:[{name:"show",rawName:"v-show",value:t.isShowAiExplain,expression:"isShowAiExplain"}],staticClass:"ai-btn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-ai.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.analysis")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.stopAiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-stop.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.stopGeneration")))])]),n("button",{directives:[{name:"show",rawName:"v-show",value:t.anewAiExplain,expression:"anewAiExplain"}],staticClass:"ai-stopbtn",on:{click:function(e){return t.aiGeneration()}}},[n("img",{staticClass:"ai-img",attrs:{src:"static/images/explain-anew.png"}}),n("span",{staticClass:"ai-left-text"},[t._v(t._s(t.$t("courseLearning.reGenerate")))])]),n("p",{directives:[{name:"show",rawName:"v-show",value:t.stopAiExplain,expression:"stopAiExplain"}],staticClass:"ai-left-tittle"},[t._v(t._s(t.$t("courseLearning.beGenerating")))])]),t._m(0)])]),t._l(t.getAttachementByType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2)],2),t.isShowFooterShardow()?n("div",{staticClass:"footer-shadow"}):t._e(),t.parentType&&"material"===t.parentType&&!t.disabledData?n("div",{staticClass:"subject-footer"},[n("span",{staticClass:"float-left"},[t._v(t._s(t.$t("courseLearning.analyze"))+"：")]),""!==t.parentTitleAnalysis?n("span",{domProps:{innerHTML:t._s(t.parentTitleAnalysis)},on:{click:function(e){return t.handleClickImage(e.currentTarget)}}}):n("span",[t._v(t._s(t.$t("courseLearning.noParsing")))]),t._l(t.getAttachementMaterialType("analysis"),(function(e){return n("attachement-preview",{key:e.id,attrs:{canLoadPlayer:t.isCurrent,attachment:e}})}))],2):t._e(),t.totalCount===t.reviewedCount?n("div",{staticClass:"submit-footer"},[n("van-button",{staticClass:"submit-footer-btn",style:{width:t.width-20+"px"},attrs:{type:"primary"},on:{click:function(e){return t.goResults()}}},[t._v(t._s(t.$t("courseLearning.viewResult2")))])],1):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("img",{staticClass:"ai-right-img",attrs:{src:"static/images/explain-ai-img.png"}})])}],!1,null,"02d751a2",null).exports),K=n("63dd"),z=n("2ef0"),J=n.n(z);function Q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function X(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(n),!0).forEach((function(e){Object(i.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var V=document.documentElement.clientHeight-44,Y={name:"ItemBank",components:{fillType:C,essayType:S,headTop:R,choiceType:M,singleChoice:B,determineType:W},props:{info:{type:Array,default:function(){return[]}},answer:{type:Object,default:function(){}},current:{type:Number,default:0},showScore:{type:Boolean,default:!0},canDo:{type:Boolean,default:!0},all:{type:Number,default:0},isWrongMode:{type:Boolean,default:!1},isExercise:{type:Boolean,default:!1},resultShow:{type:Boolean,default:!0},exerciseMode:{type:String,default:""},exerciseInfo:{type:Object,default:function(){}},assessment_id:{type:String,default:""},admission_ticket:{type:String,default:""},mode:{type:String,default:""},type:{type:String,default:""},aiAgentRecordId:{type:String,default:""}},data:function(){return{testData:this.info,testAnswer:this.answer,currentIndex:this.current,height:V,sdkLoaded:!1,reviewedCount:null,status:null,iscando:[],refreshKey:!0,myAnswer:null,touchable:!0,questionIndex:0,question:{},aiAgentSdk:null}},computed:X({},Object(o.e)(["cloudSdkCdn","isLoadedSdk"])),watch:{answer:function(t){this.$emit("update:answer",t)},isWrongMode:function(t){this.currentIndex=this.current-1,this.$refs.swipe.swipeTo(this.current-1,{immediate:!0})},current:function(t,e){var n=Number(t);n-1!==this.currentIndex&&this.$refs.swipe.swipeTo(n-1)},reviewedCount:function(){this.reviewedCount===this.info.length&&this.$emit("reviewedCount")}},created:function(){var t=this;this.cloudSdkCdn||this.setCloudAddress(),this.isLoadedSdk||l()("https://".concat(this.cloudSdkCdn,"/js-sdk-v2/sdk-v1.js?").concat(Date.now()),(function(){t.$store.commit(u.m)})),this.sdkLoaded=!0,this.canDo&&"exercise"===this.mode&&this.info.forEach((function(e,n){t.iscando[n]=t.exerciseInfo.submittedQuestions.filter((function(t){return t.questionId+""===e.id})).length<=0}))},mounted:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.tryInitAIAgentSdk();case 1:case"end":return e.stop()}}),e)})))()},mixins:[K.a],methods:X(X({},Object(o.c)(["setCloudAddress"])),{},{tryInitAIAgentSdk:function(){var t=this;this.aiAgentRecordId&&r.a.meCourseMember({query:{id:this.$route.query.courseId}}).then((function(e){if(e.aiTeacherEnabled){t.aiAgentSdk=t.initAIAgentSdk(t.$store.state.user.aiAgentToken,{domainId:e.aiTeacherDomain,courseId:e.courseId,courseName:e.courseSetTitle,lessonId:t.$route.query.targetId},80,20),e.studyPlanGenerated&&t.aiAgentSdk.setVariable("studyPlanGenerated",!0),t.aiAgentSdk.boot(),t.canDo?t.aiAgentSdk.showReminder({title:"Hi，我是小知老师～",content:"我将在你答题过程中随时为你答疑解惑",duration:5e3}):t.aiAgentSdk.showReminder({title:"战绩新鲜出炉！",content:"别独自琢磨，快找小知老师唠唠，一起解锁答题背后的奥秘～",duration:5e3});var n=document.getElementById("agent-sdk-floating-button");null===n||void 0===n||n.addEventListener("click",Object(s.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getQuestion();case 2:t.aiAgentSdk.showReminder({title:"遇到问题啦？",content:"小知老师来为你理清解题思路～",buttonContent:"teacher.question",duration:5e3,workflow:{workflow:t.canDo?"teacher.question.idea":"teacher.question.analysis",inputs:{domainId:e.aiTeacherDomain,question:t.question.question}},chatContent:t.question.content});case 3:case"end":return n.stop()}}),n)}))))}}))},getQuestion:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.aiAgentRecordId){e.next=4;break}return e.next=3,r.a.getExerciseQuestion({query:{answerRecordId:t.aiAgentRecordId,questionId:t.info[t.questionIndex].id}});case 3:t.question=e.sent;case 4:case"end":return e.stop()}}),e)})))()},changeSwiper:function(t){var e=this;return Object(s.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.questionIndex=t,e.aiAgentSdk&&e.aiAgentSdk.hideReminder(),e.currentIndex=t,e.$emit("update:current",t+1),e.$emit("update:slideIndex",t);case 5:case"end":return n.stop()}}),n)})))()},last:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=t.currentIndex&&t.touchable){e.next=2;break}return e.abrupt("return");case 2:t.$refs.swipe.swipeTo(t.currentIndex-1);case 3:case"end":return e.stop()}}),e)})))()},next:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.currentIndex!=t.info.length-1&&t.touchable){e.next=2;break}return e.abrupt("return");case 2:t.$refs.swipe.swipeTo(t.currentIndex+1);case 3:case"end":return e.stop()}}),e)})))()},subject:function(t){var e,n="",a=t.type;if(t.parentType)return this.$t("courseLearning.material");switch(a){case"single_choice":e=this.$t("courseLearning.singleChoice");break;case"choice":e=this.$t("courseLearning.choice");break;case"essay":e=this.$t("courseLearning.essay");break;case"uncertain_choice":e=this.$t("courseLearning.uncertainChoice");break;case"determine":e=this.$t("courseLearning.determine");break;case"fill":e=this.$t("courseLearning.fill");break;case"material":e=this.$t("courseLearning.material");break;default:e=""}return n+e},singleChoose:function(t,e){"1"===this.exerciseMode&&(this.touchable=!1,this.submitSingleAnswer(this.numberFormatterCode(t),e)),this.$set(this.testAnswer[e.id],0,t)},choiceChoose:function(t,e){this.$set(this.testAnswer,e.id,t)},changeTouch:function(){this.touchable=!1},determineChoose:function(t,e){"1"===this.exerciseMode&&(this.touchable=!1,this.submitSingleAnswer(this.numberFormatterCode(t,e.type),e)),this.$set(this.testAnswer[e.id],0,Number(t))},submitSingleAnswer:J.a.debounce((function(t,e){var n=this;"choice"!==e.type&&"uncertain_choice"!==e.type||(t=(t=this.numberFormatterCode(t)).sort()),r.a.submitSingleAnswer({query:{id:this.exerciseInfo.id},data:{admission_ticket:this.admission_ticket,assessment_id:this.assessment_id,exerciseMode:this.exerciseMode,section_id:e.sectionId,item_id:e.itemId,question_id:e.id,response:t}}).then((function(t){var e=0===n.current?n.current:n.current-1;n.$refs["submit"+e][0].refreshChoice(t),n.reviewedCount=t.reviewedCount,n.status=t.status,n.myAnswer=t.response,n.touchable=!0,"right"===t.status?(setTimeout((function(){n.next()}),1e3),n.iscando[e]=!1):n.iscando[e]=!1})).catch((function(t){n.touchable=!0,a.a.fail(t.message)}))}),1e3),numberFormatterCode:function(t,e){return Array.isArray(t)?t.map((function(t){return String.fromCharCode(t+65)})):"determine"===e?1===t?String.fromCharCode(84).split(""):String.fromCharCode(70).split(""):String.fromCharCode(t+65).split("")},goResults:function(){this.$emit("goResults")}}),destroyed:function(){this.$store.commit(u.e)}},Z=Object(b.a)(Y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"paper-swiper"},[t.testData.length>0&&t.sdkLoaded?n("van-swipe",{ref:"swipe",attrs:{height:t.height,"show-indicators":!1,touchable:t.touchable,loop:!1,duration:100,"lazy-render":!0},on:{change:t.changeSwiper}},t._l(t.info,(function(e,a){return n("van-swipe-item",{key:e.id,class:t.canDo&&t.iscando[a]?"exercise-do":"exercise-analysis",style:{height:t.height+"px"}},[n("div",{ref:"paper"+a,refInFor:!0,staticClass:"paper-item"},[n("head-top",{attrs:{all:t.all,"can-do":t.canDo,current:Number(e.seq),subject:t.subject(e),score:""+parseFloat(e.score),"show-score":t.showScore,exerciseMode:t.exerciseMode,totalCount:t.info.length,reviewedCount:t.reviewedCount?t.reviewedCount:t.exerciseInfo?t.exerciseInfo.reviewedCount:0}}),"ai_personality"===t.type?n("div",{staticClass:"notice"},[n("van-notice-bar",{staticClass:"notice-boreder",attrs:{mode:"closeable",color:"#37393D",scrollable:!1,background:"#edf9f2"},scopedSlots:t._u([{key:"left-icon",fn:function(){return[n("img",{staticClass:"notice-ai-img",attrs:{src:"static/images/AI.png"}})]},proxy:!0}],null,!0)},[n("span",[t._v(t._s(t.$t("courseLearning.exerciseAiTips")))])])],1):t._e(),"single_choice"==e.type?n("single-choice",{key:t.refreshKey,ref:"submit"+a,refInFor:!0,attrs:{itemdata:e,answer:t.testAnswer[e.id],"is-current":t.currentIndex===a,"can-do":t.canDo,cloudSdkCdn:t.cloudSdkCdn,showShadow:t.info[t.info.length-1].id,number:a,status:t.status,subject:t.subject(e),exerciseInfo:t.exerciseInfo,exerciseMode:t.exerciseMode,parentTitleAnalysis:e.parentTitle?e.parentTitle.analysis:"",parentType:e.parentType?e.parentType:"",analysis:e.analysis,"test-result":e.testResult,mode:t.mode,isExercise:t.isExercise,disabledData:"exercise"===t.mode?t.canDo&&t.iscando[a]:t.canDo,totalCount:t.info.length,reviewedCount:t.reviewedCount?t.reviewedCount:t.exerciseInfo?t.exerciseInfo.reviewedCount:0},on:{singleChoose:t.singleChoose,goResults:t.goResults}}):t._e(),"choice"==e.type||"uncertain_choice"==e.type?n("choice-type",{ref:"submit"+a,refInFor:!0,attrs:{itemdata:e,answer:t.testAnswer[e.id],"is-current":t.currentIndex===a,number:a,"can-do":t.canDo,showShadow:t.info[t.info.length-1].id,subject:t.subject(e),exerciseInfo:t.exerciseInfo,exerciseMode:t.exerciseMode,analysis:e.analysis,myAnswer:t.myAnswer,"test-result":e.testResult,mode:t.mode,parentTitleAnalysis:e.parentTitle?e.parentTitle.analysis:"",parentType:e.parentType?e.parentType:"",disabledData:"exercise"===t.mode?t.canDo&&t.iscando[a]:t.canDo,totalCount:t.info.length,reviewedCount:t.reviewedCount?t.reviewedCount:t.exerciseInfo?t.exerciseInfo.reviewedCount:0},on:{choiceChoose:t.choiceChoose,submitSingleAnswer:t.submitSingleAnswer,changeTouch:t.changeTouch,goResults:t.goResults}}):t._e(),"determine"==e.type?n("determine-type",{ref:"submit"+a,refInFor:!0,attrs:{itemdata:e,answer:t.testAnswer[e.id],"is-current":t.currentIndex===a,number:a,"can-do":t.canDo,showShadow:t.info[t.info.length-1].id,subject:t.subject(e),status:t.status,exerciseMode:t.exerciseMode,exerciseInfo:t.exerciseInfo,analysis:e.analysis,mode:t.mode,parentTitleAnalysis:e.parentTitle?e.parentTitle.analysis:"",parentType:e.parentType?e.parentType:"",disabledData:"exercise"===t.mode?t.canDo&&t.iscando[a]:t.canDo,totalCount:t.info.length,reviewedCount:t.reviewedCount?t.reviewedCount:t.exerciseInfo?t.exerciseInfo.reviewedCount:0},on:{determineChoose:t.determineChoose,goResults:t.goResults}}):t._e(),"essay"==e.type?n("essay-type",{ref:"submit"+a,refInFor:!0,attrs:{itemdata:e,answer:t.testAnswer[e.id],"can-do":t.canDo,showShadow:t.info[t.info.length-1].id,"is-current":t.currentIndex===a,number:a,mode:t.mode,parentTitleAnalysis:e.parentTitle?e.parentTitle.analysis:"",parentType:e.parentType?e.parentType:"",exerciseMode:t.exerciseMode,subject:t.subject(e),analysis:e.analysis,exerciseInfo:t.exerciseInfo,disabledData:"exercise"===t.mode?t.canDo&&t.iscando[a]:t.canDo,totalCount:t.info.length,reviewedCount:t.reviewedCount?t.reviewedCount:t.exerciseInfo?t.exerciseInfo.reviewedCount:0},on:{submitSingleAnswer:t.submitSingleAnswer,goResults:t.goResults,changeTouch:t.changeTouch}}):t._e(),"fill"==e.type?n("fill-type",{ref:"submit"+a,refInFor:!0,attrs:{itemdata:e,answer:t.testAnswer[e.id],"can-do":t.canDo,showShadow:t.info[t.info.length-1].id,"is-current":t.currentIndex===a,number:a,mode:t.mode,parentTitleAnalysis:e.parentTitle?e.parentTitle.analysis:"",parentType:e.parentType?e.parentType:"",subject:t.subject(e),exerciseMode:t.exerciseMode,exerciseInfo:t.exerciseInfo,analysis:e.analysis,disabledData:"exercise"===t.mode?t.canDo&&t.iscando[a]:t.canDo,totalCount:t.info.length,reviewedCount:t.reviewedCount?t.reviewedCount:t.exerciseInfo?t.exerciseInfo.reviewedCount:0},on:{submitSingleAnswer:t.submitSingleAnswer,goResults:t.goResults,changeTouch:t.changeTouch}}):t._e()],1)])})),1):t._e(),n("div",[n("div",{class:["left-slide__btn",0==t.currentIndex?"slide-disabled":""],on:{click:function(e){return t.last()}}},[n("i",{staticClass:"iconfont icon-arrow-left"})]),n("div",{class:["right-slide__btn",t.currentIndex==t.info.length-1?"slide-disabled":""],on:{click:function(e){return t.next()}}},[n("i",{staticClass:"iconfont icon-arrow-right"})])])],1)}),[],!1,null,null,null);e.a=Z.exports},fbf1:function(t,e,n){"use strict";var a=n("171d");n.n(a).a}}]);