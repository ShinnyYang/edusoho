(window.webpackJsonp=window.webpackJsonp||[]).push([["signContract"],{"114c":function(t,e,i){},4406:function(t,e,i){},"568f":function(t,e,i){"use strict";var n=i("8eae");i.n(n).a},"63c0":function(t,e,i){"use strict";i.r(e),i("a481"),i("96cf");var n=i("3b8d"),a=i("3ce7"),r={name:"ContractDetail",data:function(){return{id:this.$route.params.id,goodsKey:this.$route.params.goodsKey,contractContent:""}},created:function(){this.getContractDetail()},methods:{getContractDetail:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.getSignContractTemplate({query:{id:t.id,goodsKey:t.goodsKey},params:{viewMode:"html"}});case 2:i=e.sent,t.contractContent=i.content;case 4:case"end":return e.stop()}}),e)})))()},routerBack:function(){this.$router.replace({name:"signContract",prams:{id:this.id,goodsKey:this.goodsKey}})}}},o=(i("568f"),i("a6c2")),s=Object(o.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"contract-detail"},[e("div",{staticClass:"py-16 px-32",domProps:{innerHTML:this._s(this.contractContent)}})])}),[],!1,null,"82a08da4",null);e.default=s.exports},"6bf2":function(t,e,i){"use strict";i.r(e),i("8e6e"),i("456d"),i("e7e5");var n=i("d399"),a=i("bd86"),r=(i("ac6a"),i("96cf"),i("3b8d")),o=i("3ce7"),s=i("6647"),c=(i("6762"),i("2fdb"),i("f86d")),d=i.n(c),l={name:"WriteSignature",data:function(){return{signature:null,customTipStyle:null,customBoxContainerStyle:null,bgTextStyle:null,isVertical:[0,180].includes(window.orientation)}},created:function(){var t=this;window.addEventListener("orientationchange",(function(){t.isVertical=[0,180].includes(window.orientation)}))},mounted:function(){this.init()},methods:{init:function(){var t=document.getElementById("canvas"),e=window.innerWidth-104,i=window.innerHeight-102-100;this.signature=new d.a(t,{width:e,height:i,minWidth:4,maxWidth:10}),this.customTipStyle={right:-1*(window.innerWidth-16-11-window.innerWidth/2)*2+"px"},this.customBoxContainerStyle={top:"102px",bottom:"100px"},this.bgTextStyle={width:i+"px",height:e+"px",left:window.innerWidth/2-i/2+"px",top:i/2-e/2+"px"}},getPreviewImg:function(){if(this.signature.isEmpty())n.a.fail(this.$t("contract.signEmpty"));else{var t=this.signature.getRotateCanvas(-90).toDataURL();this.signature.clear(),this.$emit("submit",t)}}}},h=(i("b743"),i("a6c2")),u=Object(h.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"py-12 text-center text-37393D text-16 font-medium"},[t._v(t._s(t.$t("contract.handwritten")))]),i("div",{staticClass:"py-16 text-center text-37393D text-14"},[t._v(t._s(t.$t("contract.acrossScreen")))]),i("div",{staticClass:"box-container",style:t.customBoxContainerStyle},[i("canvas",{attrs:{id:"canvas"}}),i("div",{staticClass:"tip",style:t.customTipStyle},[t._v(t._s(t.$t("contract.signTips")))]),i("div",{staticClass:"bg-text",style:t.bgTextStyle},[t._v(t._s(t.$t("contract.signScope")))])]),i("div",{staticClass:"fixed left-0 right-0 bottom-0 flex items-center justify-center h-100"},[i("div",{staticClass:"btn-list"},[i("van-button",{staticClass:"mb-16 rounded-md",attrs:{type:"primary"},on:{click:t.getPreviewImg}},[t._v(t._s(t.$t("contract.submit")))]),i("van-button",{staticClass:"rounded-md",on:{click:function(e){return t.signature.clear()}}},[t._v(t._s(t.$t("contract.clear")))])],1)]),t.isVertical?t._e():i("div",{staticClass:"across-tips"},[t._v("\n    "+t._s(t.$t("contract.acrossTips"))+"\n  ")])])}),[],!1,null,"0ba551dd",null).exports;function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach((function(e){Object(a.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var v={truename:[{validator:function(t){return!!t},message:s.a.t("contract.placeholder.truename")},{validator:function(t){return/^[\u4e00-\u9fa5]+$/.test(t)||/^[A-Za-z\s]+$/.test(t)},message:s.a.t("contract.validator.truename")}],IDNumber:[{validator:function(t){return!!t},message:s.a.t("contract.placeholder.IDNumber")},{validator:function(t){return!!/^[1-9]\d{5}(19|20)\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[\dXx]$/.exec(t)},message:s.a.t("contract.validator.IDNumber")}],phoneNumber:[{validator:function(t){return!!t},message:s.a.t("contract.placeholder.phoneNumber")},{validator:function(t){return!!/^1\d{10}$/.exec(t)},message:s.a.t("contract.validator.phoneNumber")}],handSignature:[{validator:function(t){return!!t},message:s.a.t("validator.handSignature")}]},g={name:"SignContract",components:{WriteSignature:u},data:function(){return{rules:{},id:this.$route.params.id,goodsKey:this.$route.params.goodsKey,contractDetail:{},writeSignatureVisible:!1,submitLoading:!1,formItems:{}}},computed:{canSubmit:function(){for(var t in this.formItems)if(!this.formItems[t]||!this.formItems[t].trim())return!1;return!0}},created:function(){this.initFormItems()},methods:{initFormItems:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.getSignContractTemplate({query:{id:t.id,goodsKey:t.goodsKey},params:{viewMode:"html"}});case 2:i=e.sent,t.contractDetail=i,i.signFields.forEach((function(e){t.$set(t.formItems,e.field,e.default),t.$set(t.rules,e.field,v[e.field])}));case 5:case"end":return e.stop()}}),e)})))()},viewContractDetail:function(){this.$router.push({name:"contractDetail",prams:{id:this.id,goodsKey:this.goodsKey}})},getWriteSignature:function(t){this.$set(this.formItems,"handSignature",t),this.$refs.formRef.validate("handSignature"),this.writeSignatureVisible=!1},submitForm:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.formRef.validate();case 2:return e.prev=2,t.submitLoading=!0,e.next=6,o.a.signContract({query:{id:t.id},data:f({contractCode:t.contractDetail.code,goodsKey:t.goodsKey},t.formItems)});case 6:n.a.success(t.$t("contract.signSuccess")),t.routerBack();case 8:return e.prev=8,t.submitLoading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[2,,8,11]])})))()},routerBack:function(){this.$router.go(-1)}}},p=(i("a278"),Object(h.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.contractDetail.content?[i("div",{staticClass:"sign-contract-container"},[i("div",{staticClass:"flex-1 flex flex-col mb-24 rounded-8 border border-solid rounded-lg",staticStyle:{"overflow-y":"auto","border-color":"#DFE2E6"}},[i("div",{staticClass:"py-20 px-32 flex-1 overflow-y-auto",domProps:{innerHTML:t._s(t.contractDetail.content)}}),i("div",{staticClass:"check-contract-detail"},[i("div",{staticClass:"inline-flex items-center",on:{click:t.viewContractDetail}},[i("svg",{staticClass:"color-primary",attrs:{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none"}},[i("path",{attrs:{d:"M3.84205 13.6576V6.32422H1.84204V13.6576H3.84205Z","stroke-linejoin":"round"}}),i("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.84204 6.32606C6.21634 4.15306 7.59231 2.90619 7.96997 2.58544C8.53644 2.10431 9.17671 2.30634 9.17671 3.5104C9.17671 4.71446 7.41487 5.40886 7.41487 6.32606C7.41374 6.33153 9.66681 6.3319 14.174 6.32716C14.7265 6.32656 15.1748 6.77393 15.1754 7.3264V7.32743C15.1754 7.8805 14.727 8.32883 14.174 8.32883H11.5042C11.1012 10.9864 10.8789 12.4313 10.8372 12.6634C10.7747 13.0116 10.4424 13.6594 9.48601 13.6594C8.84844 13.6594 7.18934 13.6594 3.84204 13.6594V6.32606Z","stroke-linejoin":"round"}})]),i("span",{staticClass:"color-primary",staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.$t("contract.viewContractDetail")))])])])]),i("van-form",{ref:"formRef"},[t._l(t.rules,(function(e,n){return["IDNumber"==n?i("van-field",{attrs:{autocomplete:"off",maxlength:18,placeholder:t.$t("contract.placeholder.IDNumber"),name:n,rules:t.rules[n]},model:{value:t.formItems[n],callback:function(e){t.$set(t.formItems,n,e)},expression:"formItems[key]"}}):"truename"==n?i("van-field",{attrs:{autocomplete:"off",placeholder:t.$t("contract.placeholder.truename"),name:n,rules:t.rules[n]},model:{value:t.formItems[n],callback:function(e){t.$set(t.formItems,n,e)},expression:"formItems[key]"}}):"phoneNumber"==n?i("van-field",{attrs:{autocomplete:"off",maxlength:11,placeholder:t.$t("contract.placeholder.phoneNumber"),name:n,rules:t.rules[n]},model:{value:t.formItems[n],callback:function(e){t.$set(t.formItems,n,e)},expression:"formItems[key]"}}):[t.formItems.handSignature?t._e():i("div",{staticClass:"flex items-center justify-center py-8 mt-16 leading-24 border border-dashed border-B6BABF rounded-md",on:{click:function(e){t.writeSignatureVisible=!0}}},[i("svg",{attrs:{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none"}},[i("path",{attrs:{d:"M2.83398 14H14.834",stroke:"#5E6166","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}}),i("path",{attrs:{d:"M4.16602 8.90663V11.3333H6.60508L13.4993 4.43603L11.0644 2L4.16602 8.90663Z",stroke:"#5E6166","stroke-width":"1.5","stroke-linejoin":"round"}})]),i("span",{staticClass:"ml-8 text-16 font-medium text-37393D"},[t._v(t._s(t.$t("contract.handwritten")))])]),t.formItems.handSignature?i("div",{staticClass:"flex mt-16"},[i("div",{staticClass:"flex-1 text-center border border-dashed border-B6BABF rounded-md",staticStyle:{height:"42px"}},[i("img",{staticClass:"h-full",attrs:{src:t.formItems.handSignature}})]),i("div",{staticClass:"flex items-center ml-16 py-8 px-16",staticStyle:{"border-color":"#fff"},on:{click:function(e){t.writeSignatureVisible=!0}}},[i("svg",{staticClass:"color-primary",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"}},[i("path",{attrs:{d:"M2.33398 14H14.334","stroke-linecap":"round","stroke-linejoin":"round"}}),i("path",{attrs:{d:"M3.66602 8.90663V11.3333H6.10508L12.9993 4.43603L10.5644 2L3.66602 8.90663Z","stroke-linejoin":"round"}})]),i("span",{staticClass:"color-primary ml-8"},[t._v(t._s(t.$t("contract.reSign")))])])]):t._e()]]}))],2)],1),i("van-popup",{style:{height:"100%"},attrs:{position:"bottom",closeable:""},model:{value:t.writeSignatureVisible,callback:function(e){t.writeSignatureVisible=e},expression:"writeSignatureVisible"}},[i("WriteSignature",{on:{submit:t.getWriteSignature}})],1),i("div",{staticClass:"fixed bottom-0 w-full py-8 px-16 box-border flex"},[i("van-button",{staticClass:"flex-1 rounded-md",attrs:{disabled:!t.canSubmit,type:"primary",loading:t.submitLoading,"loading-text":t.$t("contract.signing")},on:{click:t.submitForm}},[t._v("\n        "+t._s(t.$t("contract.confirmSign"))+"\n      ")])],1)]:i("van-loading",{staticClass:"loading-center"})],2)}),[],!1,null,"4e0b3547",null));e.default=p.exports},"8eae":function(t,e,i){},a278:function(t,e,i){"use strict";var n=i("114c");i.n(n).a},b743:function(t,e,i){"use strict";var n=i("4406");i.n(n).a},f86d:function(t,e,i){t.exports=function(){"use strict";function t(t,e){for(var i=0;e.length>i;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var e=/Android|iPhone|iPad|Mobile/i.test(navigator.userAgent);return function(){function i(t,n){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.canvas={},this.ctx={},this.width=320,this.height=200,this.scale=window.devicePixelRatio||1,this.color="black",this.bgColor="",this.canDraw=!1,this.openSmooth=!0,this.minWidth=2,this.maxWidth=6,this.minSpeed=1.5,this.maxWidthDiffRate=20,this.points=[],this.canAddHistory=!0,this.historyList=[],this.maxHistoryLength=20,this.onStart=function(){},this.onEnd=function(){},this.addListener=function(){a.removeListener(),a.canvas.style.touchAction="none",e&&("ontouchstart"in window||navigator.maxTouchPoints)?(a.canvas.addEventListener("touchstart",a.onDrawStart,{passive:!1}),a.canvas.addEventListener("touchmove",a.onDrawMove,{passive:!1}),document.addEventListener("touchcancel",a.onDrawEnd,{passive:!1}),document.addEventListener("touchend",a.onDrawEnd,{passive:!1})):(a.canvas.addEventListener("mousedown",a.onDrawStart),a.canvas.addEventListener("mousemove",a.onDrawMove),document.addEventListener("mouseup",a.onDrawEnd))},this.removeListener=function(){a.canvas.style.touchAction="auto",a.canvas.removeEventListener("touchstart",a.onDrawStart),a.canvas.removeEventListener("touchmove",a.onDrawMove),document.removeEventListener("touchend",a.onDrawEnd),document.removeEventListener("touchcancel",a.onDrawEnd),a.canvas.removeEventListener("mousedown",a.onDrawStart),a.canvas.removeEventListener("mousemove",a.onDrawMove),document.removeEventListener("mouseup",a.onDrawEnd)},this.onDrawStart=function(t){t.preventDefault(),a.canDraw=!0,a.canAddHistory=!0,a.ctx.strokeStyle=a.color,a.initPoint(t),a.onStart&&a.onStart(t)},this.onDrawMove=function(t){if(t.preventDefault(),a.canDraw&&(a.initPoint(t),a.points.length>=2)){a.addHistory();var e=a.points.slice(-1)[0],i=a.points.slice(-2,-1)[0];window.requestAnimationFrame?window.requestAnimationFrame((function(){return a.onDraw(i,e)})):a.onDraw(i,e)}},this.onDraw=function(t,e){a.openSmooth?a.drawSmoothLine(t,e):a.drawNoSmoothLine(t,e)},this.onDrawEnd=function(t){a.canDraw&&(a.canDraw=!1,a.canAddHistory=!0,a.points=[],a.onEnd&&a.onEnd(t))},this.getLineWidth=function(t){return Math.min(Math.max(a.maxWidth-(a.maxWidth-a.minWidth)*t/(a.minSpeed>10?10:1>a.minSpeed?1:a.minSpeed),a.minWidth),a.maxWidth)},this.getRadianData=function(t,e,i,n){var a=i-t,r=n-e;if(0===a)return{val:0,pos:-1};if(0===r)return{val:0,pos:1};var o=Math.abs(Math.atan(r/a));return i>t&&e>n||t>i&&n>e?{val:o,pos:1}:{val:o,pos:-1}},this.getRadianPoints=function(t,e,i,n){if(0===t.val)return 1===t.pos?[{x:e,y:i+n},{x:e,y:i-n}]:[{y:i,x:e+n},{y:i,x:e-n}];var a=Math.sin(t.val)*n,r=Math.cos(t.val)*n;return 1===t.pos?[{x:e+a,y:i+r},{x:e-a,y:i-r}]:[{x:e+a,y:i-r},{x:e-a,y:i+r}]},this.initPoint=function(t){var e=Date.now(),i=a.points.slice(-1)[0];if(!i||i.t!==e){var n=a.canvas.getBoundingClientRect(),r=t.touches&&t.touches[0]||t,o=r.clientX-n.left,s=r.clientY-n.top;if(!i||i.x!==o||i.y!==s){var c={x:o,y:s,t:e};if(a.openSmooth&&i){var d=a.points.slice(-2,-1)[0];if(c.distance=Math.sqrt(Math.pow(c.x-i.x,2)+Math.pow(c.y-i.y,2)),c.speed=c.distance/(c.t-i.t||.1),c.lineWidth=a.getLineWidth(c.speed),d&&d.lineWidth&&i.lineWidth){var l=(c.lineWidth-i.lineWidth)/i.lineWidth,h=a.maxWidthDiffRate/100;h=h>1?1:.01>h?.01:h,Math.abs(l)>h&&(c.lineWidth=i.lineWidth*(1+(l>0?h:-h)))}}a.points.push(c),a.points=a.points.slice(-3)}}},this.drawSmoothLine=function(t,e){var i=e.x-t.x,n=e.y-t.y;if(Math.abs(i)+Math.abs(n)>a.scale?(e.lastX1=t.x+.3*i,e.lastY1=t.y+.3*n,e.lastX2=t.x+.7*i,e.lastY2=t.y+.7*n):(e.lastX1=e.lastX2=t.x+.5*i,e.lastY1=e.lastY2=t.y+.5*n),e.perLineWidth=(t.lineWidth+e.lineWidth)/2,"number"==typeof t.lastX1){if(a.drawCurveLine(t.lastX2,t.lastY2,t.x,t.y,e.lastX1,e.lastY1,e.perLineWidth),t.isFirstPoint)return;if(t.lastX1===t.lastX2&&t.lastY1===t.lastY2)return;var r=a.getRadianData(t.lastX1,t.lastY1,t.lastX2,t.lastY2),o=a.getRadianPoints(r,t.lastX1,t.lastY1,t.perLineWidth/2),s=a.getRadianPoints(r,t.lastX2,t.lastY2,e.perLineWidth/2);a.drawTrapezoid(o[0],s[0],s[1],o[1])}else e.isFirstPoint=!0},this.drawNoSmoothLine=function(t,e){e.lastX=t.x+.5*(e.x-t.x),e.lastY=t.y+.5*(e.y-t.y),"number"==typeof t.lastX&&a.drawCurveLine(t.lastX,t.lastY,t.x,t.y,e.lastX,e.lastY,a.maxWidth)},this.drawCurveLine=function(t,e,i,n,r,o,s){a.ctx.lineWidth=Number(s.toFixed(1)),a.ctx.beginPath(),a.ctx.moveTo(Number(t.toFixed(1)),Number(e.toFixed(1))),a.ctx.quadraticCurveTo(Number(i.toFixed(1)),Number(n.toFixed(1)),Number(r.toFixed(1)),Number(o.toFixed(1))),a.ctx.stroke()},this.drawTrapezoid=function(t,e,i,n){a.ctx.beginPath(),a.ctx.moveTo(Number(t.x.toFixed(1)),Number(t.y.toFixed(1))),a.ctx.lineTo(Number(e.x.toFixed(1)),Number(e.y.toFixed(1))),a.ctx.lineTo(Number(i.x.toFixed(1)),Number(i.y.toFixed(1))),a.ctx.lineTo(Number(n.x.toFixed(1)),Number(n.y.toFixed(1))),a.ctx.fillStyle=a.color,a.ctx.fill()},this.drawBgColor=function(){a.bgColor&&(a.ctx.fillStyle=a.bgColor,a.ctx.fillRect(0,0,a.width,a.height))},this.drawByImageUrl=function(t){var e=new Image;e.onload=function(){a.ctx.clearRect(0,0,a.width,a.height),a.ctx.drawImage(e,0,0,a.width,a.height)},e.crossOrigin="anonymous",e.src=t},this.addHistory=function(){a.maxHistoryLength&&a.canAddHistory&&(a.canAddHistory=!1,a.historyList.push(a.canvas.toDataURL()),a.historyList=a.historyList.slice(-a.maxHistoryLength))},this.clear=function(){a.ctx.clearRect(0,0,a.width,a.height),a.drawBgColor(),a.historyList.length=0},this.undo=function(){var t=a.historyList.splice(-1)[0];t&&a.drawByImageUrl(t)},this.toDataURL=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(a.canvas.width===a.width)return a.canvas.toDataURL(t,e);var i=document.createElement("canvas");i.width=a.width,i.height=a.height;var n=i.getContext("2d");return n.drawImage(a.canvas,0,0,i.width,i.height),i.toDataURL(t,e)},this.getPNG=function(){return a.toDataURL()},this.getJPG=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.8;return a.toDataURL("image/jpeg",t)},this.isEmpty=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return t.width=a.canvas.width,t.height=a.canvas.height,a.bgColor?(e.fillStyle=a.bgColor,e.fillRect(0,0,t.width,t.height)):1!==a.scale&&e.scale(a.scale,a.scale),t.toDataURL()===a.canvas.toDataURL()},this.getRotateCanvas=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:90;t=t>0?t>90?180:90:-90>t?180:-90;var e=document.createElement("canvas"),i=a.width,n=a.height;180===t?(e.width=i,e.height=n):(e.width=n,e.height=i);var r=e.getContext("2d");return r.rotate(t*Math.PI/180),90===t?r.drawImage(a.canvas,0,-n,i,n):-90===t?r.drawImage(a.canvas,-i,0,i,n):180===t&&r.drawImage(a.canvas,-i,-n,i,n),e},this.init(t,n)}var n,a;return n=i,(a=[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t&&(this.canvas=t,this.ctx=t.getContext("2d"),this.width=e.width||t.clientWidth||this.width,this.height=e.height||t.clientHeight||this.height,this.scale=e.scale||this.scale,this.color=e.color||this.color,this.bgColor=e.bgColor||this.bgColor,this.openSmooth=void 0===e.openSmooth?this.openSmooth:!!e.openSmooth,this.minWidth=e.minWidth||this.minWidth,this.maxWidth=e.maxWidth||this.maxWidth,this.minSpeed=e.minSpeed||this.minSpeed,this.maxWidthDiffRate=e.maxWidthDiffRate||this.maxWidthDiffRate,this.maxHistoryLength=e.maxHistoryLength||this.maxHistoryLength,this.onStart=e.onStart,this.onEnd=e.onEnd,this.scale>0&&(this.canvas.height=this.height*this.scale,this.canvas.width=this.width*this.scale,1!==this.scale&&(this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.ctx.scale(this.scale,this.scale))),this.ctx.lineCap="round",this.drawBgColor(),this.addListener())}}])&&t(n.prototype,a),i}()}()}}]);