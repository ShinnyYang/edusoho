(window.webpackJsonp=window.webpackJsonp||[]).push([["course"],{"0087":function(t,e,s){"use strict";var n=s("cca0");s.n(n).a},"0b19":function(t,e,s){"use strict";var n=s("57b1");s.n(n).a},"0d18":function(t,e,s){"use strict";var n=s("59ac");s.n(n).a},"19d9":function(t,e,s){"use strict";var n=s("efcf");s.n(n).a},"2d42":function(t,e,s){"use strict";var n={name:"e-empty",props:{text:{type:String,default:""}}},i=s("0c7c"),r=Object(i.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"e-empty"},[e("img",{staticClass:"e-empty__img",attrs:{src:"static/images/empty.png"}}),e("p",{staticClass:"e-empty__text"},[this._v(this._s(this.text))])])}),[],!1,null,null,null);e.a=r.exports},"39ed":function(t,e,s){"use strict";var n={props:{title:{type:String,default:""},content:{type:String,default:""},isJoin:{type:Boolean,default:!1}}},i=(s("492f"),s("0c7c")),r=Object(i.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"closed-tips"},[s("van-icon",{staticClass:"closed-icon",attrs:{name:"warning-o",color:"#FF7D00"}}),s("div",{staticClass:"ml-8 flex flex-col items-start"},[s("span",{staticClass:"title"},[t._v(t._s(t.title))]),t.isJoin?s("span",{staticClass:"content"},[t._v(t._s(t.content))]):t._e()])],1)}),[],!1,null,"784b42fe",null);e.a=r.exports},"492f":function(t,e,s){"use strict";var n=s("7189");s.n(n).a},4980:function(t,e,s){"use strict";var n=s("957b");s.n(n).a},"4f45":function(t,e,s){},5655:function(t,e,s){"use strict";var n=s("db77");s.n(n).a},"57b1":function(t,e,s){},"59ac":function(t,e,s){},7189:function(t,e,s){},7659:function(t,e,s){"use strict";var n=s("ad2f");s.n(n).a},"83bb":function(t,e,s){},"870c":function(t,e,s){"use strict";var n=s("4f45");s.n(n).a},"8b9a":function(t,e,s){"use strict";var n=s("dba9");s.n(n).a},"957b":function(t,e,s){},ad2f:function(t,e,s){},bd22:function(t,e,s){},cca0:function(t,e,s){},ce0d:function(t,e,s){"use strict";var n=s("bd22");s.n(n).a},d331:function(t,e,s){"use strict";var n=s("83bb");s.n(n).a},d824:function(t,e,s){"use strict";var n=s("dc8f");s.n(n).a},db5d:function(t,e,s){},db77:function(t,e,s){},dba9:function(t,e,s){},dc8f:function(t,e,s){},efcf:function(t,e,s){},f13d:function(t,e,s){"use strict";s("8e6e"),s("ac6a"),s("456d");var n=s("75fc"),i=(s("e7e5"),s("d399")),r=s("bd86"),a=(s("c5f6"),s("3ce7"));function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}var c={props:{tips:{type:String,default:"placeholder.dragTheSliderToCompleteThePuzzle"},limitType:{type:String,default:""}},data:function(){return{imgInfo:{url:"",jigsaw:"",token:""},dragState:{left:0,width:0,currentX:0,currentLeft:0,btnWidth:0,maskWidth:0},dragToEnd:!1}},created:function(){this.initDragCaptcha()},mounted:function(){var t=this.$refs.bar,e=this.$refs.dragBtn,s=t.getBoundingClientRect();Object.assign(this.dragState,{left:Number(s.left.toFixed(2)),width:t.clientWidth,btnWidth:e.offsetWidth/2})},methods:{initDragCaptcha:function(){var t=this,e={};this.limitType&&(e={limitType:this.limitType}),a.a.dragCaptcha({data:e}).then((function(e){t.imgInfo=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},e),Object.assign(t.dragState,{currentLeft:0,maskWidth:0}),t.dragToEnd=!1})).catch((function(t){i.a.fail(t.message)}))},handletTouchEnd:function(){var t=this;if(!this.dragToEnd&&this.dragState.currentLeft){var e=this.getToken();this.dragToEnd=!0,a.a.dragValidate({query:{token:e}}).then((function(s){i.a.success(t.$t("e.verificationSuccess")),t.$emit("success",e)})).catch((function(e){i.a.fail(e.message),t.initDragCaptcha()}))}},handleTouchMove:function(t){if(!this.dragToEnd){t.preventDefault();var e=this.$refs.dragBtn,s=this.dragState,n=t.clientX?t.clientX.toFixed(2):t.targetTouches[0].pageX.toFixed(2)-this.$refs.drag.offsetLeft,i=(n-s.left-s.btnWidth).toFixed(2);i<0&&(i=0),n>s.width+this.$refs.drag.offsetLeft&&(i=s.width-this.$refs.dragImg.width),Object.assign(this.dragState,{currentLeft:i,maskWidth:(Number(i)+e.offsetWidth/2).toFixed(2)})}},calPositionX:function(){var t=this.$refs.dragImgBg,e=(t.naturalWidth/t.width).toFixed(2);return(Number(this.dragState.currentLeft).toFixed(2)*e).toFixed(2)},getToken:function(){var t={token:this.imgInfo.token,captcha:this.calPositionX()};return Object(n.a)(btoa(JSON.stringify(t))).reverse().join("")}}},u=s("0c7c"),l=Object(u.a)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"drag",staticClass:"e-drag"},[s("div",{staticClass:"e-drag-section"},[s("div",{staticClass:"e-drag-img"},[s("img",{ref:"dragImgBg",attrs:{src:t.imgInfo.url,alt:""}}),s("img",{ref:"dragImg",staticClass:"e-drag-img__dragable",style:{left:t.dragState.currentLeft+"px"},attrs:{src:t.imgInfo.jigsaw,alt:""}})]),s("div",{ref:"bar",staticClass:"e-drag-bar"},[s("span",[t._v(t._s(t.$t(t.tips)))]),s("div",{staticClass:"e-drag-bar__mask",style:{width:t.dragState.maskWidth+"px"}}),s("div",{ref:"dragBtn",staticClass:"e-drag-btn",style:{left:t.dragState.currentLeft+"px"},on:{touchend:t.handletTouchEnd,touchmove:t.handleTouchMove}},[s("img",{attrs:{src:"static/images/drag.png",alt:""}})])])])])}),[],!1,null,null,null);e.a=l.exports},f54e:function(t,e,s){"use strict";var n=s("db5d");s.n(n).a},fd4a:function(t,e,s){"use strict";s.r(e),s("8e6e"),s("ac6a"),s("456d"),s("7f7f"),s("e17f");var n=s("2241"),i=(s("c5f6"),s("96cf"),s("3b8d")),r=s("bd86"),a=(s("a481"),s("e7e5"),s("d399")),o=(s("4917"),s("b127")),c=s("202a"),u=(s("6b54"),s("2f62"));function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function d(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var p={name:"SwiperDirectory",props:{item:{type:Array,default:function(){return[]}},slideIndex:{type:Number,default:0},hasChapter:{type:Boolean,default:!0}},data:function(){return{current:this.slideIndex||0}},watch:{slideIndex:function(t,e){t!=e&&(this.current=t||0)}},computed:d(d({},Object(u.e)(["courseSettings"])),{},{swiperWidth:function(){var t=window.innerWidth;return t<=500?265:t/1.5}}),mounted:function(){},methods:{changeChapter:function(t){this.current=t,this.$emit("changeChapter",t)},handleChapter:function(t){this.$refs.chapterSwipe.swipeTo(t)}}},h=s("0c7c"),f=Object(h.a)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"swiper-directory"},[s("van-swipe",{ref:"chapterSwipe",attrs:{"show-indicators":!1,loop:!1,touchable:!0,width:t.swiperWidth,"initial-swipe":t.slideIndex},on:{change:t.changeChapter}},t._l(t.item,(function(e,n){return s("van-swipe-item",{key:n},[0==e.isExist?s("div",{staticClass:"chapter nochapter",class:"swiper-directory-active",on:{click:function(e){return t.handleChapter(n)}}},[s("i",{staticClass:"iconfont icon-wuzhangjieliang"}),t._v("\n        "+t._s(t.$t("courseLearning.noChapter"))+"\n      ")]):t._e(),1==e.isExist?s("div",{staticClass:"chapter haschapter",class:[t.current===n?"swiper-directory-active":""],on:{click:function(e){return t.handleChapter(n)}}},[s("p",{staticClass:"chapter-title text-overflow"},[t._v("\n          第"+t._s(e.number)+t._s(t.courseSettings.chapter_name?t.courseSettings.chapter_name:t.$t("courseLearning.chapter"))+"："+t._s(e.title)+"\n        ")]),s("p",{staticClass:"chapter-des text-overflow"},[t._v("\n          "+t._s(t.hasChapter?"节("+e.unitNum+")":"")+" "+t._s(t.$t("courseLearning.lesson"))+"("+t._s(e.lessonNum)+") "+t._s(t.$t("courseLearning.learningTasks"))+"("+t._s(e.tasksNum)+")\n        ")])]):t._e()])})),1)],1)}),[],!1,null,null,null).exports;function m(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}var g={name:"UtilDirectory",props:{util:{type:Object,default:function(){}}},computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?m(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},Object(u.e)(["courseSettings"]))},v=Object(h.a)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return 1==t.util.isExist?s("div",{staticClass:"util-directory text-overflow"},[t._v("\n  第"+t._s(t.util.number)+t._s(t.courseSettings.part_name?t.courseSettings.part_name:t.$t("courseLearning.section2"))+"："+t._s(t.util.title)+"\n")]):t._e()}),[],!1,null,null,null).exports,b=(s("6762"),s("d863")),y=s("2164"),C=s("faa5"),_=s("3ce7"),w=s("a556");function k(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function O(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?k(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):k(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var x={name:"LessonDirectory",mixins:[b.a,y.a],props:{lesson:{type:Array,default:function(){return[]}},errorMsg:{type:String,default:""},taskId:{type:Number,default:-1},taskNumber:{type:Number,default:-1},unitNum:{type:Number,default:-1},courseSet:{type:Object,default:function(){}}},data:function(){return{currentTask:"",getAgainCourse:{},CONFIG:{android:"https://a.app.qq.com/o/simple.jsp?pkgname=com.edusoho.zhixiang",ios:"https://apps.apple.com/cn/app/知享学堂/id887301045",scheme:"com.qdxxzy.user://"}}},watch:{taskId:{handler:"getTaskId",immediate:!0}},computed:O(O(O({},Object(u.e)("course",{details:function(t){return t.details},joinStatus:function(t){return t.joinStatus},selectedPlanId:function(t){return t.selectedPlanId}})),Object(u.e)({isOnlyApp:function(t){var e;return null===(e=t.courseSettings)||void 0===e?void 0:e.only_learning_on_APP}})),{},{hasLesson:function(){return this.lesson.length>0},isNoData:function(){return 0===this.taskNumber&&0===this.unitNum}}),mounted:function(){if(Object.keys(this.$route.query).length){var t=this.$route.query,e=t.sourceType,s=t.taskId;this.setSourceType({sourceType:e,taskId:s})}},methods:O(O({},Object(u.d)("course",{setSourceType:C.A})),{},{getTaskId:function(){this.currentTask=this.taskId},doubleLine:function(t){if(!t.isReplay&&t.type)return"live"===t.type},showTask:function(t,e){var s=!0;return null==t.mode&&0==e&&(s=!1),"lesson"==t.mode&&(s=!1),s},isCanLearn:function(t){var e,s,n=["testpaper","homework","exercise"].includes(t.type),i=!t.result||"finish"!=t.result.status;return"closed"!==(null===(e=this.getAgainCourse)||void 0===e||null===(s=e.courseSet)||void 0===s?void 0:s.status)||!!n&&(!n||!i)},getCourse:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={courseId:t.selectedPlanId},e.next=3,_.a.getCourseDetail({query:s}).then((function(e){t.getAgainCourse=e}));case 3:case"end":return e.stop()}}),e)})))()},judgePhoneType:function(){var t,e=!1,s=!1,n=!1,i=navigator.userAgent,r=i.toLowerCase();(i.indexOf("Android")>-1||i.indexOf("Linux")>-1)&&(e=!0),r.indexOf("like mac os x")>0&&(t=(r.match(/os [\d._]*/gi)+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,"."));var a=t+"";return"undefined"!==a&&a.length>0&&((t=parseInt(t))>=8?n=!0:s=!0),{isAndroid:e,isIOS:s,isIOS9:n}},isWeiXin:function(){return/micromessenger/i.test(navigator.userAgent.toLowerCase())||void 0!==navigator.wxuserAgent},goConfirmAddr:function(){var t=this.judgePhoneType().isAndroid;window.location.href=t?this.CONFIG.android:this.CONFIG.ios},openApp:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.judgePhoneType(),n=s.isAndroid,i=s.isIOS,r=s.isIOS9;if(this.isWeiXin())alert("请您在浏览器中打开,即可下载");else{if(n||i){var a=!0,o=Date.now(),c=document.createElement("iframe");setTimeout((function(){a||e&&e(),document.body.removeChild(c)}),2e3),c.setAttribute("src",t),c.setAttribute("style","display:none"),document.body.appendChild(c),setTimeout((function(){Date.now()-o<1100&&(a=!1)}),1e3)}r&&(setTimeout((function(){e&&e()}),250),setTimeout((function(){}),1e3))}},getData:function(t){var e=this;return Object(i.a)(regeneratorRuntime.mark((function s(){var n;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return n={},s.prev=1,s.next=4,_.a.getMedia({query:{courseId:e.selectedPlanId,taskId:t},params:{version:"escloud"}}).then((function(t){t.media&&(n=t.media)}));case 4:s.next=9;break;case 6:s.prev=6,s.t0=s.catch(1);case 9:return s.abrupt("return",n);case 10:case"end":return s.stop()}}),s,null,[[1,6]])})))()},detectBrowserInfo:function(){var t=navigator.userAgent.toLowerCase(),e=/micromessenger/i.test(t),s=/wxwork/i.test(t),n=/dingtalk/i.test(t),i=/lark/i.test(t);return!!(e||s||n||i)},lessonCellClick:function(t,e,s){var n=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getCourse();case 2:if(n.isCanLearn(t)){e.next=4;break}return e.abrupt("return",Object(w.a)("course"));case 4:if("live"!==t.type&&"video"!==t.type){e.next=14;break}return e.next=7,n.getData(t.id);case 7:if(!(s=e.sent).isEncryptionPlus||!s.securityVideoPlayer){e.next=11;break}return Object(a.a)("请在APP学习"),e.abrupt("return");case 11:if(!s.isEncryptionPlus||s.securityVideoPlayer||n.detectBrowserInfo()){e.next=14;break}return Object(a.a)("请在APP学习或使用钉钉/飞书/微信/企业微信内置浏览器打开"),e.abrupt("return");case 14:if(n.$store.commit(C.B,""),!n.errorMsg||Number(t.isFree)){e.next=18;break}return n.$emit("showDialog"),e.abrupt("return");case 18:if(!t.lock){e.next=21;break}return Object(a.a)(n.$t("courseLearning.needToUnlockThePreviousTask")),e.abrupt("return");case 21:if("create"!==t.status&&"published"===t.status){e.next=24;break}return Object(a.a)(n.$t("courseLearning.stayTuned")),e.abrupt("return");case 24:i={id:t.id},n.$store.commit("course/".concat(C.i),{nextTask:i}),!n.details.allowAnonymousPreview&&n.$router.push({name:"login",query:{redirect:n.redirect}}),n.joinStatus&&n.showTypeDetail(t);case 29:case"end":return e.stop()}}),e)})))()},showTypeDetail:function(t){var e=this;if("published"===t.status)switch(t.type){case"video":"self"===t.mediaSource?this.setSourceType({sourceType:"video",taskId:t.id}):Object(a.a)(this.$t("courseLearning.doesNotSupportThisType"));break;case"audio":this.setSourceType({sourceType:"audio",taskId:t.id});break;case"ppt":this.setSourceType({sourceType:"ppt",taskId:t.id});break;case"text":case"doc":this.$router.push({name:"course_web",query:{courseId:this.selectedPlanId,taskId:t.id,type:t.type}});break;case"live":var s=!1;if(new Date>new Date(1e3*t.endTime)&&"closed"===t.liveStatus){if("videoGenerated"==t.activity.replayStatus)return void this.setSourceType({sourceType:"video",taskId:t.id});if("ungenerated"==t.activity.replayStatus)return void Object(a.a)(this.$t("courseLearning.noReplay"));s=!0}this.$router.push({name:"live",query:{courseId:this.selectedPlanId,taskId:t.id,type:t.type,title:t.title,replay:s}});break;case"testpaper":var i=t.activity.testpaperInfo,r=i.testpaperId,o=i.answerRecordId;_.a.testpaperIntro({params:{targetId:t.id,targetType:"task"},query:{testId:r}}).then((function(s){var n=s.task.activity.testpaperInfo.endTime,i=s.testpaperResult;"finished"!=(null===i||void 0===i?void 0:i.status)&&"reviewing"!=(null===i||void 0===i?void 0:i.status)||!(1e3*n>Date.now()||0==n||null==n)?e.$router.push({name:"testpaperIntro",query:{testId:r,targetId:t.id,courseId:e.$route.params.id}}):e.$router.push({name:"testpaperResult",query:{testId:r,targetId:t.id,resultId:o,courseId:e.$route.params.id}})})).catch((function(t){4032203===t.code?n.a.alert({title:"试卷已关闭",confirmButtonText:"确定",confirmButtonColor:"#00BE63"}):a.a.fail(t.message)}));break;case"homework":this.$router.push({name:"homeworkIntro",query:{courseId:this.$route.params.id,taskId:t.id}});break;case"exercise":this.$router.push({name:"exerciseIntro",query:{courseId:this.$route.params.id,taskId:t.id}});break;default:this.setSourceType({sourceType:"img",taskId:t.id}),this.copyPcUrl(t.courseUrl)}else Object(a.a)(this.$t("courseLearning.stayTuned"))},iconfont:function(t){var e=t.type;if(t.isReplay)return"icon-replay";switch(e){case"audio":return"icon-yinpin";case"doc":return"icon-wendang";case"exercise":return"icon-lianxi";case"flash":return"icon-flash";case"homework":return"icon-zuoye";case"live":return"icon-zhibo";case"ppt":return"icon-ppt";case"discuss":return"icon-taolun";case"testpaper":return"icon-kaoshi";case"text":return"icon-tuwen";case"video":return"icon-shipin";case"download":return"icon-xiazai";default:return""}},studyStatus:function(t){if(t.lock)return"icon-suo";if(null==t.result)return"icon-weixuexi";switch(t.result.status){case"finish":return"icon-yiwanchengliang";case"start":return"icon-weiwancheng";default:return""}},liveClass:function(t){return"published"!=t.status||"live"!=t.type?"nopublished":"generated"===t.activity.replayStatus?"back":"closed"===t.progressStatus?"end":"created"===t.progressStatus||"live"===t.progressStatus?"play":void 0}})};function j(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function T(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?j(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):j(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var I={name:"AfterjoinDirectory",components:{swiperDirectory:f,utilDirectory:v,lessonDirectory:Object(h.a)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._l(t.lesson,(function(e,n){return[t.hasLesson?s("div",{key:n,staticClass:"lesson-directory"},[s("div",{staticClass:"lesson-title flex justify-between items-center",class:{"zb-ks":t.doubleLine(e.tasks[e.index])},attrs:{id:e.tasks[e.index].id},on:{click:function(s){return t.lessonCellClick(e.tasks[e.index],n,e.index)}}},[s("div",{staticClass:"lesson-title-r"},[s("div",{staticClass:"lesson-title-des"},[t.doubleLine(e.tasks[e.index])?t._e():s("div",{staticClass:"bl l22"},[s("span",{staticClass:"ks",class:{lessonactive:t.currentTask==e.tasks[e.index].id}},[s("i",{staticClass:"iconfont",class:t.iconfont(e.tasks[e.index])}),s("div",[t._v("\n                  "+t._s(Number(e.tasks[e.index].isOptional)?"":t.$t("courseLearning.lesson"))+t._s(Number(e.tasks[e.index].isOptional)?e.title:e.tasks[e.index].number+":"+e.title)+"\n                ")])])]),t.doubleLine(e.tasks[e.index])?s("div",{staticClass:"bl"},[s("div",{staticClass:"block-inline"},[s("span",{staticClass:"bl ks",class:{lessonactive:t.currentTask==e.tasks[e.index].id},staticStyle:{display:"flex"}},[s("i",{staticClass:"iconfont",class:t.iconfont(e.tasks[e.index])}),s("div",[t._v("\n                    "+t._s(Number(e.tasks[e.index].isOptional)?"":t.$t("courseLearning.lesson"))+t._s(Number(e.tasks[e.index].isOptional)?e.title:e.tasks[e.index].number+":"+e.title)+"\n                  ")])]),s("span",{staticClass:"bl zbtime"},[s("span",{class:[t.liveClass(e.tasks[e.index])]},[t._v(t._s(t._f("filterTaskTime")(e.tasks[e.index])))])])])]):t._e()])]),s("div",{staticClass:"lesson-title-l"},[Number(e.tasks[e.index].isOptional)?s("span",{staticClass:"elective-tag"},[t._v("\n            "+t._s(t.$t("courseLearning.optional"))+"\n          ")]):t._e(),"live"!=e.tasks[e.index].type?s("span",[t._v(t._s(t._f("filterTaskTime")(e.tasks[e.index])))]):t._e(),s("i",{staticClass:"iconfont",class:t.studyStatus(e.tasks[e.index])})])]),e.tasks.length>1?s("div",{staticClass:"lesson-items"},[t._l(e.tasks,(function(e,i){return[t.showTask(e,i)?s("div",{key:i,staticClass:"litem",attrs:{id:e.id},on:{click:function(s){return t.lessonCellClick(e,n,i)}}},[s("div",{staticClass:"litem-r",class:{lessonactive:t.currentTask==Number(e.id)}},[s("i",{staticClass:"iconfont",class:t.iconfont(e)}),s("div",[t._v("\n                "+t._s(Number(e.isOptional)?"":t.$t("courseLearning.lesson"))+t._s(Number(e.isOptional)?e.title:e.number+":"+e.title)+"\n              ")])]),s("div",{staticClass:"litem-l clearfix"},[s("span",{class:[t.liveClass(e)]},[t._v(t._s(t._f("filterTaskTime")(e)))]),s("i",{staticClass:"iconfont",class:t.studyStatus(e)})])]):t._e()]}))],2):t._e()]):t._e()]})),t.isNoData?s("div",{staticClass:"noneItem"},[s("img",{staticClass:"notask",attrs:{src:"static/images/none.png"}}),s("p",[t._v(t._s(t.$t("courseLearning.thereIsNoClassYet")))])]):t._e()],2)}),[],!1,null,"08f4f0fc",null).exports},props:{courseSet:{type:Object,default:function(){}}},data:function(){return{scroll:"",item:[],level:3,chapterNum:0,unitNum:0,lessonNum:0,currentChapter:0,currentUnit:0,currentLesson:0,slideIndex:0,taskId:null,nodata:!1,allTask:{},allTaskId:[]}},computed:T(T({},Object(u.e)("course",{nextStudy:function(t){return t.nextStudy},selectedPlanId:function(t){return t.selectedPlanId},OptimizationCourseLessons:function(t){return t.OptimizationCourseLessons},details:function(t){return t.details},taskStatus:function(t){return t.taskStatus}})),{},{hasChapter:function(){return this.chapterNum>0}}),watch:{nextStudy:{handler:"getNextStudy",immediate:!0},selectedPlanId:{handler:"processItem",immediate:!0,deep:!0},taskStatus:{handler:"changeTaskStatus",immediate:!1}},methods:{getNextStudy:function(){if(this.nextStudy.nextTask){this.taskId=Number(this.nextStudy.nextTask.id);var t=this.allTask[this.taskId];if(!t)return;this.hasChapter?this.slideIndex=t.chapterIndex:this.slideIndex=t.unitIndex}},processItem:function(t){var e=this.OptimizationCourseLessons;this.resetData(),e.length?(this.nodata=!1,this.setItems(e),this.mapChild(this.item),this.startScroll(),this.$store.commit("course/".concat(C.n),this.allTask)):this.nodata=!0},resetData:function(){this.chapterNum=0,this.unitNum=0,this.lessonNum=0},setItems:function(t){this.level=1===t.length&&0==t[0].isExist?2:3,1===t.length?this.item=2===this.level?t[0].children:t:t.length>1&&(this.item=t)},mapChild:function(t){var e=this;t.map((function(s,n){"chapter"===s.type?e.formatChapter(s,t,n):"unit"===s.type?e.formatUnit(s,t,n):"lesson"===s.type?e.formatLesson(s,t,n):e.formatTask(s,t,n)}))},startScroll:function(){var t=this;this.$nextTick((function(){if(t.taskId){var e=document.getElementById("progress-bar"),s=document.getElementById("swiper-directory"),n=document.getElementById(t.taskId),i=e?e.offsetHeight:0,r=s?s.offsetHeight:0,a=(n?n.offsetTop:0)-i-44-r;a<document.documentElement.clientWidth||window.scrollTo({top:a})}}))},formatChapter:function(t,e,s){this.currentChapter=s,t.chapterNum=0,t.unitNum=0,t.lessonNum=0,t.tasksNum=0,t.isExist&&(this.chapterNum+=1,this.computedNum(1,"chapterNum")),Array.isArray(t.children)&&t.children.length>0&&this.mapChild(t.children)},formatUnit:function(t,e,s){this.currentUnit=s,t.unitNum=0,t.lessonNum=0,t.tasksNum=0,t.isExist&&(this.unitNum+=1,this.computedNum(1,"unitNum")),Array.isArray(t.children)&&t.children.length>0&&(this.computedNum(t.children.length,"lessonNum"),this.mapChild(t.children))},formatLesson:function(t,e,s){this.currentLesson=s,t.isExist&&(this.lessonNum+=1),t.tasks&&(this.computedNum(t.tasks.length-1,"tasksNum"),this.mapChild(t.tasks))},formatTask:function(t,e,s){Number(t.id)===this.taskId&&(this.slideIndex=3==this.level?this.currentChapter:this.currentUnit),this.getLessonIndex(t,s),t.chapterIndex=this.currentChapter,t.unitIndex=this.currentUnit,t.LessonIndex=this.currentLesson,t.level=this.level,t.taskIndex=s,this.allTask[t.id]=T({},t),this.allTaskId.push(t.id)},getLessonIndex:function(t,e){t.mode?"lesson"===t.mode&&this.getMainTask(t,e):this.getMainTask(t,0)},getMainTask:function(t,e){3===this.level?this.$set(this.item[this.currentChapter].children[this.currentUnit].children[this.currentLesson],"index",e):this.$set(this.item[this.currentUnit].children[this.currentLesson],"index",e)},computedNum:function(t,e){var s=3===this.level?this.currentChapter:this.currentUnit,n=this.item[s][e]+t;this.$set(this.item[s],e,n)},changeChapter:function(t){this.slideIndex=t},changeTaskStatus:function(t){if(t){"finish"===t&&this.changeLockStatus();var e=this.allTask[this.taskId],s={};if(2===e.level){var n=this.item[e.unitIndex].children[e.LessonIndex].tasks[e.taskIndex];n.result?n.result.status=t:(s.status=t,n.result=s)}else{var i=this.item[e.chapterIndex].children[e.unitIndex].children[e.LessonIndex].tasks[e.taskIndex];i.result?i.result.status=t:(s.status=t,i.result=s)}}},changeLockStatus:function(){if("lockMode"===this.details.learnMode){var t=this.allTaskId.indexOf(this.taskId.toString());if(t<this.allTaskId.length-1){var e=this.allTaskId[t+1],s=this.allTask[e];2===s.level?this.item[s.unitIndex].children[s.LessonIndex].tasks[s.taskIndex].lock=!1:this.item[s.chapterIndex].children[s.unitIndex].children[s.LessonIndex].tasks[s.taskIndex].lock=!1}}}}},L=(s("0087"),Object(h.a)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"afterjoin-directory"},[t.lessonNum>0?s("div",[t.chapterNum>0||t.unitNum>0?s("swiper-directory",{attrs:{id:"swiper-directory",item:t.item,"slide-index":t.slideIndex,"has-chapter":t.hasChapter},on:{changeChapter:t.changeChapter}}):t._e(),t.item.length>0?s("div",{attrs:{id:"lesson-directory"}},[t.chapterNum>0?t._l(t.item[t.slideIndex].children,(function(e,n){return s("div",{key:n,staticClass:"pd-bo"},[s("util-directory",{attrs:{util:e}}),s("lesson-directory",t._g(t._b({attrs:{lesson:e.children,"task-id":t.taskId,"task-number":t.item[t.slideIndex].lessonNum,"unit-num":t.item[t.slideIndex].unitNum,"course-set":t.courseSet}},"lesson-directory",t.$attrs,!1),t.$listeners))],1)})):s("div",{staticClass:"pd-bo"},[s("lesson-directory",t._g(t._b({attrs:{lesson:t.item[t.slideIndex].children,"task-id":t.taskId,"task-number":t.item[t.slideIndex].lessonNum,"unit-num":t.item[t.slideIndex].unitNum,"course-set":t.courseSet}},"lesson-directory",t.$attrs,!1),t.$listeners))],1)],2):t._e()],1):t._e(),t.nodata&&0==t.lessonNum?s("div",{staticClass:"noneItem"},[s("img",{staticClass:"nodata",attrs:{src:"static/images/none.png"}}),s("p",[t._v(t._s(t.$t("courseLearning.thereIsNoCourseYet")))])]):t._e()])}),[],!1,null,"e126381a",null).exports),$=s("2095"),S=s("4928"),D=s("39ed"),P=s("2ef0"),N=s.n(P),E=(s("4662"),s("28a2")),R={name:"DiscussionItem",props:{item:{type:Object,required:!0}},methods:{readFile:function(t){Object(E.a)({images:this.item.imgs,showIndex:!0,loop:!0,closeOnPopstate:!0,startPosition:t})}},computed:{content:function(){return this.item.content.replace(/<img .*?>/g,"")}}},q=(s("d824"),Object(h.a)(R,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"discussion-item"},[s("h3",{staticClass:"discussion-title text-overflow"},[t._v(t._s(t.item.title))]),s("p",{staticClass:"discussion-desc",domProps:{innerHTML:t._s(t.content)}}),s("div",{staticClass:"discussion-details"},[s("div",{staticClass:"discussion-details__left"},[s("img",{staticClass:"user-avatar",attrs:{src:t.item.user.avatar.small}}),s("span",[t._v(t._s(t.item.user.nickname)+"\n        "+t._s(t._f("formatCourseTime")(t.item.createdTime)))])]),s("div",{staticClass:"discussion-details__right"},[s("i",{staticClass:"iconfont icon-review"}),t._v("\n      "+t._s(t.item.postNum)+"\n    ")])]),s("div",{staticClass:"discussion-list"},t._l(t.item.imgs,(function(e,n){return s("van-image",{key:n,attrs:{width:"100",height:"100",src:e},on:{click:function(e){return e.stopPropagation(),t.readFile(n)}}})})),1)])}),[],!1,null,"bb7440d0",null).exports),A=s("2d42"),F={name:"DiscussionList",components:{DiscussionItem:q,Empty:A.a},props:{type:{type:String,required:!0},details:{type:Object,default:function(){return{}}}},data:function(){return{list:[],loading:!1,finished:!1,paging:{offset:0,limit:10},courseId:this.$route.params.id}},computed:{emptyText:function(){return"question"===this.type?this.$t("courseLearning.noQA"):this.$t("courseLearning.noTopics")},createText:function(){return"question"===this.type?this.$t("courseLearning.initiateQA"):this.$t("courseLearning.initiateTopics")}},methods:{onLoad:function(){var t=this,e=this.paging,s=e.offset,n=e.limit;_.a.getCoursesThreads({query:{courseId:this.courseId},params:{type:this.type,limit:n,offset:s*n}}).then((function(e){var s=e.data,n=e.paging.total;N.a.assign(t,{list:N.a.concat(t.list,s),loading:!1}),t.paging.offset++,N.a.size(t.list)>=n&&(t.finished=!0)}))},handleClickViewDetail:function(t){this.$emit("change-current-component",{component:"Detail",data:t})},handleClickCreateDiscussion:function(){var t,e;if("closed"==(null===(t=this.details)||void 0===t||null===(e=t.courseSet)||void 0===e?void 0:e.status))return Object(w.a)("course");this.$emit("change-current-component",{component:"Create"})}}},B=(s("0d18"),Object(h.a)(F,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"discussion-list"},[s("van-list",{attrs:{finished:t.finished,"loading-text":t.$t("toast.loading")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("discussion-item",{key:e.id,attrs:{item:e},nativeOn:{click:function(s){return t.handleClickViewDetail(e)}}})})),1),!t.list.length&&t.finished?s("empty",{attrs:{text:t.emptyText}}):t._e(),"closed"!=t.details.courseSet.status?s("div",{staticClass:"create-btn"},[s("van-button",{attrs:{type:"primary",block:""},on:{click:t.handleClickCreateDiscussion}},[t._v("\n      "+t._s(t.createText)+"\n    ")])],1):t._e()],1)}),[],!1,null,"45a0f931",null).exports),z={name:"ReplyItem",props:{item:{type:Object,required:!0}}},M=(s("870c"),{name:"DiscussionDetail",components:{ReplyItem:Object(h.a)(z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"reply-item"},[s("div",{staticClass:"reply-item__info"},[s("img",{staticClass:"avatar",attrs:{src:t.item.user.avatar.small}}),s("span",[t._v(t._s(t.item.user.nickname)+" "+t._s(t._f("formatCourseTime")(t.item.createdTime)))])]),s("div",{staticClass:"reply-item__content",domProps:{innerHTML:t._s(t.item.content)}})])}),[],!1,null,"4a24d91f",null).exports},props:{discussion:{type:Object,required:!0},details:{type:Object,default:function(){}},type:{type:String,required:!0}},data:function(){return{content:"",courseId:this.$route.params.id,loading:!1,finished:!1,paging:{offset:0,limit:10},replyList:[]}},computed:{titleText:function(){return"question"===this.type?this.$t("courseLearning.QADetails"):this.$t("courseLearning.topicDetails")}},methods:{readFile:function(t){Object(E.a)({images:this.discussion.imgs,showIndex:!0,loop:!0,closeOnPopstate:!0,startPosition:t})},fetchCourseThreadPost:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s,n,i,r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.paging,n=s.offset,i=s.limit,e.next=3,_.a.getCoursesThreadPost({query:{courseId:t.courseId,threadId:t.discussion.id},params:{limit:i,offset:n*i}});case 3:r=e.sent,a=r.data,o=r.paging.total,N.a.assign(t,{replyList:N.a.concat(t.replyList,a),loading:!1}),t.paging.offset++,N.a.size(t.replyList)>=o&&(t.finished=!0);case 9:case"end":return e.stop()}}),e)})))()},handleClickGoToList:function(){this.$emit("change-current-component",{component:"List"})},handleClickEnter:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("closed"!=t.details.courseSet.status){e.next=2;break}return e.abrupt("return",Object(w.a)("course"));case 2:if(s=N.a.trim(t.content)){e.next=6;break}return t.$toast(t.$t("courseLearning.pleaseEnterContent")),e.abrupt("return");case 6:return e.next=8,_.a.createCoursesThreadPost({query:{courseId:t.courseId,threadId:t.discussion.id},data:{content:s}});case 8:n=e.sent,t.replyList.unshift(n),t.content="";case 11:case"end":return e.stop()}}),e)})))()}}}),H=(s("19d9"),Object(h.a)(M,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"discussion-detail"},[s("div",{staticClass:"detail-header"},[s("van-icon",{attrs:{name:"cross",size:"18px",color:"#000"},on:{click:t.handleClickGoToList}}),s("h3",{staticClass:"detail-header__title"},[t._v(t._s(t.titleText))])],1),s("div",{staticClass:"discussion-body"},[s("div",{staticClass:"discussion-body__info"},[s("img",{staticClass:"avatar",attrs:{src:t.discussion.user.avatar.small}}),s("div",{staticClass:"info-right"},[s("span",[t._v(t._s(t.discussion.user.nickname))]),s("span",[t._v(t._s(t._f("formatCourseTime")(t.discussion.createdTime)))])])]),s("div",{staticClass:"discussion-body__title"},[t._v(t._s(t.discussion.title))]),s("div",{staticClass:"discussion-body__content",domProps:{innerHTML:t._s(t.discussion.content)}}),s("div",{staticClass:"discussion-list"},t._l(t.discussion.imgs,(function(e,n){return s("van-image",{key:n,attrs:{width:"100",height:"100",src:e},on:{click:function(e){return e.stopPropagation(),t.readFile(n)}}})})),1)]),s("van-list",{attrs:{finished:t.finished},on:{load:t.fetchCourseThreadPost},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.replyList,(function(t){return s("reply-item",{key:t.id,attrs:{item:t}})})),1),s("div",{staticClass:"reply"},[s("van-field",{ref:"replyInput",attrs:{placeholder:t.$t("courseLearning.reply2")},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),s("span",{staticClass:"reply-btn",on:{click:t.handleClickEnter}},[t._v(t._s(t.$t("courseLearning.reply")))])],1)],1)}),[],!1,null,"71f1a6f0",null).exports),W={name:"DiscussionCreate",props:{type:{type:String,required:!0}},data:function(){return{title:"",content:"",fileList:[],imgs:[]}},computed:{text:function(){var t=this,e={question:{title:"courseLearning.sendQA",placeholderTitle:"courseLearning.QATitle",placeholderContent:"courseLearning.QAContent"},discussion:{title:"courseLearning.postTopic",placeholderTitle:"courseLearning.topicTitle",placeholderContent:"courseLearning.topicContent"}}[this.type];return N.a.forEach(e,(function(s,n){e[n]=t.$t(s)})),e}},methods:{handleClickGoToList:function(){this.$emit("change-current-component",{component:"List"})},createDiscussion:function(){var t=this;this.$refs.form.validate().then(Object(i.a)(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.$route.params.id,e.next=3,_.a.createCoursesThread({query:{courseId:s},data:{content:t.content,courseId:s,type:t.type,title:t.title,imgs:t.imgs}});case 3:t.handleClickGoToList();case 4:case"end":return e.stop()}}),e)}))))},afterRead:function(t){var e=this,s=new FormData;s.append("file",t.content),s.append("group","course"),_.a.updateFile({data:s}).then((function(t){e.imgs.push(t.uri)})).catch((function(t){a.a.fail(t.message)}))},deleteImgItem:function(t,e){this.imgs.splice(e.index,1)}}},U=(s("0b19"),Object(h.a)(W,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"discussion-create"},[s("div",{staticClass:"create-header"},[s("van-icon",{attrs:{name:"cross",size:"18px",color:"#000"},on:{click:t.handleClickGoToList}}),s("h3",{staticClass:"create-header__title"},[t._v(t._s(t.text.title))]),s("span",{staticClass:"create-header__btn",on:{click:t.createDiscussion}},[t._v(t._s(t.$t("courseLearning.publish")))])],1),s("van-form",{ref:"form"},[s("div",{staticClass:"discussion-create__title"},[s("van-field",{attrs:{error:!1,placeholder:t.text.placeholderTitle,rules:[{required:!0,message:t.$t("courseLearning.pleaseEnterATitle")}]},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),s("div",{staticClass:"discussion-create__content"},[s("van-field",{attrs:{type:"textarea",rows:"1",error:!1,autosize:"",placeholder:t.text.placeholderContent,rules:[{required:!0,message:t.$t("courseLearning.pleaseEnterContent")}]},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),s("div",{staticClass:"discussion-create__upload"},[s("van-uploader",{attrs:{"after-read":t.afterRead,"max-count":6},on:{delete:t.deleteImgItem},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1)])],1)}),[],!1,null,"7fd42935",null).exports),G={name:"Discussion",components:{List:B,Detail:H,Create:U},props:{type:{type:String,required:!0},details:{type:Object,default:function(){return{}}}},data:function(){return{currentComponent:"List",currentDiscussion:{}}},watch:{currentComponent:function(){this.$emit("chang-tabs-status","List"===this.currentComponent)}},methods:{changeCurrentComponent:function(t){var e=t.component,s=t.data;N.a.assign(this,{currentComponent:e,currentDiscussion:s})}}},J=Object(h.a)(G,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"discussion"},[e(this.currentComponent,{tag:"component",attrs:{discussion:this.currentDiscussion,type:this.type,details:this.details},on:{"change-current-component":this.changeCurrentComponent}})],1)}),[],!1,null,null,null).exports,Q={name:"Discussion",components:{List:B,Detail:H,Create:U},props:{type:{type:String,required:!0},details:{type:Object,default:function(){return{}}}},data:function(){return{currentComponent:"List",currentDiscussion:{}}},watch:{currentComponent:function(){this.$emit("chang-tabs-status","List"===this.currentComponent)}},methods:{changeCurrentComponent:function(t){var e=t.component,s=t.data;N.a.assign(this,{currentComponent:e,currentDiscussion:s})}}},X=Object(h.a)(Q,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"discussion"},[e(this.currentComponent,{tag:"component",attrs:{discussion:this.currentDiscussion,type:this.type,details:this.details},on:{"change-current-component":this.changeCurrentComponent}})],1)}),[],!1,null,null,null).exports,V={name:"NoteItem",props:{item:{type:Object,required:!0}},computed:{content:function(){return this.item.content.replace(/<img .*?>/g,"")},isLike:function(){return!!N.a.size(this.item.like)}}},Y=(s("d331"),{name:"Note-list",components:{NoteItem:Object(h.a)(V,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"note-item"},[s("div",{staticClass:"note-item__top"},[s("div",{staticClass:"note-info"},[s("img",{staticClass:"avatar",attrs:{src:t.item.user.avatar.small,alt:""}}),s("span",[t._v(t._s(t.item.user.nickname)+" "+t._s(t._f("formatCourseTime")(t.item.createdTime)))]),s("span",{staticClass:"tag text-overflow"},[t._v(t._s(t.item.task.title))])]),s("div",{staticClass:"note-like",class:{like:t.isLike}},[s("i",{staticClass:"iconfont icon-like"}),t._v("\n      "+t._s(t.item.likeNum)+"\n    ")])]),s("div",{staticClass:"note-item__content",domProps:{innerHTML:t._s(t.content)}})])}),[],!1,null,"6611b010",null).exports,Empty:A.a},data:function(){return{list:[],loading:!1,finished:!1,paging:{offset:0,limit:10},courseId:this.$route.params.id}},methods:{onLoad:function(){var t=this,e=this.paging,s=e.offset,n=e.limit;_.a.getCoursesNotes({query:{courseId:this.courseId},params:{limit:n,offset:s*n}}).then((function(e){var s=e.data,n=e.paging.total;N.a.assign(t,{list:N.a.concat(t.list,s),loading:!1}),t.paging.offset++,N.a.size(t.list)>=n&&(t.finished=!0)}))},handleClickViewDetail:function(t){this.$emit("change-current-component",{component:"Detail",data:t})}}}),K=(s("4980"),Object(h.a)(Y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"note-list"},[s("van-list",{attrs:{finished:t.finished,"loading-text":t.$t("toast.loading")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("note-item",{key:e.id,attrs:{item:e},nativeOn:{click:function(s){return t.handleClickViewDetail(e)}}})})),1),!t.list.length&&t.finished?s("empty",{attrs:{text:t.$t("courseLearning.noNotes")}}):t._e()],1)}),[],!1,null,"6abcc50e",null).exports),Z={name:"NoteDetail",props:{note:{type:Object,required:!0},details:{type:Object,default:function(){}}},data:function(){return{noteDetail:this.note,courseId:this.$route.params.id}},computed:{isLike:function(){return!!N.a.size(this.noteDetail.like)}},watch:{note:function(){this.noteDetail=this.note}},methods:{handleClickGoToList:function(){this.$emit("change-current-component",{component:"List"})},handleClickLike:function(){var t,e;if("closed"==(null===(t=this.details)||void 0===t||null===(e=t.courseSet)||void 0===e?void 0:e.status))return Object(w.a)("course");var s=this.noteDetail,n=s.id,i=s.likeNum,r={courseId:this.courseId,noteId:n},a=this.isLike?{like:{},likeNum:i-1}:{like:{status:1},likeNum:1*i+1};this.isLike?_.a.cancelNoteLike({query:r}):_.a.noteLike({query:r}),N.a.assign(this.noteDetail,a)}}},tt=(s("7659"),{name:"Notes",components:{List:K,Detail:Object(h.a)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"note-detail"},[s("div",{staticClass:"detail-header"},[s("van-icon",{attrs:{name:"cross",size:"18px",color:"#000"},on:{click:t.handleClickGoToList}}),s("h3",{staticClass:"detail-header__title"},[t._v(t._s(t.$t("courseLearning.noteDetails")))])],1),s("div",{staticClass:"note-body"},[s("div",{staticClass:"note-body__info"},[s("img",{staticClass:"avatar",attrs:{src:t.note.user.avatar.small}}),s("div",{staticClass:"info-right"},[s("span",[t._v(t._s(t.note.user.nickname))]),s("div",{staticClass:"info-right-bottom"},[s("div",{staticClass:"info"},[s("span",{staticClass:"info-time"},[t._v(t._s(t._f("formatCourseTime")(t.note.createdTime)))]),s("span",{staticClass:"info-task text-overflow"},[t._v(t._s(t.note.task.title))])]),s("span",{staticClass:"like-num",class:{like:t.isLike},on:{click:t.handleClickLike}},[s("i",{staticClass:"iconfont icon-like"}),t._v("\n            "+t._s(t.noteDetail.likeNum)+"\n          ")])])])]),s("div",{staticClass:"note-body__content",domProps:{innerHTML:t._s(t.note.content)}})])])}),[],!1,null,"3cc6be4e",null).exports},props:{details:{type:Object,default:function(){}}},data:function(){return{currentComponent:"List",currentNote:{}}},watch:{currentComponent:function(){this.$emit("chang-tabs-status","List"===this.currentComponent)}},methods:{changeCurrentComponent:function(t){var e=t.component,s=t.data;N.a.assign(this,{currentComponent:e,currentNote:s})}}}),et=Object(h.a)(tt,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"notes"},[e("keep-alive",[e(this.currentComponent,{tag:"component",attrs:{note:this.currentNote,details:this.details},on:{"change-current-component":this.changeCurrentComponent}})],1)],1)}),[],!1,null,null,null).exports,st={name:"ReviewItem",props:{item:{type:Object,required:!0}},data:function(){return{isOverflow:!0,isAllBtn:!1}},computed:{allConentBtnText:function(){return this.isOverflow?this.$t("courseLearning.showAll"):this.$t("courseLearning.collapse")},classObject:function(){return{overflow:this.isOverflow,mask:this.isAllBtn&&this.isOverflow}}},mounted:function(){this.checkOverFlow()},methods:{checkOverFlow:function(){var t=this.$refs.content;this.isAllBtn=t.scrollHeight>t.clientHeight},handleClickToggleOverflow:function(){this.isOverflow=!this.isOverflow}}};function nt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function it(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):nt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}s("8b9a");var rt={name:"ReviewsCreate",components:{ReviewItem:Object(h.a)(st,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"review-item"},[s("div",{staticClass:"user-avatar"},[s("img",{attrs:{src:t.item.user.avatar.small}})]),s("div",{staticClass:"review-detail"},[s("div",{staticClass:"review-detail__rate"},[s("div",{staticClass:"nickname"},[t._v(t._s(t.item.user.nickname))]),s("van-rate",{attrs:{value:1*t.item.rating,size:16,color:"#ffd21e","void-icon":"star","void-color":"#eee"}})],1),s("div",{staticClass:"review-detail__time"},[t._v(t._s(t._f("formatCourseTime")(t.item.createdTime)))]),s("div",{ref:"content",staticClass:"review-detail__content",class:t.classObject,domProps:{innerHTML:t._s(t.item.content)}}),t.isAllBtn?s("div",{staticClass:"all-content-btn",on:{click:t.handleClickToggleOverflow}},[t._v(t._s(t.allConentBtnText))]):t._e()])])}),[],!1,null,"8e39fbde",null).exports,Empty:A.a},props:{userReview:{type:Object,required:!0},details:{type:Object,default:function(){}},targetInfo:{type:Object,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,paging:{offset:0,limit:10}}},computed:{createReviewBtnText:function(){return N.a.size(this.userReview)?this.$t("courseLearning.reEvaluation"):this.$t("courseLearning.writeEvaluation")}},methods:{onLoad:function(){var t=this,e=this.paging,s=e.offset,n=e.limit;_.a.getReview({params:it(it({},this.targetInfo),{},{limit:n,offset:s*n})}).then((function(e){var s=e.data,n=e.paging.total;N.a.assign(t,{list:N.a.concat(t.list,s),loading:!1}),t.paging.offset++,N.a.size(t.list)>=n&&(t.finished=!0)}))},handleClickCreateDiscussion:function(){var t,e;if("closed"==(null===(t=this.details)||void 0===t||null===(e=t.courseSet)||void 0===e?void 0:e.status))return Object(w.a)("course");this.$emit("change-current-component",{component:"Create"})}}},at=(s("f54e"),Object(h.a)(rt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"reviews-list"},[s("van-list",{attrs:{finished:t.finished,"loading-text":t.$t("toast.loading")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t){return s("review-item",{key:t.id,attrs:{item:t}})})),1),!t.list.length&&t.finished?s("empty",{attrs:{text:t.$t("courseLearning.noContent")}}):t._e(),"closed"!=t.details.courseSet.status?s("div",{staticClass:"create-btn"},[s("van-button",{attrs:{type:"primary",block:""},on:{click:t.handleClickCreateDiscussion}},[t._v("\n      "+t._s(t.createReviewBtnText)+"\n    ")])],1):t._e()],1)}),[],!1,null,"76468528",null).exports);function ot(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function ct(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ot(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var ut={name:"ReviewCreate",components:{EDrag:s("f13d").a},props:{userReview:{type:Object,required:!0},targetInfo:{type:Object,required:!0}},data:function(){return{rating:1*this.userReview.rating||0,content:this.userReview.content||"",rateHasError:!1,showDrag:!1}},methods:{handleClickGoToList:function(){this.$emit("change-current-component",{component:"List"})},createReview:function(){var t=this;this.rateHasError=!this.rating,this.$refs.form.validate().then(Object(i.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.rateHasError){e.next=2;break}return e.abrupt("return");case 2:t.showDrag=!0;case 3:case"end":return e.stop()}}),e)}))))},handleSmsSuccess:function(t){var e=this;this.showDrag=!1,_.a.createReview({data:ct(ct({},this.targetInfo),{},{content:this.content,rating:this.rating,_dragCaptchaToken:t})}).then((function(t){e.$emit("change-current-component",{component:"List",data:t})}))}}};function lt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function dt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):lt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}s("ce0d");var pt={name:"Reviews",components:{List:at,Create:Object(h.a)(ut,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"review-create"},[s("div",{staticClass:"create-header"},[s("van-icon",{attrs:{name:"cross",size:"18px",color:"#000"},on:{click:t.handleClickGoToList}}),s("h3",{staticClass:"create-header__title"},[t._v(t._s(t.$t("courseLearning.evaluation")))]),s("span",{staticClass:"create-header__btn",on:{click:t.createReview}},[t._v(t._s(t.$t("courseLearning.publish")))])],1),s("van-form",{ref:"form"},[s("div",{staticClass:"review-create__rate"},[s("van-rate",{attrs:{size:24,color:"#ffd21e","void-icon":"star","void-color":"#eee"},model:{value:t.rating,callback:function(e){t.rating=e},expression:"rating"}}),t.rateHasError?s("p",{staticClass:"error-message"},[t._v(t._s(t.$t("courseLearning.scoring")))]):t._e()],1),s("div",{staticClass:"review-create__content"},[s("van-field",{attrs:{type:"textarea",rows:"3",error:!1,autosize:"",placeholder:t.$t("courseLearning.evaluationContent"),rules:[{required:!0,message:t.$t("courseLearning.inputEvaluationContent")}]},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)]),s("van-popup",{staticStyle:{width:"95%"},model:{value:t.showDrag,callback:function(e){t.showDrag=e},expression:"showDrag"}},[s("e-drag",{ref:"dragComponent",staticStyle:{width:"auto"},on:{success:t.handleSmsSuccess}})],1)],1)}),[],!1,null,"6c6e2840",null).exports},props:{details:{type:Object,required:!0}},data:function(){return{currentComponent:"List",userReview:{},courseId:this.$route.params.id}},computed:dt(dt({},Object(u.e)({user:function(t){return t.user}})),{},{targetInfo:function(){var t=this.details,e=t.classroom,s=t.goodsId;return{targetType:e?"course":"goods",targetId:e?this.courseId:s}}}),watch:{currentComponent:function(){this.$emit("chang-tabs-status","List"===this.currentComponent)}},created:function(){this.getUserReviews()},methods:{changeCurrentComponent:function(t){var e=t.component,s=t.data;N.a.assign(this,{currentComponent:e}),s&&(this.userReview=s)},getUserReviews:function(){var t=this;_.a.getReview({params:dt(dt({},this.targetInfo),{},{userId:this.user.id})}).then((function(e){var s=e.data;N.a.size(s)&&(t.userReview=s[0])}))}}},ht=Object(h.a)(pt,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"reviews"},[e(this.currentComponent,{tag:"component",attrs:{"user-review":this.userReview,"target-info":this.targetInfo,details:this.details},on:{"change-current-component":this.changeCurrentComponent}})],1)}),[],!1,null,null,null).exports;function ft(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function mt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ft(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var gt={catalogue:{name:"",type:"catalogue"},question:{name:"firstDiscussion",type:"question"},discussion:{name:"secondDiscussion",type:"discussion"},notes:{name:"Notes",type:"notes"},evaluation:{name:"Reviews",type:"reviews"}},vt={inheritAttrs:!0,components:{Directory:o.a,DetailHead:c.a,afterjoinDirectory:L,infoCollection:S.a,firstDiscussion:J,secondDiscussion:X,Notes:et,Reviews:ht,closedFixed:D.a},props:{details:{type:Object,value:function(){}}},data:function(){return{headBottom:0,active:0,scrollFlag:!1,tabs:["catalogue"],tabFixed:!1,errorMsg:"",offsetTop:"",offsetHeight:"",isFixed:!1,isShowForm:!1,paramsList:{action:"buy_after",targetType:"course",targetId:this.details.id},show:!1,show_course_review:this.$store.state.goods.show_course_review,assistantShow:!1,showTabs:!0,showDrainage:!1}},mixins:[$.a],computed:mt(mt(mt({},Object(u.e)("course",{selectedPlanId:function(t){return t.selectedPlanId},currentJoin:function(t){return t.currentJoin}})),Object(u.e)(["user","settingUgc"])),{},{progress:function(){return Number(this.details.publishedTaskNum)?parseInt(this.details.progress.percent)+"%":"0%"},isShowClosedFooter:function(){return"closed"==this.details.courseSet.status},summary:function(){return this.details.summary||this.details.courseSet.summary},isClassCourse:function(){return Number(this.details.parentId)},currentTypeText:function(){return this.details.classroom?"班级":"课程"},isWeixin:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},currentTabComponent:function(){var t=this.tabs,e=this.active;return gt[t[e]]}}),watch:{selectedPlanId:function(t,e){this.active=0},currentJoin:{handler:function(t,e){var s=this;t&&(a.a.loading({duration:0,message:"加载中...",forbidClick:!0}),this.getInfoCollectionEvent(this.paramsList).then((function(t){if(Object.keys(t).length)return s.userInfoCollect=t,void s.getInfoCollectionForm(t.id).then((function(t){s.isShowForm=!0,a.a.clear()}));a.a.clear()})))},immediate:!0},$route:function(t,e){this.resetFrom()},details:function(t,e){this.showDialog();var s=t.drainage;s&&"1"==s.enabled&&!localStorage.getItem("first_drainage")&&(this.showDrainage=!0,localStorage.setItem("first_drainage",1))}},mounted:function(){window.addEventListener("scroll",this.handleScroll),this.$nextTick((function(){var t=document.getElementById("course-detail__head").offsetHeight;this.offsetTop=t+46,this.offsetHeight=44}))},created:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showDialog(),t.initTabs();case 2:case"end":return e.stop()}}),e)})))()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)},methods:mt(mt({},Object(u.d)("course",{setCurrentJoin:C.s})),{},{initTabs:function(){var t=this.settingUgc,e=t.thread,s=t.note,n=t.review;e.course_question_enable&&this.tabs.push("question"),e.course_thread_enable&&this.tabs.push("discussion"),s.course_enable&&this.tabs.push("notes"),n.course_enable&&this.tabs.push("evaluation")},gotoGoodsPage:function(){this.details.goodsId&&this.$router.push({path:"/goods/".concat(this.details.goodsId,"/show"),query:{targetId:this.details.id}})},showDialog:function(){if(this.details.member){var t="";if(this.details.member.access&&(t=this.details.member.access.code),t&&"success"!==t){this.errorMsg=this.getErrorMsg(t);var e="",s=function(){};if("course.expired"===t||"member.expired"===t&&!this.isClassCourse){e="课程已到期，无法继续学习，是否退出";var n={id:this.details.id};return s=function(){_.a.deleteCourse({query:n}).then((function(t){t.success?window.location.reload():a.a.fail("退出课程失败，请稍后重试")}))},void this.callConfirm(e,s)}var i=this.details.vipLevel?this.details.vipLevel.name:"",r={"vip.member_expired":{message:"您的会员已到期，会员".concat(this.currentTypeText,"已无法学习，请续费会员，或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"续费会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.not_member":{message:"您不是".concat(i,"，请购买").concat(i,"后兑换该").concat(this.currentTypeText,"学习。或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"购买会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.level_low":{message:"您不是".concat(i,"，请购买").concat(i,"后兑换该").concat(this.currentTypeText,"学习。或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"购买会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.level_not_exist":{message:"您不是".concat(i,"，请购买").concat(i,"后兑换该").concat(this.currentTypeText,"学习。或退出后重新购买").concat(this.currentTypeText,"。"),confirmButtonText:"购买会员",cancelButtonText:"退出".concat(this.currentTypeText)},"vip.vip_right_not_exist":{message:"很抱歉，该".concat(this.currentTypeText,"已不属于会员权益，请退出后重新购买。"),showConfirmButton:!1,cancelButtonText:"退出".concat(this.currentTypeText)}};r[t]?this.vipCallConfirm(r[t]):a.a.fail(this.errorMsg)}}},getErrorMsg:function(t){switch(t){case"course.not_found":return"当前课程不存在";case"course.unpublished":return"当前课程未发布";case"course.expired":return"当前课程已过期";case"course.not_arrive":return"当前课程还不能学习";case"user.not_login":return"用户未登录";case"user.locked":return"用户被锁定";case"member.not_found":return"用户未加入课程";case"member.expired":return"课程已过期";case"vip.vip_closed":return"网校已关闭会员功能";case"vip.not_login":return"用户未登录";case"vip.not_member":return"当前用户并不是vip";case"vip.member_expired":return"用户会员服务已过期";case"vip.level_not_exist":return"用户会员等级或课程会员不存在";case"vip.level_low":return"用户会员等级过低";default:return"异常错误"}},callConfirm:function(t,e){n.a.confirm({message:t,title:""}).then((function(){e()})).catch((function(){}))},vipCallConfirm:function(t){this.show=!0,n.a.confirm(mt(mt({},t),{},{title:"",confirmButtonColor:"#1895E7",cancelButtonColor:"#FD4852",messageAlign:"left",overlay:!1,beforeClose:this.beforeClose}))},clickCloseOverlay:function(){this.show=!1,n.a.close()},beforeClose:function(t,e){if("confirm"===t)return this.$router.push({path:"/vip",query:{id:this.details.vipLevel.id}}),void e();this.show&&("班级"==this.currentTypeText?this.deleteClassroom(e):this.deleteCourse(e))},deleteClassroom:function(t){var e=this,s=this.details.classroom,n=s.id,i=s.goodsId,r={id:n};_.a.deleteClassroom({query:r}).then((function(s){s.success&&(e.$router.replace({path:"/goods/".concat(i,"/show"),query:{backUrl:"/"}}),t())}))},deleteCourse:function(t){var e=this,s=this.details,n=s.id,i=s.goodsId,r={id:n};_.a.deleteCourse({query:r}).then((function(s){s.success&&(e.$router.replace({path:"/goods/".concat(i,"/show"),query:{targetId:n}}),t())}))},handleScroll:function(){var t=document.getElementById("swiper-directory"),e=document.documentElement.scrollHeight,s=document.documentElement.clientHeight;(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)>this.offsetTop&&e-this.offsetTop>s?(this.tabFixed=!0,t&&t.classList.add("swiper-directory-fix")):(this.tabFixed=!1,t&&t.classList.remove("swiper-directory-fix"))},onCancelForm:function(){this.setCurrentJoin(!1),this.isShowForm=!1},showAssistant:function(){this.assistantShow=!0},changTabsStatus:function(t){this.showTabs=t}})};function bt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function yt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(s),!0).forEach((function(e){Object(r.a)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):bt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}s("5655");var Ct={components:{joinAfter:Object(h.a)(vt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"join-after"},[s("detail-head",{attrs:{"course-set":t.details.courseSet}}),s("van-tabs",{directives:[{name:"show",rawName:"v-show",value:t.showTabs,expression:"showTabs"}],staticClass:"tabs",class:t.tabFixed?"isFixed":"",attrs:{"title-active-color":"#408ffb","title-inactive-color":"#666"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e,attrs:{title:t.$t("courseLearning."+e)}})})),1),s("div",{staticClass:"join-after__content"},[s("keep-alive",[0==t.active?s("div",{staticStyle:{position:"relative"}},[s("div",{staticClass:"course-info py-12",on:{click:t.gotoGoodsPage}},[s("div",{staticClass:"course-info__left"},[s("div",{staticClass:"title",class:{"title--full":!t.details.goodsId}},[t._v(t._s(t.details.courseSet&&t.details.courseSet.title))]),s("div",{staticClass:"learning-progress mt-8",class:{"learning-progress--full":!t.details.goodsId}},[s("div",{staticClass:"learning-progress__bar",style:{width:t.progress}}),s("div",{staticClass:"learning-progress__text"},[t._v("\n                "+t._s(t.progress)+"\n              ")])])]),t.details.goodsId?s("van-icon",{attrs:{name:"arrow"}}):t._e()],1),t.details.drainage&&"1"==t.details.drainage.enabled?s("div",{staticClass:"drainage-btn",on:{click:function(e){t.showDrainage=!0}}},[s("i",{staticClass:"iconfont icon-drainage",staticStyle:{"margin-right":"4px"}}),t._v("\n          "+t._s(t.$t("courseLearning.teachingService"))+"\n        ")]):t._e(),t.details.assistant&&t.details.assistant.weChatQrCode?s("div",{staticClass:"assistant"},[s("div",{staticClass:"assistant-btn",on:{click:t.showAssistant}},[s("div",{staticClass:"assistant-btn__text"},[s("i",{staticClass:"iconfont icon-weixin1"}),t._v("\n              "+t._s(t.$t("courseLearning.addTeachingAssistantWeChat"))+"\n            ")]),s("van-icon",{staticClass:"arrow-icon",attrs:{name:"arrow"}})],1),s("van-popup",{staticClass:"assistant-info",attrs:{position:"bottom",closeable:"",round:""},model:{value:t.assistantShow,callback:function(e){t.assistantShow=e},expression:"assistantShow"}},[s("img",{staticClass:"avatar",attrs:{src:t.details.assistant.avatar.middle,alt:t.$t("courseLearning.picture")}}),s("p",{staticClass:"nickname"},[t._v(t._s(t.details.assistant.nickname))]),s("p",{staticClass:"desc"},[t._v(t._s(t.$t("courseLearning.addTheTeachingAssistant")))]),s("img",{staticClass:"wechat",attrs:{src:t.details.assistant.weChatQrCode,alt:t.$t("courseLearning.qRCodePicture")}}),t.isWeixin?s("div",{staticClass:"tips"},[t._v(t._s(t.$t("courseLearning.longPressThePicture")))]):s("div",{staticClass:"tips"},[t._v(t._s(t.$t("courseLearning.longPressThePicture2")))])])],1):t._e(),s("afterjoin-directory",{attrs:{"error-msg":t.errorMsg,"course-set":t.details.courseSet},on:{showDialog:t.showDialog}}),t.isShowClosedFooter?s("div",{staticClass:"white-space"}):t._e()],1):s(t.currentTabComponent.name,{tag:"component",attrs:{type:t.currentTabComponent.type,details:t.details},on:{"chang-tabs-status":t.changTabsStatus}})],1)],1),s("van-action-sheet",{staticClass:"minHeight50",attrs:{title:t.userInfoCollectForm.formTitle,"close-on-click-overlay":!1,"safe-area-inset-bottom":!0},on:{cancel:t.onCancelForm},model:{value:t.isShowForm,callback:function(e){t.isShowForm=e},expression:"isShowForm"}},[s("info-collection",{attrs:{userInfoCollectForm:t.userInfoCollectForm,formRule:t.userInfoCollectForm.items},on:{submitForm:t.onCancelForm}})],1),s("van-overlay",{attrs:{show:t.show,"z-index":"1000"},on:{click:t.clickCloseOverlay}}),t.details.drainage&&"1"==t.details.drainage.enabled?s("van-popup",{staticClass:"drainage-popup",attrs:{round:"",closeable:"",position:"bottom"},model:{value:t.showDrainage,callback:function(e){t.showDrainage=e},expression:"showDrainage"}},[s("div",{staticClass:"drainage-popup__title"},[t._v(t._s(t.details.drainage.text))]),s("div",{staticClass:"drainage-popup__img"},[s("img",{attrs:{src:t.details.drainage.image,alt:""}})]),s("van-button",{staticClass:"drainage-popup__btn",attrs:{type:"primary",block:""}},[t._v("\n      "+t._s(t.isWeixin?t.$t("courseLearning.longPressThePicture"):t.$t("courseLearning.longPressThePicture2"))+"\n    ")])],1):t._e(),s("div",{staticClass:"footer"},[t.isShowClosedFooter?s("closedFixed",{attrs:{isJoin:!0,title:t.$t("closed.courseTitle"),content:t.$t("closed.courseContent")}}):t._e()],1)],1)}),[],!1,null,"4ea2aa78",null).exports},computed:yt(yt({},Object(u.e)("course",{details:function(t){return t.details}})),Object(u.e)({isLoading:function(t){return t.isLoading}})),provide:function(){return{getDetailsContent:this.getData}},watch:{$route:function(t,e){this.getData()}},created:function(){this.getData()},methods:yt(yt(yt({},Object(u.c)("course",["getCourseLessons"])),Object(u.d)("course",{setSourceType:C.A})),{},{getData:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCourseLessons({courseId:t.$route.params.id}).then((function(e){e.member||Number(t.details.parentId)||t.$router.push({path:"/goods/".concat(e.goodsId,"/show")}),e.contract&&0==e.member.isContractSigned&&t.signContractConfirm(e)}));case 2:case"end":return e.stop()}}),e)})))()},signContractConfirm:function(t){var e=t.contract,s=e.contractId,i=e.goodsKey,r=e.contractName;n.a.confirm({title:"签署电子合同",message:"开始学习前请签署《".concat(r,"》，以确保正常享受后续服务"),confirmButtonText:"去签署"}).then((function(){window.location.href="/contract_sign/mobile#/sign_contract/".concat(s,"/").concat(i)}))},getJoinAfter:function(){var t=this;this.getJoinAfterDetail({courseId:this.$route.params.id}).catch((function(e){t.$toast.fail(e.message)}))}}),beforeRouteEnter:function(t,e,s){("course"===t.name&&"testpaperResult"===e.name||"course"===t.name&&"testpaperIntro"===e.name)&&window.location.reload(),s()},beforeRouteLeave:function(t,e,s){this.setSourceType({sourceType:"img",taskId:0}),s()}},_t=Object(h.a)(Ct,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"course-detail"},[this.isLoading?e("e-loading"):this._e(),e("join-after",{attrs:{details:this.details}})],1)}),[],!1,null,null,null);e.default=_t.exports}}]);