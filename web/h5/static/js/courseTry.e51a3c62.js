(window.webpackJsonp=window.webpackJsonp||[]).push([["courseTry"],{"07b4":function(e,t,i){"use strict";i("8e6e"),i("ac6a"),i("456d"),i("e7e5");var n=i("d399"),s=i("bd86"),r=i("3ce7"),a=i("2164"),o=i("2f62"),c=i("faa5");function u(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?u(Object(i),!0).forEach((function(t){Object(s.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var d={name:"finish-dialog",mixins:[a.a],inject:["reload"],data:function(){return{show:!0,path:""}},props:{finishResult:{type:Object,default:function(){return{}}},courseId:{type:String,default:""}},computed:l(l({},Object(o.e)("course",{allTask:function(e){return e.allTask}})),{},{rate:function(){return this.finishResult?"".concat(parseInt(this.finishResult.completionRate),"%"):"0%"},title:function(){return this.finishResult?this.allTask[this.finishResult.result.courseTaskId].title:""}}),created:function(){this.path=this.$route.path},methods:l(l({},Object(o.d)("course",{setSourceType:c.A})),{},{goNextTask:function(){var e=this;if(!this.finishResult.nextTask)return Object(n.a)("没有下一课"),void(this.show=!1);var t={courseId:this.courseId,taskId:this.finishResult.nextTask.id};r.a.getCourseData({query:t}).then((function(t){e.toLearnTask(t)}))},toLearnTask:function(e){if("create"!==e.status){var t={id:e.id};this.$store.commit("course/".concat(c.i),{nextTask:t}),this.showTypeDetail(e),this.show=!1,this.setSourceType({sourceType:"img",taskId:e.id})}else Object(n.a)("课时创建中，敬请期待")},showTypeDetail:function(e){if("published"===e.status)switch(e.type){case"video":this.playVedio(e);break;case"audio":this.playAudio(e);break;case"text":case"ppt":case"doc":this.$router.push({name:"course_web",query:{courseId:this.courseId,taskId:e.id,type:e.type,backUrl:"/course/".concat(this.courseId)}}),this.reload();break;case"live":var t=!1;if(new Date>new Date(1e3*e.endTime)){if(e.activity&&"videoGenerated"===e.activity.replayStatus)return void("self"===e.mediaSource?this.setSourceType({sourceType:"video",taskId:e.id}):this.copyPcUrl(e.courseUrl));if(e.activity&&"ungenerated"===e.activity.replayStatus)return void Object(n.a)("暂无回放");t=!0}this.$router.push({name:"live",query:{courseId:this.courseId,taskId:e.id,type:e.type,title:e.title,replay:t}});break;case"testpaper":var i=e.activity.testpaperInfo.testpaperId;this.$router.push({name:"testpaperIntro",query:{testId:i,targetId:e.id}});break;case"homework":this.$router.push({name:"homeworkIntro",query:{courseId:this.courseId,taskId:e.id}});break;case"exercise":this.$router.push({name:"exerciseIntro",query:{courseId:this.courseId,taskId:e.id}});break;default:this.copyPcUrl(e.courseUrl)}else Object(n.a)("敬请期待")},playVedio:function(e){if("self"===e.mediaSource){var t="/course/".concat(this.courseId);this.$route.path===t?this.setSourceType({sourceType:"video",taskId:e.id}):this.$router.push({path:t,query:{sourceType:"video",taskId:e.id}})}else this.copyPcUrl(e.courseUrl)},playAudio:function(e){var t="/course/".concat(this.courseId);this.$route.path===t?this.setSourceType({sourceType:"audio",taskId:e.id}):this.$router.push({path:t,query:{sourceType:"audio",taskId:e.id}})},closeFinishDialog:function(){this.show=!1,this.$emit("closeFinishDialog")}})},p=i("0c7c"),h=Object(p.a)(d,(function(){var e=this,t=e._self._c;return t("van-overlay",{attrs:{show:e.show,"z-index":9999}},[t("div",{staticClass:"finish-dialog"},[t("div",{staticClass:"finish-dialog-content clearfix"},[t("div",{staticClass:"finish-dialog-top"},[t("img",{staticClass:"finish-dialog-img",attrs:{src:"static/images/reportDialog.png"}}),t("div",{staticClass:"finish-dialog-top--text"},[e._v(e._s(e.$t("courseLearning.learningCompletion")))])]),t("div",{staticClass:"finish-dialog-close",on:{click:e.closeFinishDialog}},[t("i",{staticClass:"iconfont icon-guanbi"})]),t("div",{staticClass:"progress-bar"},[t("div",{staticClass:"progress-bar__content"},[t("div",{staticClass:"progress-bar__rate",style:{width:e.rate}})]),t("div",{staticClass:"progress-bar__text"},[e._v(e._s(e.rate))])]),t("p",{staticClass:"finish-dialog-text"},[e._v(e._s(e.$t("courseLearning.congratulationsOnCompletion")))]),[t("p",{staticClass:"text-overflow"},[e._v(e._s(e.title))]),t("div",{staticClass:"finish-dialog-btn",on:{click:e.goNextTask}},[e._v(e._s(e.$t("courseLearning.nextLesson")))])]],2)])])}),[],!1,null,null,null);t.a=h.exports},"18a0":function(e,t){var i;i="object"==typeof window&&window,e.exports=function(e,t){var i,n,s,r,a,o,c,u,l,d,p,h,f,m,g,v,y,b,k,T,w,I;if(e)return e.jWeixin?e.jWeixin:(i={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress"},n=function(){var e,t={};for(e in i)t[i[e]]=e;return t}(),s=e.document,r=s.title,a=navigator.userAgent.toLowerCase(),h=navigator.platform.toLowerCase(),o=!(!h.match("mac")&&!h.match("win")),c=-1!=a.indexOf("wxdebugger"),u=-1!=a.indexOf("micromessenger"),l=-1!=a.indexOf("android"),d=-1!=a.indexOf("iphone")||-1!=a.indexOf("ipad"),p=(h=a.match(/micromessenger\/(\d+\.\d+\.\d+)/)||a.match(/micromessenger\/(\d+\.\d+)/))?h[1]:"",f={initStartTime:j(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},m={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:d?1:l?2:-1,clientVersion:p,url:encodeURIComponent(location.href)},g={},v={_completes:[]},y={state:0,data:{}},R((function(){f.initEndTime=j()})),b=!1,k=[],T={config:function(t){D("config",g=t);var n=!1!==g.check;R((function(){if(n)S(i.config,{verifyJsApiList:P(g.jsApiList),verifyOpenTagList:P(g.openTagList)},(v._complete=function(e){f.preVerifyEndTime=j(),y.state=1,y.data=e},v.success=function(e){m.isPreVerifyOk=0},v.fail=function(e){v._fail?v._fail(e):y.state=-1},(r=v._completes).push((function(){L()})),v.complete=function(e){for(var t=0,i=r.length;t<i;++t)r[t]();v._completes=[]},v)),f.preVerifyStartTime=j();else{y.state=1;for(var e=v._completes,t=0,s=e.length;t<s;++t)e[t]();v._completes=[]}var r})),T.invoke||(T.invoke=function(t,i,n){e.WeixinJSBridge&&WeixinJSBridge.invoke(t,C(i),n)},T.on=function(t,i){e.WeixinJSBridge&&WeixinJSBridge.on(t,i)})},ready:function(e){(0!=y.state||(v._completes.push(e),!u&&g.debug))&&e()},error:function(e){p<"6.0.2"||(-1==y.state?e(y.data):v._fail=e)},checkJsApi:function(e){S("checkJsApi",{jsApiList:P(e.jsApiList)},(e._complete=function(e){l&&(i=e.checkResult)&&(e.checkResult=JSON.parse(i));var t,i=e,s=i.checkResult;for(t in s){var r=n[t];r&&(s[r]=s[t],delete s[t])}},e))},onMenuShareTimeline:function(e){_(i.onMenuShareTimeline,{complete:function(){S("shareTimeline",{title:e.title||r,desc:e.title||r,img_url:e.imgUrl||"",link:e.link||location.href,type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareAppMessage:function(e){_(i.onMenuShareAppMessage,{complete:function(t){"favorite"===t.scene?S("sendAppMessage",{title:e.title||r,desc:e.desc||"",link:e.link||location.href,img_url:e.imgUrl||"",type:e.type||"link",data_url:e.dataUrl||""}):S("sendAppMessage",{title:e.title||r,desc:e.desc||"",link:e.link||location.href,img_url:e.imgUrl||"",type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareQQ:function(e){_(i.onMenuShareQQ,{complete:function(){S("shareQQ",{title:e.title||r,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareWeibo:function(e){_(i.onMenuShareWeibo,{complete:function(){S("shareWeiboApp",{title:e.title||r,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareQZone:function(e){_(i.onMenuShareQZone,{complete:function(){S("shareQZone",{title:e.title||r,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},updateTimelineShareData:function(e){S("updateTimelineShareData",{title:e.title,link:e.link,imgUrl:e.imgUrl},e)},updateAppMessageShareData:function(e){S("updateAppMessageShareData",{title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl},e)},startRecord:function(e){S("startRecord",{},e)},stopRecord:function(e){S("stopRecord",{},e)},onVoiceRecordEnd:function(e){_("onVoiceRecordEnd",e)},playVoice:function(e){S("playVoice",{localId:e.localId},e)},pauseVoice:function(e){S("pauseVoice",{localId:e.localId},e)},stopVoice:function(e){S("stopVoice",{localId:e.localId},e)},onVoicePlayEnd:function(e){_("onVoicePlayEnd",e)},uploadVoice:function(e){S("uploadVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadVoice:function(e){S("downloadVoice",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},translateVoice:function(e){S("translateVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},chooseImage:function(e){S("chooseImage",{scene:"1|2",count:e.count||9,sizeType:e.sizeType||["original","compressed"],sourceType:e.sourceType||["album","camera"]},(e._complete=function(e){if(l){var t=e.localIds;try{t&&(e.localIds=JSON.parse(t))}catch(e){}}},e))},getLocation:function(e){e=e||{},S(i.getLocation,{type:e.type||"wgs84"},(e._complete=function(e){delete e.type},e))},previewImage:function(e){S(i.previewImage,{current:e.current,urls:e.urls},e)},uploadImage:function(e){S("uploadImage",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadImage:function(e){S("downloadImage",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},getLocalImgData:function(e){!1===b?(b=!0,S("getLocalImgData",{localId:e.localId},(e._complete=function(e){var t;b=!1,0<k.length&&(t=k.shift(),wx.getLocalImgData(t))},e))):k.push(e)},getNetworkType:function(e){S("getNetworkType",{},(e._complete=function(e){var t=e,i=(e=t.errMsg,t.errMsg="getNetworkType:ok",t.subtype);if(delete t.subtype,i)t.networkType=i;else{i=e.indexOf(":");var n=e.substring(i+1);switch(n){case"wifi":case"edge":case"wwan":t.networkType=n;break;default:t.errMsg="getNetworkType:fail"}}},e))},openLocation:function(e){S("openLocation",{latitude:e.latitude,longitude:e.longitude,name:e.name||"",address:e.address||"",scale:e.scale||28,infoUrl:e.infoUrl||""},e)},hideOptionMenu:function(e){S("hideOptionMenu",{},e)},showOptionMenu:function(e){S("showOptionMenu",{},e)},closeWindow:function(e){S("closeWindow",{},e=e||{})},hideMenuItems:function(e){S("hideMenuItems",{menuList:e.menuList},e)},showMenuItems:function(e){S("showMenuItems",{menuList:e.menuList},e)},hideAllNonBaseMenuItem:function(e){S("hideAllNonBaseMenuItem",{},e)},showAllNonBaseMenuItem:function(e){S("showAllNonBaseMenuItem",{},e)},scanQRCode:function(e){S("scanQRCode",{needResult:(e=e||{}).needResult||0,scanType:e.scanType||["qrCode","barCode"]},(e._complete=function(e){var t;d&&(t=e.resultStr)&&(t=JSON.parse(t),e.resultStr=t&&t.scan_code&&t.scan_code.scan_result)},e))},openAddress:function(e){S(i.openAddress,{},(e._complete=function(e){(e=e).postalCode=e.addressPostalCode,delete e.addressPostalCode,e.provinceName=e.proviceFirstStageName,delete e.proviceFirstStageName,e.cityName=e.addressCitySecondStageName,delete e.addressCitySecondStageName,e.countryName=e.addressCountiesThirdStageName,delete e.addressCountiesThirdStageName,e.detailInfo=e.addressDetailInfo,delete e.addressDetailInfo},e))},openProductSpecificView:function(e){S(i.openProductSpecificView,{pid:e.productId,view_type:e.viewType||0,ext_info:e.extInfo},e)},addCard:function(e){for(var t=e.cardList,n=[],s=0,r=t.length;s<r;++s){var a=t[s];a={card_id:a.cardId,card_ext:a.cardExt};n.push(a)}S(i.addCard,{card_list:n},(e._complete=function(e){if(t=e.card_list){for(var t,i=0,n=(t=JSON.parse(t)).length;i<n;++i){var s=t[i];s.cardId=s.card_id,s.cardExt=s.card_ext,s.isSuccess=!!s.is_succ,delete s.card_id,delete s.card_ext,delete s.is_succ}e.cardList=t,delete e.card_list}},e))},chooseCard:function(e){S("chooseCard",{app_id:g.appId,location_id:e.shopId||"",sign_type:e.signType||"SHA1",card_id:e.cardId||"",card_type:e.cardType||"",card_sign:e.cardSign,time_stamp:e.timestamp+"",nonce_str:e.nonceStr},(e._complete=function(e){e.cardList=e.choose_card_info,delete e.choose_card_info},e))},openCard:function(e){for(var t=e.cardList,n=[],s=0,r=t.length;s<r;++s){var a=t[s];a={card_id:a.cardId,code:a.code};n.push(a)}S(i.openCard,{card_list:n},e)},consumeAndShareCard:function(e){S(i.consumeAndShareCard,{consumedCardId:e.cardId,consumedCode:e.code},e)},chooseWXPay:function(e){S(i.chooseWXPay,O(e),e),L({jsApiName:"chooseWXPay"})},openEnterpriseRedPacket:function(e){S(i.openEnterpriseRedPacket,O(e),e)},startSearchBeacons:function(e){S(i.startSearchBeacons,{ticket:e.ticket},e)},stopSearchBeacons:function(e){S(i.stopSearchBeacons,{},e)},onSearchBeacons:function(e){_(i.onSearchBeacons,e)},openEnterpriseChat:function(e){S("openEnterpriseChat",{useridlist:e.userIds,chatname:e.groupName},e)},launchMiniProgram:function(e){S("launchMiniProgram",{targetAppId:e.targetAppId,path:function(e){var t;if("string"==typeof e&&0<e.length)return t=e.split("?")[0],t+=".html",void 0!==(e=e.split("?")[1])?t+"?"+e:t}(e.path),envVersion:e.envVersion},e)},openBusinessView:function(e){S("openBusinessView",{businessType:e.businessType,queryString:e.queryString||"",envVersion:e.envVersion},(e._complete=function(e){if(l){var t=e.extraData;if(t)try{e.extraData=JSON.parse(t)}catch(t){e.extraData={}}}},e))},miniProgram:{navigateBack:function(e){e=e||{},R((function(){S("invokeMiniProgramAPI",{name:"navigateBack",arg:{delta:e.delta||1}},e)}))},navigateTo:function(e){R((function(){S("invokeMiniProgramAPI",{name:"navigateTo",arg:{url:e.url}},e)}))},redirectTo:function(e){R((function(){S("invokeMiniProgramAPI",{name:"redirectTo",arg:{url:e.url}},e)}))},switchTab:function(e){R((function(){S("invokeMiniProgramAPI",{name:"switchTab",arg:{url:e.url}},e)}))},reLaunch:function(e){R((function(){S("invokeMiniProgramAPI",{name:"reLaunch",arg:{url:e.url}},e)}))},postMessage:function(e){R((function(){S("invokeMiniProgramAPI",{name:"postMessage",arg:e.data||{}},e)}))},getEnv:function(t){R((function(){t({miniprogram:"miniprogram"===e.__wxjs_environment})}))}}},w=1,I={},s.addEventListener("error",(function(e){var t,i,n;l||(n=(t=e.target).tagName,i=t.src,"IMG"!=n&&"VIDEO"!=n&&"AUDIO"!=n&&"SOURCE"!=n)||-1!=i.indexOf("wxlocalresource://")&&(e.preventDefault(),e.stopPropagation(),(n=t["wx-id"])||(n=w++,t["wx-id"]=n),I[n]||(I[n]=!0,wx.ready((function(){wx.getLocalImgData({localId:i,success:function(e){t.src=e.localData}})}))))}),!0),s.addEventListener("load",(function(e){var t;l||(t=(e=e.target).tagName,e.src,"IMG"!=t&&"VIDEO"!=t&&"AUDIO"!=t&&"SOURCE"!=t)||(t=e["wx-id"])&&(I[t]=!1)}),!0),t&&(e.wx=e.jWeixin=T),T);function S(t,i,n){e.WeixinJSBridge?WeixinJSBridge.invoke(t,C(i),(function(e){x(t,e,n)})):D(t,n)}function _(t,i,n){e.WeixinJSBridge?WeixinJSBridge.on(t,(function(e){n&&n.trigger&&n.trigger(e),x(t,e,i)})):D(t,n||i)}function C(e){return(e=e||{}).appId=g.appId,e.verifyAppId=g.appId,e.verifySignType="sha1",e.verifyTimestamp=g.timestamp+"",e.verifyNonceStr=g.nonceStr,e.verifySignature=g.signature,e}function O(e){return{timeStamp:e.timestamp+"",nonceStr:e.nonceStr,package:e.package,paySign:e.paySign,signType:e.signType||"SHA1"}}function x(e,t,i){"openEnterpriseChat"!=e&&"openBusinessView"!==e||(t.errCode=t.err_code),delete t.err_code,delete t.err_desc,delete t.err_detail;var s=t.errMsg;s||(s=t.err_msg,delete t.err_msg,s=function(e,t){var i,s=n[e];return s&&(e=s),s="ok",t&&(i=t.indexOf(":"),"access denied"!=(s=(s=(s=-1!=(s=-1!=(s="failed"==(s="confirm"==(s=t.substring(i+1))?"ok":s)?"fail":s).indexOf("failed_")?s.substring(7):s).indexOf("fail_")?s.substring(5):s).replace(/_/g," ")).toLowerCase())&&"no permission to execute"!=s||(s="permission denied"),""==(s="config"==e&&"function not exist"==s?"ok":s))&&(s="fail"),e+":"+s}(e,s),t.errMsg=s),(i=i||{})._complete&&(i._complete(t),delete i._complete),s=t.errMsg||"",g.debug&&!i.isInnerInvoke&&alert(JSON.stringify(t)),e=s.indexOf(":");switch(s.substring(e+1)){case"ok":i.success&&i.success(t);break;case"cancel":i.cancel&&i.cancel(t);break;default:i.fail&&i.fail(t)}i.complete&&i.complete(t)}function P(e){if(e){for(var t=0,n=e.length;t<n;++t){var s=e[t];s=i[s];s&&(e[t]=s)}return e}}function D(e,t){var i;!g.debug||t&&t.isInnerInvoke||((i=n[e])&&(e=i),t&&t._complete&&delete t._complete)}function L(e){var t;o||c||g.debug||p<"6.0.2"||m.systemType<0||(t=new Image,m.appId=g.appId,m.initTime=f.initEndTime-f.initStartTime,m.preVerifyTime=f.preVerifyEndTime-f.preVerifyStartTime,T.getNetworkType({isInnerInvoke:!0,success:function(i){m.networkType=i.networkType,i="https://open.weixin.qq.com/sdk/report?v="+m.version+"&o="+m.isPreVerifyOk+"&s="+m.systemType+"&c="+m.clientVersion+"&a="+m.appId+"&n="+m.networkType+"&i="+m.initTime+"&p="+m.preVerifyTime+"&u="+m.url+"&jsapi_name="+(e?e.jsApiName:""),t.src=i}}))}function j(){return(new Date).getTime()}function R(t){u&&(e.WeixinJSBridge?t():s.addEventListener&&s.addEventListener("WeixinJSBridgeReady",t,!1))}}(i)},"202a":function(e,t,i){"use strict";i("6762"),i("2fdb"),i("8e6e"),i("ac6a"),i("456d"),i("4917"),i("e17f");var n=i("2241"),s=(i("e7e5"),i("d399")),r=(i("c5f6"),i("96cf"),i("3b8d")),a=(i("7f7f"),i("bd86")),o=i("32e6"),c=i.n(o),u=i("2f62"),l=i("3ce7"),d=i("fd23"),p=i("bced"),h=i("07b4"),f=i("4328"),m=i.n(f),g=i("c8a5"),v={props:{type:{type:String,default:""},isShow:{type:Boolean,default:!1},reportType:{type:String,default:""}},methods:{onKeepLearning:function(e){this.$emit("outFocusMask",e)}}},y=i("0c7c"),b=Object(y.a)(v,(function(){var e=this,t=e._self._c;return e.isShow?t("div",{staticClass:"video-report-mask"},["ineffective_learning"===e.type&&"video"===e.reportType?[t("div",{staticClass:"content"},[e._m(0),t("van-button",{attrs:{color:"#43bc60",size:"small"},on:{click:function(t){return e.onKeepLearning("ineffective_learning")}}},[e._v("\n        继续学习\n      ")])],1)]:e._e(),"kick_previous"===e.type?[t("div",{staticClass:"content"},[e._m(1),t("van-button",{attrs:{color:"#43bc60",size:"small"},on:{click:function(t){return e.onKeepLearning("kick_previous")}}},[e._v("\n        继续学习\n      ")])],1)]:e._e(),"reject_current"===e.type?[e._m(2)]:e._e()],2):e._e()}),[function(){var e=this._self._c;return e("div",{staticClass:"tips"},[e("p",{staticClass:"ineffective-learning"},[this._v("学累了可以休息一会 :D")])])},function(){var e=this._self._c;return e("div",{staticClass:"tips"},[e("p",{staticClass:"kick-each-other"},[this._v("请勿同时多开任务学习")]),e("p",{staticClass:"kick-each-other"},[this._v("不要一心多用哦！")])])},function(){var e=this._self._c;return e("div",{staticClass:"content"},[e("div",{staticClass:"tips"},[e("p",{staticClass:"kick-each-other"},[this._v("请勿同时多开任务学习")]),e("p",{staticClass:"kick-each-other"},[this._v("不要一心多用哦！")])])])}],!1,null,null,null).exports,k=(i("28a5"),i("18a0")),T=i.n(k),w=/accept/,I={name:"WechatSubscribe",data:function(){return{templateId:"",isWechatSubscribe:!1,firstGuide:!1,secondGuide:!1,isSubscribe:!1}},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isWeixin()){t.next=2;break}return t.abrupt("return");case 2:return e.isKeyLocalStorage("WECHAT_SUBSCRIBE_FIRST_GUIDE")||(e.firstGuide=!0),t.next=5,l.a.wechatSubscribe();case 5:if(i=t.sent,i.enable){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,l.a.wechatTemplate();case 11:if(e.templateId=t.sent,e.templateId){t.next=14;break}return t.abrupt("return");case 14:e.$nextTick((function(t){e.initSubscribe()}));case 15:case"end":return t.stop()}}),t)})))()},methods:{initSubscribe:function(){var e=this,t={url:window.location.href.split("#")[0]};l.a.wechatJsSdkConfig({params:t}).then((function(t){T.a.config({debug:!1,appId:t.appId,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:t.jsApiList,openTagList:["wx-open-subscribe"]}),T.a.ready((function(){e.isWechatSubscribe=!0}))}))},success:function(e){this.firstGuide=!1;var t=e.detail.subscribeDetails;w.test(t)&&(this.isSubscribe=!0,this.$toast(this.$t("courseLearning.subscriptionSucceeded")))},subError:function(e){},isWeixin:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},isKeyLocalStorage:function(e){return!!localStorage.getItem(e)||(localStorage.setItem(e,!0),!1)}}},S=Object(y.a)(I,(function(){var e=this,t=e._self._c;return e.isWechatSubscribe?t("div",{staticClass:"wechat-subscribe"},[e.firstGuide?t("div",{staticClass:"wechat-subscribe-first-guide"},[e._v("\n    "+e._s(e.$t("courseLearning.pleaseClickSubscribe"))+"\n  ")]):e._e(),t("i",{class:["iconfont",e.isSubscribe?"icon-subscribed":"icon-subscribe"]}),t("wx-open-subscribe",{attrs:{template:e.templateId,id:"subscribe-btn"},on:{success:e.success,error:e.subError}},[t("script",{attrs:{slot:"style",type:"text/wxtag-template"},slot:"style"},[e._v("\n      <style>\n        .subscribe-btn {\n          display: inline-block;\n          min-width: 30px;\n          color: #fff;\n          font-size: 14px;\n        }\n      </style>\n    ")]),t("script",{attrs:{type:"text/wxtag-template"}},[e._v('\n      <span class="subscribe-btn">\n        '+e._s(e.$t("courseLearning.subscribe"))+"\n      </span>\n    ")])])],1):e._e()}),[],!1,null,null,null).exports,_=i("faa5"),C=i("2164"),O=i("6647"),x=i("a556");function P(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function D(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?P(Object(i),!0).forEach((function(t){Object(a.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):P(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var L={components:{countDown:d.a,tagLink:p.a,finishDialog:h.a,VideoReportMask:b,WechatSubscribe:S},mixins:[g.a,C.a],props:{courseSet:{type:Object,default:function(){return{}}},seckillActivities:{type:Object,default:null}},data:function(){return{finishCondition:void 0,learnMode:!1,enableFinish:!1,isEncryptionPlus:!1,isCoverOpen:!1,isPlaying:!1,player:null,counting:!0,isEmpty:!1,textContent:null,tagData:{earnings:0,isShow:!1,link:"",className:"course-tag",minDirectRewardRatio:0},timeChangingList:[],bindAgencyRelation:{},finishResult:null,finishDialog:!1,lastWatchTime:0,nowWatchTime:0,activity:{}}},inject:["getDetailsContent"],computed:D(D(D({},Object(u.e)(["DrpSwitch","cloudSdkCdn"])),Object(u.e)("course",{course:function(e){return e},sourceType:function(e){return e.sourceType},selectedPlanId:function(e){return e.selectedPlanId},taskId:function(e){return e.taskId},details:function(e){return e.details},joinStatus:function(e){return e.joinStatus},user:function(e){var t;return(null===(t=e.joinStatus)||void 0===t?void 0:t.user)||{}},allTask:function(e){return e.allTask},nextStudy:function(e){return e.nextStudy}})),{},{showLearnBtn:function(){return this.joinStatus&&["video","audio","ppt"].includes(this.sourceType)},continueLearningText:function(){var e=this.nextStudy,t=e.nextTask,i=e.progress;return t&&0==i?this.$t("courseLearning.startLearning"):this.$t("courseLearning.continueLearning")}}),watch:{taskId:function(e,t){("course"!==this.$route.name||this.joinStatus)&&e>0&&this.initHead()},selectedPlanId:function(e){("course"!==this.$route.name||this.joinStatus)&&e>0&&this.initHead()}},created:function(){this.initHead(),this.showTagLink()},beforeDestroy:function(){this.sign.length>0&&localStorage.setItem("flowSign",this.sign),this.player&&this.player.destory&&this.player.destory(),this.clearComputeWatchTime()},methods:D(D(D({},Object(u.c)(["setCloudAddress"])),Object(u.d)("course",{setSourceType:_.A})),{},{toToast:function(){var e=this.finishCondition;if(e){var t="";if(["time","watchTime"].includes(e.type)){var i=Math.ceil((60*e.data-this.learnedTime)/60);t=i>0?"\n剩余 ".concat(i," 分完成"):"\n恭喜！你已完成该任务"}this.$toast({message:"完成条件：".concat(e.text).concat(t),position:"bottom"})}},initHead:function(){["video","audio","ppt"].includes(this.sourceType)&&(window.scrollTo(0,0),this.joinStatus&&(this.initReport(),this.clearComputeWatchTime(),this.lastWatchTime=0,this.nowWatchTime=0),this.initData())},initReport:function(){this.finishDialog=!1,this.getFinishCondition(),this.IsLivePlayback()},getFinishCondition:function(){var e=this;this.getCourseData(this.selectedPlanId,this.taskId).then((function(t){e.activity=t.activity,e.finishCondition=t.activity&&t.activity.finishCondition}))},IsLivePlayback:function(){"live"===this.allTask[this.taskId].type&&this.reprtData({eventName:"finish"})},viewAudioDoc:function(){this.isCoverOpen=!0},hideAudioDoc:function(){this.isCoverOpen=!1},handlePlayer:function(){return this.isPlaying?this.player&&this.player.pause():this.player&&this.player.play()},getParams:function(){return this.joinStatus?{query:{courseId:this.selectedPlanId,taskId:this.taskId},params:{version:"escloud"}}:{query:{courseId:this.selectedPlanId,taskId:this.taskId},params:{preview:1,version:"escloud"}}},initData:function(){this.isShowOutFocusMask=!1,this.sign.length>0&&(localStorage.setItem("flowSign",this.sign),this.sign=""),this.$refs.video&&(this.$refs.video.innerHTML=""),this.enableFinish=!!parseInt(this.details.enableFinish),this.player&&this.player.destory&&this.player.destory(),this.getData()},getData:function(){var e=this;l.a.getMedia(this.getParams()).then(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(i){var n,s,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.media.resNo,s=i.mediaType,"0"!==n){t.next=7;break}return t.next=4,l.a.getLocalMediaLive({query:{taskId:e.taskId},params:{hls_encryption:1}});case 4:r=t.sent,delete i.media.resNo,i.media.url=r.mediaUri;case 7:if("audio"!==s){t.next=10;break}return e.formateAudioData(i),t.abrupt("return");case 10:if("video"!==s&&"live"!==s){t.next=13;break}return e.formateVedioData(i),t.abrupt("return");case 13:"ppt"===s&&e.formatePptData(i);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var i=Number(e.details.id);4040101==t.code&&e.$router.push({name:"login",query:{redirect:"/course/".concat(i)}}),s.a.fail(t.message)}))},formateAudioData:function(e){var t=e.media;if(t.isFinishConvert)if(this.isEncryptionPlus=t.isEncryptionPlus,t.isEncryptionPlus)Object(s.a)("该浏览器不支持云视频播放，请下载App");else{this.textContent=t.text;var i={id:"course-detail__head--video",user:this.user,resNo:t.resNo,token:t.token,autoplay:!0,disableDataUpload:!0,watermark:{pos:"top.right",width:30,height:30},rememberLastPos:!0,playlist:t.url};this.$store.commit("UPDATE_LOADING_STATUS",!0),this.initPlayer(i)}else Object(s.a)("课程内容准备中，请稍候查看")},isAndroid:function(){var e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Adr")>-1},formateVedioData:function(e){var t,i,n,r=e.media,a=r.timeLimit,o=r.securityVideoPlayer,c=!this.joinStatus&&Number(this.details.tryLookable);if(r.isFinishConvert)if(this.isEncryptionPlus=r.isEncryptionPlus,r.isEncryptionPlus&&!this.isWechat()&&o)Object(s.a)("该浏览器不支持云视频播放，请用微信打开或下载App");else if(!r.isEncryptionPlus||o){var u={id:"course-detail__head--video",user:this.user,autoplay:!0,disableFullscreen:"audio"===this.sourceType,strictMode:!r.supportMobile,pluck:{timelimit:a},fingerprint:{html:null===(t=e.fingerPrintSetting)||void 0===t?void 0:t.video_fingerprint,duration:100*(null===(i=e.fingerPrintSetting)||void 0===i?void 0:i.video_fingerprint_time)},playbackRates:[.75,1,1.25,1.5,2,3],resNo:r.resNo,disableDataUpload:!0,watermark:{pos:"top.right",width:30,height:30,file:null===(n=e.watermarkSetting)||void 0===n?void 0:n.video_watermark_image},language:Object(O.b)(),token:r.token,rememberLastPos:!0,playlist:r.url};r.isEncryptionPlus&&this.isWechat&&o&&(u.playerType="wasm"),c||delete u.pluck;var l=this.activity,d=l.finishType,p=l.finishData;"end"==d&&"1"==p&&(u.controlBar={disableProgressBar:!0}),this.$store.commit("UPDATE_LOADING_STATUS",!0),this.initPlayer(u)}else Object(s.a)("该浏览器不支持云视频播放，请下载App");else Object(s.a)("课程内容准备中，请稍候查看")},formatePptData:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function i(){var n,s;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n=e.media,t.isEncryptionPlus=n.isEncryptionPlus,t.cloudSdkCdn){i.next=5;break}return i.next=5,t.setCloudAddress();case 5:s="//".concat(t.cloudSdkCdn,"/js-sdk-v2/sdk-v1.js?")+~~(Date.now()/1e3/60),c()(s,(function(i){if(i)throw i;var s=new window.QiQiuYun.Player({id:"course-detail__head--video",resNo:n.resNo,token:n.token,source:{type:e.mediaType,args:n}});t.player=s,s.on("ready",(function(){t.initReportData(t.selectedPlanId,t.taskId,t.sourceType)})),s.on("pagechanged",(function(e){e.page===e.total&&t.finishCondition&&"end"===t.finishCondition.type&&t.reprtData({eventName:"finish"})}))}));case 7:case"end":return i.stop()}}),i)})))()},initPlayer:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function i(){var s;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t.cloudSdkCdn){i.next=3;break}return i.next=3,t.setCloudAddress();case 3:s="//".concat(t.cloudSdkCdn,"/js-sdk-v2/sdk-v1.js?")+~~(Date.now()/1e3/60),c()(s,(function(i){if(t.$store.commit("UPDATE_LOADING_STATUS",!1),i)throw i;"zh-cn"!==e.language&&e.language||(e.language="zh-CN");var s=new window.QiQiuYun.Player(e);t.player=s,s.on("unablePlay",(function(){t.$refs.video.innerHTML="",n.a.alert({message:"当前内容不支持该手机浏览器观看，建议您使用Chrome、Safari浏览器观看。"}).then((function(){}))})),s.on("ready",(function(){t.initReportData(t.selectedPlanId,t.taskId,t.sourceType)})),s.on("playing",(function(){t.isPlaying=!0,t.clearComputeWatchTime(),t.computeWatchTime()})),s.on("paused",(function(e){t.isPlaying=!1,t.clearComputeWatchTime(),t.reprtData({eventName:"doing",ContinuousReport:!0})})),s.on("ended",(function(){t.clearComputeWatchTime(),t.finishCondition&&"end"===t.finishCondition.type&&t.reprtData({eventName:"finish"})}))}));case 5:case"end":return i.stop()}}),i)})))()},isWechat:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},expire:function(){this.counting=!1},sellOut:function(){this.isEmpty=!0,this.$emit("goodsEmpty")},showTagLink:function(){this.DrpSwitch?(this.initTagData(),this.getAgencyBindRelation()):this.tagData.isShow=!1},getAgencyBindRelation:function(){var e=this;l.a.getAgencyBindRelation().then((function(t){t.agencyId?(e.bindAgencyRelation=t,e.tagData.isShow=!0):e.tagData.isShow=!1}))},initTagData:function(){var e=this;l.a.getDrpSetting().then((function(t){e.drpSetting=t,e.tagData.minDirectRewardRatio=t.minDirectRewardRatio;var i={type:"course",id:e.details.id,merchant_id:e.drpSetting.merchantId};e.tagData.link=e.drpSetting.distributor_template_url+"?"+m.a.stringify(i);var n=e.drpSetting.minDirectRewardRatio/100*e.details.price;e.tagData.earnings=(Math.floor(100*n)/100).toFixed(2)}))},toLearned:function(){var e=this;this.reprtData({eventName:"finish"}).then((function(t){e.finishResult=t,e.finishDialog=!0}))},computeWatchTime:function(){var e=this;this.intervalWatchTime=setInterval((function(){e.nowWatchTime++}),1e3)},clearComputeWatchTime:function(){clearInterval(this.intervalWatchTime),this.intervalWatchTime=null},closeFinishDialog:function(){this.finishDialog=!1},handleClickContinueLearning:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var i,n,r,a,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDetailsContent();case 2:if("closed"!=(null===(i=e.courseSet)||void 0===i?void 0:i.status)){t.next=4;break}return t.abrupt("return",Object(x.a)("course"));case 4:if(null===(n=e.course)||void 0===n||null===(r=n.details)||void 0===r||null===(a=r.learningExpiryDate)||void 0===a||!a.expired){t.next=6;break}return t.abrupt("return",Object(s.a)(e.$t("learning.expired")));case 6:o=e.nextStudy.nextTask.id,c={courseId:e.selectedPlanId,taskId:o},l.a.getCourseData({query:c}).then((function(t){e.toLearnTask(t)}));case 9:case"end":return t.stop()}}),t)})))()},toLearnTask:function(e){"create"!==e.status?(this.$store.commit("course/".concat(_.i),{nextTask:e}),this.showTypeDetail(e)):Object(s.a)("课时创建中，敬请期待")},showTypeDetail:function(e){if("published"===e.status)switch(e.type){case"video":this.playVedio(e);break;case"audio":this.playAudio(e);break;case"ppt":this.setSourceType({sourceType:"ppt",taskId:e.id});break;case"text":case"doc":this.$router.push({name:"course_web",query:{courseId:this.selectedPlanId,taskId:e.id,type:e.type,backUrl:"/course/".concat(this.selectedPlanId)}});break;case"live":var t=!1;if(new Date>new Date(1e3*e.endTime)){if(e.activity&&"videoGenerated"===e.activity.replayStatus)return void("self"===e.mediaSource?this.setSourceType({sourceType:"video",taskId:e.id}):this.copyPcUrl(e.courseUrl));if(e.activity&&"ungenerated"===e.activity.replayStatus)return void Object(s.a)("暂无回放");t=!0}this.$router.push({name:"live",query:{courseId:this.selectedPlanId,taskId:e.id,type:e.type,title:e.title,replay:t}});break;case"testpaper":var i=e.activity.testpaperInfo.testpaperId;this.$router.push({name:"testpaperIntro",query:{testId:i,targetId:e.id}});break;case"homework":this.$router.push({name:"homeworkIntro",query:{courseId:this.selectedPlanId,taskId:e.id}});break;case"exercise":this.$router.push({name:"exerciseIntro",query:{courseId:this.selectedPlanId,taskId:e.id}});break;default:this.copyPcUrl(e.courseUrl)}else Object(s.a)("敬请期待")},playVedio:function(e){if("self"===e.mediaSource){var t="/course/".concat(this.selectedPlanId);this.$route.path===t?this.setSourceType({sourceType:"video",taskId:e.id}):this.$router.push({path:t,query:{sourceType:"video",taskId:e.id}})}else this.copyPcUrl(e.courseUrl)},playAudio:function(e){var t="/course/".concat(this.selectedPlanId);this.$route.path===t?this.setSourceType({sourceType:"audio",taskId:e.id}):this.$router.push({path:t,query:{sourceType:"audio",taskId:e.id}})}})},j=Object(y.a)(L,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"course-detail__head pos-rl",attrs:{id:"course-detail__head"}},[t("video-report-mask",{attrs:{type:e.outFocusMaskType,isShow:e.isShowOutFocusMask,reportType:e.reportType},on:{outFocusMask:e.outFocusMask}}),e.textContent?t("div",{directives:[{name:"show",rawName:"v-show",value:["audio"].includes(e.sourceType)&&!e.isEncryptionPlus&&!e.isCoverOpen,expression:"\n      ['audio'].includes(sourceType) && !isEncryptionPlus && !isCoverOpen\n    "}],staticClass:"course-detail__nav--btn",on:{click:e.viewAudioDoc}},[e._v("\n    "+e._s(e.$t("courseLearning.manuscripts"))+"\n  ")]):e._e(),e.textContent?t("div",{directives:[{name:"show",rawName:"v-show",value:["audio"].includes(e.sourceType)&&!e.isEncryptionPlus,expression:"['audio'].includes(sourceType) && !isEncryptionPlus"}],staticClass:"course-detail__nav--cover web-view",class:{opened:e.isCoverOpen}},[t("div",{staticClass:"media-text",domProps:{innerHTML:e._s(e.textContent)}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isCoverOpen,expression:"isCoverOpen"}],staticClass:"course-detail__nav--cover-control",on:{click:e.handlePlayer}},[t("i",{staticClass:"iconfont",class:e.isPlaying?"icon-zanting":"icon-bofang"})]),t("div",{staticClass:"course-detail__nav--cover-close-btn",on:{click:e.hideAudioDoc}},[t("i",{staticClass:"van-icon van-icon-arrow van-nav-bar__arrow"})])]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:"img"===e.sourceType||e.isEncryptionPlus||e.finishDialog,expression:"sourceType === 'img' || isEncryptionPlus || finishDialog"}],staticClass:"course-detail__head--img",attrs:{id:"course-detail__head--img"}},[e.courseSet.cover?t("img",{class:{"continue-learning-img":e.nextStudy.nextTask},attrs:{src:e.courseSet.cover.large,alt:""}}):e._e(),e.nextStudy.nextTask?t("div",{staticClass:"continue-learning"},[t("h3",{staticClass:"continue-learning__title"},[e._v(e._s(e.nextStudy.nextTask.title))]),t("div",{staticClass:"continue-learning__btn",on:{click:e.handleClickContinueLearning}},[e._v(e._s(e.continueLearningText))])]):e._e(),e.seckillActivities&&"ongoing"===e.seckillActivities.status&&e.counting&&!e.isEmpty?t("countDown",{attrs:{activity:e.seckillActivities},on:{timesUp:e.expire,sellOut:e.sellOut}}):e._e(),t("div",{staticClass:"wechat-subscribe-box"},[t("wechat-subscribe")],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShowOutFocusMask,expression:"!isShowOutFocusMask"}]},[t("div",{directives:[{name:"show",rawName:"v-show",value:["video","audio","ppt"].includes(e.sourceType)&&!e.isEncryptionPlus&&!e.finishDialog,expression:"\n        ['video', 'audio', 'ppt'].includes(sourceType) &&\n          !isEncryptionPlus &&\n          !finishDialog\n      "}],ref:"video",attrs:{id:"course-detail__head--video"}})]),e.showLearnBtn?[e.isFinish?t("div",{staticClass:"course-detail__head--btn course-detail__head--activebtn"},[t("i",{staticClass:"iconfont icon-markdone"}),e._v("\n      "+e._s(e.$t("courseLearning.learned"))+"\n    ")]):e._e(),e.isFinish?e._e():t("div",[e.enableFinish?t("div",{staticClass:"course-detail__head--btn",on:{click:e.toLearned}},[e._v("\n        "+e._s(e.$t("courseLearning.learned"))+"\n      ")]):e._e(),e.enableFinish?e._e():t("div",{staticClass:"course-detail__head--btn",on:{click:e.toToast}},[e._v("\n        "+e._s(e.$t("courseLearning.completionConditions"))+"\n      ")])])]:e._e(),t("tagLink",{attrs:{"tag-data":e.tagData}}),e.finishDialog?t("finishDialog",{attrs:{finishResult:e.finishResult,courseId:e.selectedPlanId},on:{closeFinishDialog:e.closeFinishDialog}}):e._e()],2)}),[],!1,null,null,null);t.a=j.exports},2164:function(e,t,i){"use strict";i("e17f");var n=i("2241");t.a={methods:{copyPcUrl:function(e){var t=this,i="暂不支持此类课程学习，请移步至APP或电脑「".concat(e,"」完成课程。");n.a.alert({title:"暂不支持",message:i,messageAlign:"left",confirmButtonText:"复制链接"}).then((function(){t.$copyText(e).then((function(e){}))}))}}}},"32e6":function(e,t){function i(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function n(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}e.exports=function(e,t,s){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("script");"function"==typeof t&&(s=t,t={}),t=t||{},s=s||function(){},a.type=t.type||"text/javascript",a.charset=t.charset||"utf8",a.async=!("async"in t)||!!t.async,a.src=e,t.attrs&&function(e,t){for(var i in t)e.setAttribute(i,t[i])}(a,t.attrs),t.text&&(a.text=""+t.text),("onload"in a?i:n)(a,s),a.onload||i(a,s),r.appendChild(a)}},"4c51":function(e,t,i){"use strict";i.r(t),i("8e6e"),i("ac6a"),i("456d");var n=i("bd86"),s=i("b127"),r=i("202a"),a=i("2f62"),o=i("faa5");function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){Object(n.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var l={components:{Directory:s.a,DetailHead:r.a},computed:u(u({},Object(a.e)("course",{details:function(e){return e.details}})),Object(a.e)({isLoading:function(e){return e.isLoading}})),beforeRouteLeave:function(e,t,i){this.$store.commit("course/".concat(o.A),{sourceType:"img"}),i()}},d=i("0c7c"),p=Object(d.a)(l,(function(){var e=this._self._c;return e("div",{staticClass:"course-detail try"},[this.isLoading?e("e-loading"):this._e(),e("detail-head",{attrs:{"course-set":this.details.courseSet}}),e("directory",{attrs:{"hidde-title":!0,"course-items":this.details.courseItems}})],1)}),[],!1,null,null,null);t.default=p.exports},c8a5:function(e,t,i){"use strict";i("6762"),i("2fdb");var n=i("3ce7"),s=i("faa5");i("a556"),t.a={data:function(){return{reportIntervalTime:null,reportLearnTime:null,reportFinishCondition:null,reportData:{courseId:null,taskId:null},reportResult:null,isFinish:!1,reportType:null,learnTime:0,isShowOutFocusMask:!1,outFocusMaskType:"",sign:"",record:{},absorbed:0,learnedTime:0}},beforeRouteLeave:function(e,t,i){this.sign.length>0&&localStorage.setItem("flowSign",this.sign),i()},beforeDestroy:function(){this.clearReportIntervalTime(),window.removeEventListener("beforeunload",this.onbeforeunloadFlowSign),this.toggleReportMaskHidden("remove")},methods:{initReportData:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.clearReportIntervalTime(),this.reportData={courseId:e,taskId:t},this.reportType=i,this.isFinish=!1,this.reportIntervalTime=null,this.reportLearnTime=null,this.reportResult=null,this.learnTime=0,this.reportFinishCondition=null,n&&this.initReportEvent(),this.onbeforeunload()},initReportEvent:function(){this.reprtData(),this.intervalReportData(),this.intervalReportLearnTime()},getCourseData:function(e,t){var i=this,s={courseId:e,taskId:t};return new Promise((function(e,t){n.a.getCourseData({query:s}).then((function(t){i.reportFinishCondition=t.activity.finishCondition,e(t)})).catch((function(e){t(e)}))}))},reprtData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{eventName:"doing",ContinuousReport:!1,watchTime:null};if(null!==this.reportData.courseId&&null!==this.reportData.taskId&&(!this.isFinish||e.ContinuousReport))if(""===this.sign){var t={client:"h5"},i=localStorage.getItem("flowSign");i&&(t.lastSign=i,localStorage.removeItem("flowSign")),this.start(e,t)}else this.reportTaskEvent(e)},start:function(e,t){var i=this;n.a.reportTaskEvent({query:{courseId:this.reportData.courseId,taskId:this.reportData.taskId,eventName:"start"},data:t}).then((function(t){if(i.handleReportResult(t),t.learnControl.allowLearn)i.sign=t.record.flowSign,i.record=t.record,i.reportTaskEvent(e);else{var n=t.learnControl.denyReason;i.reportJudge(n)}}))},reportTaskEvent:function(e){var t=this;if(0!==this.sign.length){var i={client:"h5",sign:this.sign,duration:this.learnTime,status:this.absorbed};if(e.reActive&&(i.reActive=e.reActive),this.sourceType&&"video"===this.sourceType){var s=parseInt(this.nowWatchTime-this.lastWatchTime);this.lastWatchTime=this.nowWatchTime;var r={watchData:{duration:s}};i=Object.assign(i,r)}this.learnTime=0,n.a.reportTaskEvent({query:{courseId:this.reportData.courseId,taskId:this.reportData.taskId,eventName:e.eventName},data:i}).then((function(e){if(t.handleReportResult(e),t.record=e.record,t.absorbed=0,t.sign=e.record.flowSign,!e.learnControl.allowLearn){var i=e.learnControl.denyReason;t.reportJudge(i)}})).catch((function(e){t.clearReportIntervalTime()}))}},handleReportResult:function(e){this.reportResult=e,this.learnedTime=e.learnedTime,e.taskResult&&"finish"===e.taskResult.status?(this.isFinish=!0,this.$store.commit(s.B,"finish"),this.$store.commit("course/".concat(s.F),e.completionRate)):this.$store.commit(s.B,"start")},intervalReportLearnTime:function(){var e=this;this.reportLearnTime=setInterval((function(){e.checkoutTime(),e.learnTime++}),1e3)},intervalReportData:function(){var e=this,t=60*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)*1e3;this.reportIntervalTime=setInterval((function(){e.reprtData({eventName:"doing",ContinuousReport:!0})}),t)},checkoutTime:function(){this.reportFinishCondition&&["time","watchTime"].includes(this.reportFinishCondition.type)&&parseInt(this.learnTime/60,10)>=parseInt(this.reportFinishCondition.data,10)&&this.reprtData({eventName:"finish",ContinuousReport:!0})},clearReportIntervalTime:function(){clearInterval(this.reportIntervalTime),clearInterval(this.reportLearnTime),this.reportIntervalTime=null,this.reportLearnTime=null},reportJudge:function(e){"kick_previous"===e?this.kickEachOther("kick_previous"):"reject_current"===e&&(this.clearReportIntervalTime(),this.kickEachOther("reject_current"))},outFocusMask:function(e){this.absorbed=1,this.isShowOutFocusMask=!1,!this.player||"video"!==this.reportType&&"audio"!==this.reportType||this.player.play(),this.toggleReportMaskHidden("remove"),this.reprtData({eventName:"doing",ContinuousReport:!0,reActive:1})},kickEachOther:function(e){if(this.absorbed=1,"testpaper"!==this.reportType&&"live"!==this.reportType&&"homework"!==this.reportType||"kick_previous"!==e){if(this.isShowOutFocusMask=!0,this.outFocusMaskType=e,"video"===this.reportType||"audio"===this.reportType){if(this.player&&this.player.destory&&"reject_current"===e)return void this.player.destory();this.player&&this.player.pause&&this.player.pause()}this.toggleReportMaskHidden("add")}},ineffectiveLearning:function(e){this.isShowOutFocusMask||(this.absorbed=0,this.isShowOutFocusMask=!0,this.outFocusMaskType=e,this.player&&"video"===this.reportType&&this.player.pause(),this.reprtData({eventName:"doing",ContinuousReport:!0}))},toggleReportMaskHidden:function(e){"video"!==this.reportType&&"audio"!==this.reportType&&("add"===e?document.getElementsByTagName("body")[0].classList.add("report-mask-hidden"):"remove"===e&&document.getElementsByTagName("body")[0].classList.remove("report-mask-hidden"))},initVisibilitychange:function(){document.addEventListener("visibilitychange",this.visibilityState)},visibilityState:function(){"video"===this.reportType&&("hidden"===document.visibilityState?this.ineffectiveLearning("ineffective_learning"):"visible"===document.visibilityState&&this.player.pause())},onbeforeunload:function(){window.addEventListener("beforeunload",this.onbeforeunloadFlowSign)},onbeforeunloadFlowSign:function(){this.sign.length>0&&localStorage.setItem("flowSign",this.sign)}}}}}]);