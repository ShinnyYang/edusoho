webpackJsonp([3],{P8if:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("Dd8w"),r=s.n(i),a=s("jW8y"),n=s("gMS5"),o=s("NYxO"),c=s("Du/2"),u={components:{Directory:a.a,DetailHead:n.a},computed:r()({},Object(o.d)("course",{details:function(e){return e.details}}),Object(o.d)({isLoading:function(e){return e.isLoading}})),beforeRouteLeave:function(e,t,s){this.$store.commit("course/"+c.g,{sourceType:"img"}),s()}},d={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"course-detail try"},[this.isLoading?t("e-loading"):this._e(),this._v(" "),t("detail-head",{attrs:{courseSet:this.details.courseSet}}),this._v(" "),t("directory",{attrs:{hiddeTitle:!0,courseItems:this.details.courseItems}})],1)},staticRenderFns:[]},l=s("VU/8")(u,d,!1,null,null,null);t.default=l.exports},gMS5:function(e,t,s){"use strict";var i=s("//Fk"),r=s.n(i),a=s("Xxa5"),n=s.n(a),o=s("exGp"),c=s.n(o),u=s("Dd8w"),d=s.n(u),l=s("PirY"),h=s.n(l),p=s("NYxO"),y=s("gyMJ"),f={props:{courseSet:{type:Object,default:{}}},computed:d()({},Object(p.d)("course",{sourceType:function(e){return e.sourceType},selectedPlanId:function(e){return e.selectedPlanId},taskId:function(e){return e.taskId},details:function(e){return e.details},joinStatus:function(e){return e.joinStatus}})),watch:{taskId:{immediate:!0,handler:function(e,t){["video","audio"].includes(this.sourceType)&&(window.scrollTo(0,0),this.initPlayer())}}},methods:{getParams:function(){return!this.joinStatus&&Number(this.details.tryLookable)?{query:{courseId:this.selectedPlanId,taskId:this.taskId},params:{preview:1}}:{query:{courseId:this.selectedPlanId,taskId:this.taskId}}},initPlayer:function(){var e=this;return c()(n.a.mark(function t(){var s,i,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.$refs.video&&(e.$refs.video.innerHTML=""),t.next=3,y.a.getMedia(e.getParams());case 3:s=t.sent,i=s.media,r={id:"course-detail__head--video",resId:i.resId,user:{},playlist:i.url,autoplay:!0,poster:"https://img4.mukewang.com/szimg/5b0b60480001b95e06000338.jpg"},e.$store.commit("UPDATE_LOADING_STATUS",!0),e.loadPlayerSDK().then(function(t){e.$store.commit("UPDATE_LOADING_STATUS",!1);new t(r)});case 8:case"end":return t.stop()}},t,e)}))()},loadPlayerSDK:function(){if(!window.VideoPlayerSDK){var e="//service-cdn.qiqiuyun.net/js-sdk/video-player/sdk-v1.js?\n          v="+Date.now()/1e3/60;return new r.a(function(t,s){h()(e,function(e){e&&s(e),t(window.VideoPlayerSDK)})})}return r.a.resolve(window.VideoPlayerSDK)}}},v={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"course-detail__head"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"img"===this.sourceType,expression:"sourceType === 'img'"}],staticClass:"course-detail__head--img"},[t("img",{attrs:{src:this.courseSet.cover.large,alt:""}})]),this._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:["video","audio"].includes(this.sourceType),expression:"['video', 'audio'].includes(sourceType)"}],ref:"video",attrs:{id:"course-detail__head--video"}})])},staticRenderFns:[]},_=s("VU/8")(f,v,!1,null,null,null);t.a=_.exports},jW8y:function(e,t,s){"use strict";s("eqfM");var i=s("/QYm"),r=s("Dd8w"),a=s.n(r),n=s("NYxO"),o=s("Du/2"),c={props:{courseItems:{type:Array,default:function(){return[]}},hiddeTitle:{type:Boolean,default:!1}},computed:a()({},Object(n.d)("course",{joinStatus:function(e){return e.joinStatus},selectedPlanId:function(e){return e.selectedPlanId},details:function(e){return e.details}})),data:function(){return{directoryArray:[],chapters:[],tasks:[]}},filters:{filterNumber:function(e){return Number(e.seq)?e.number+"-"+e.seq:""+e.number}},watch:{selectedPlanId:{immediate:!0,handler:function(e){var t=this;this.details.courseItems.length&&(this.directoryArray=this.details.courseItems.map(function(e){return t.$set(e,"show",!0),"task"==e.type&&(e.status=t.getCurrentStatus(e.task)),e}),this.getTasks(this.directoryArray))}}},methods:a()({},Object(n.c)("course",{setSourceType:o.g}),{getTasks:function(e){var t=this,s=[];this.chapters=[],this.tasks=[],e.forEach(function(e){"chapter"!==e.type?s.push(e):(s.length>0?(t.tasks.push([].concat(s)),s=[]):t.chapters.length>0&&t.tasks.push([]),t.chapters.push(e))}),"chapter"!==e[e.length-1].type&&this.tasks.push(s),"chapter"!==e[0].type&&this.chapters.unshift({show:!0})},getCurrentStatus:function(e){return Number(this.details.tryLookable)&&"video"===e.type&&e.activity.mediaStorage?"is-tryLook":Number(e.isFree)?"is-free":""},filterTaskStatus:function(e){return"is-tryLook"===e.status?"试看":"is-free"===e.status?"免费":""},lessonCellClick:function(e){var t=e.task,s=this.details;if(!s.allowAnonymousPreview&&this.$route.push({name:"login"}),!this.joinStatus&&Number(s.tryLookable)&&["is-tryLook","is-free"].includes(e.status))switch(t.type){case"video":case"audio":this.$router.push({name:"course_try"}),this.setSourceType({sourceType:t.type,taskId:t.id});break;case"doc":case"text":case"ppt":this.$router.push({name:"course_web",query:{courseId:this.selectedPlanId,taskId:t.id,type:t.type}});break;default:return Object(i.a)("请先加入课程")}else this.joinStatus?this.showTypeDetail(t):Object(i.a)("请先加入课程")},showTypeDetail:function(e){switch(e.type){case"video":"self"==e.mediaSource?this.setSourceType({sourceType:"video",taskId:e.id}):Object(i.a)("暂不支持此类型");break;case"audio":this.setSourceType({sourceType:"audio",taskId:e.id});break;case"text":case"ppt":case"doc":this.$router.push({name:"course_web",query:{courseId:this.selectedPlanId,taskId:e.id,type:e.type}});break;default:Object(i.a)("暂不支持此类型")}}})},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("e-panel",{staticClass:"directory",attrs:{title:"课程目录","hidde-title":e.hiddeTitle}},[0==e.courseItems.length?s("div",{staticClass:"empty"},[e._v("暂无学习任务")]):s("div",{staticClass:"directory-list"},e._l(e.chapters,function(t,i){return s("div",{staticClass:"directory-list__item"},["chapter"===t.type?s("div",{staticClass:"directory-list__item-chapter",on:{click:function(e){t.show=!t.show}}},[s("span",[e._v("第"+e._s(t.number)+"章："+e._s(t.title))]),e._v(" "),s("i",{class:[t.show?"icon-packup":"icon-unfold"]})]):e._e(),e._v(" "),e._l(e.tasks[i],function(i){return s("div",{class:["directory-list__item-unit",{"unit-show":t.show}]},["unit"===i.type?s("div",{staticClass:"lesson-cell__unit"},[e._v("\n          第"+e._s(i.number)+"节："+e._s(i.title)+"\n        ")]):e._e(),e._v(" "),"task"===i.type?s("div",{class:["box",{"show-box":t.show}]},[s("div",{staticClass:"lesson-cell"},[s("span",{staticClass:"lesson-cell__number"},[e._v(e._s(e._f("filterNumber")(i)))]),e._v(" "),s("div",{staticClass:"lesson-cell__content",on:{click:function(t){e.lessonCellClick(i)}}},[s("span",[e._v(e._s(i.title))]),e._v(" "),s("span",[e._v(e._s(e._f("taskType")(i.task.type))+e._s(e._f("filterTask")(i.task)))])]),e._v(" "),s("div",{class:["lesson-cell__status",i.status]},[e._v("\n              "+e._s(e.filterTaskStatus(i))+"\n            ")])])]):e._e()])})],2)}))])},staticRenderFns:[]},d=s("VU/8")(c,u,!1,null,null,null);t.a=d.exports}});